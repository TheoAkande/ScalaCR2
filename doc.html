<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0034)http://lclevy.free.fr/cr2/#parsing -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252"><title>Inside the Canon RAW format version 2, understanding .CR2 file format and files produced by Canon EOS Digital Camera</title>
  
  <meta content="CR2 format;libcraw2; Canon Raw format version 2;Canon RAW file format; CR2 file format; CR2 content; inside dcraw; dcraw algorithms; dcraw theory" name="KEYWORDS">
  <meta content="how to decode Canon CR2 pictures" name="DESCRIPTION">
  <meta content="home page" name="CATEGORY">
<script charset="utf-8" src="./doc_files/button.856debeac157d9669cf51e73a08fbc93.js.download"></script></head>

<body>
<center>
<h1>Understanding What is stored in a Canon RAW .CR2 file, How and Why</h1>
<h3>(.CR2 files are produced by Canon EOS Digital Cameras since 2004)</h3> 
</center>
<p>
<!--
<center>
<h1>!!!Draft!!!</h1>
</center>
-->
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="./doc_files/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.

</p><p>

<!--
http://www.canon-europe.com/Images/PowerShot%20S90_Technologies%20Explained_tcm13-672233.pdf

Lens vignetting correction algorithm in digital cameras
http://www.freshpatents.com/Lens-vignetting-correction-algorithm-in-digital-cameras-dt20070913ptan20070211154.php?type=description
http://www.freepatentsonline.com/20070211154.pdf

http://www.faqs.org/patents/app/20080291299

http://www.latestpatents.com/canon-patent-applications-published-on-27-november-2008/

http://cpn.canon-europe.com/content/technical/eos7d.do
http://cpn.canon-europe.com/content/technical/raw.do
http://www.usa.canon.com/dlc/controller?act=GetArticleAct&articleID=1426
-->
<script id="twitter-wjs" src="./doc_files/widgets.js.download"></script><script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="./doc_files/ga.js.download" type="text/javascript"></script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-9281169-1");
pageTracker._trackPageview();
} catch(err) {}</script>


Version 0.8 (Jannuary 9th, 2019)<br>
<img src="./doc_files/em.png"> with "CR2 format" as subject.<br>
<iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" class="twitter-follow-button twitter-follow-button-rendered" style="position: static; visibility: visible; width: 158px; height: 20px;" title="Twitter Follow Button" src="./doc_files/follow_button.2f70fb173b9000da126c79afe2098f02.en.html" data-screen-name="lorenzo2472"></iframe>
<script>!function(d,s,id){
var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';
if(!d.getElementById(id)){js=d.createElement(s);
js.id=id;js.src=p+'://platform.twitter.com/widgets.js';
fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
</script>

</p><p>
This document is a work in progress, if you want to help, send me a email!
</p><p>
 </p><li><b>31dec2018: Source code release for <a href="https://github.com/lclevy/libcraw2">libcraw2, craw2tool and PyCraw2</a></b>
 </li><li><b>12mar2018: Started to describe the Canon CR3 raw format <a href="https://github.com/lclevy/canon_cr3">here</a></b>
<p>
</p><hr>
<a href="http://lclevy.free.fr/cr2/#intro">1. Introduction</a><br>
<a href="http://lclevy.free.fr/cr2/#parsing">2. Find image and camera properties: parsing the CR2 file and keep some tags values</a><br>
<a href="http://lclevy.free.fr/cr2/#tiff_over">2.1 Overview</a><br>
<a href="http://lclevy.free.fr/cr2/#key_info">2.2 Key information to get (not exhaustive)</a><br>
2.3. TIFF and CR2 header<br>
2.4. IFD#0<br>
2.4.1. Exif subIFD<br>
2.4.2. Makenote subIFD<br>
<a href="http://lclevy.free.fr/cr2/#odd">Tag 0x0083: Original Decision Data</a><br>
<a href="http://lclevy.free.fr/cr2/#ddd">Tag 0x0097: Delete Dust Data</a><br>
2.5. IFD#1<br>
2.6. IFD#2<br>
2.7. IFD#3<br>
<a href="http://lclevy.free.fr/cr2/#lossless">3. Decode the lossless jpeg grayscale picture</a><br>
3.1. Introduction<br>
<a href="http://lclevy.free.fr/cr2/#sraw">3.2. SRaw encoding (not RGB!)</a><br>
3.2.1. Sraw and sraw2 encoding<br>
3.2.2. Sraw1 (mraw) encoding<br>
3.3. RAW encoding (not direct RGB!)<br>
3.4. Dual Pixel RAW<br>
3.5. JPEG decompression<br>
<a href="http://lclevy.free.fr/cr2/#interpol">4. Creating RGB picture from the grayscale CFA values</a><br>
<a href="http://lclevy.free.fr/cr2/#wb">5. White Balance correction, Black substraction and Color scaling</a><br>
<a href="http://lclevy.free.fr/cr2/#color">6. Color space conversion and Gamma correction</a><br>
6.1 RGB to XYZ color space conversion<br>
6.2 XYZ to RGB conversion<br>
6.3 Gamma correction for 16bits-&gt;8bits conversion<br>
<a href="http://lclevy.free.fr/cr2/#ref">7. References</a><br>
<a href="http://lclevy.free.fr/cr2/#soft">8. Patents</a><br>
<a href="http://lclevy.free.fr/cr2/#ml">9. Magic Lantern work</a><br>
<a href="http://lclevy.free.fr/cr2/#app">10. Appendices</a>
<p>
</p><hr>
<h4>Changelog</h4>
- 10may2017: added section about <a href="http://www.magiclantern.fm/forum/index.php?board=6.0">Magic Lantern</a> firmware project, and Dual Pixel information from Anton Reiser<br>
- 18dec2016: updates for EOS M5 (thanks to <a href="https://www.flickr.com/photos/danny_henriquez/">Danny Henriquez</a>),<br>
- sep2016: updates for 5D Mark IV raw/sraw/mraw/dpraw (thanks to <a href="http://photos-by.me/">Christian Leibig</a>),<br>
- 03jul2016: updates for 1300D, G7X Mark II, 80D sraw/mraw (thanks to <a href="https://portraitmoments.smugmug.com/">Benny Urbina</a>), 
             1DX Mark II (thanks to  <a href="https://www.facebook.com/eldarhaugephotography">Eldar Hauge</a>).<br>
- 19Mar2016: cr2_database and dng_info updated with G3X, G5X, G9X, M10 and 80D raw<br>
- 08Jun2015: updates for 750D, 760D, 5DS and M3 (thanks Ma Chuen Tung). 
Public release of <a href="http://connect.ed-diamond.com/MISC/MISCHS-006/Mecanisme-de-controle-d-authenticite-des-photographies-numeriques-dans-les-reflexes-Canon">technical article</a> 
about Original Decision Data formats and algorithms (2012, in French).<br>
- 11Nov2014: updates for 7D Mark II mraw and sraw. Thanks to <a href="http://www.dojoklo.com/">Douglas J. Klostermann</a>. 
See visual docs on <a href="https://github.com/lclevy/libcraw2/blob/master/docs/cr2_poster.pdf">CR2 file format</a> and <a href="https://github.com/lclevy/libcraw2/blob/master/docs/cr2_lossless.pdf">Lossless Jpeg compression</a>.<br>
- 10Oct2014: Describing the <a href="http://lclevy.free.fr/cr2/#ddd"><b>Dust Delete Data (0x0097)</b></a> tag. Release of <a href="https://github.com/lclevy/libcraw2/blob/master/docs/cr2_database.txt">Camera jpeg properties database</a> 
and <a href="https://github.com/lclevy/libcraw2/blob/master/dng_info.txt">Color calibration database</a> (from DNG converted pictures). 
Working hard on a <a href="https://github.com/lclevy/libcraw2">craw2tool, libcraw2 and PyCraw2</a> (NOT DCRaw based).<br>
- 09Oct2014: updates for EOS M2 (thanks to <a href="http://www.pbase.com/photokhan">Huberto Borges</a>), 1200D, G1 X Mark II, 7D Mark II RAW, G7 X and SX60 HS<br>
- 30Aug2013: updates for 70D (thanks again Mike '3dgor' Leung), S120 and G16.<br>
- 26Apr2013: update for 700D/T5i (thanks to <a href="http://www.dojoklo.com/Full_Stop/index.htm">Douglas J. Klostermann</a>).<br>
- 02Dec2012: updates for 6D (thanks Harald Selke auf Deustchland and Nagi from Japan), G15 (thanks Mike '3dgor' Leung), SX50 HS and S110. Updates for EOS M (thanks to Ryoichi from Japan) 
and 1D X (thanks <a href="http://eddy-briere.com/">Eddy</a>).<br>
- 02Sep2012: updates for 1D X, 5D Mark III and 650D/T4i. 
Release of <b><a href="https://github.com/lclevy/odd_verify">odd_verif.py</a></b>, a tool to recompute/check Original Data Decision records.<br>
- 18Feb2012: updates for G1 X and S100 (thanks to Alex, TX).<br>
- 06Mar2011: update for Original Data Decision <a href="http://www.elcomsoft.com/canon.html">presentation</a> by Dmitry Sklyarov. Updates for 600D/T3i and 1100D/T3.<br>
- 24Oct2010: updates for 60D (thanks to Ray Steup) and S95 (thanks to Paul Rivers). Thanks to Doug Kerr and (indirectly) Dave Coffin for Black levels information.<br>
- 27Feb2010: updates for 550D (RAW), thanks to Kim from Hong Kong.<br>
- 13Feb2010: first updates for 550D (jpeg data) and discovered overall structure of <b>Original data decision tag (0x0083)</b>. Thanks to G. Baton and W.S. Ming! See end of section 2.4.2<br>
- 23Dec2009: updates for 1D Mark IV samples (thanks to Gavin Melville from New Zealand), and camera calibration (Camera Raw 5.6)<br>
- 06Oct2009: Found interesting Canon patents: seems to describe sRaw encoding (RGB-&gt;YUV conversion), see end of section 3.2.1.<br>
- 01Oct2009: Updates for S90 RAW. Camera calibration for the S90 (Camera Raw 5.5). Updates for 7D mraw and sraw, 
thanks to <a href="http://www.flickriver.com/photos/smwhang/popular-interesting/">Whang Sung Ming</a> for the samples.<br>
- 15Sep2009: Camera calibration matrixes for the G11 and the 7D (release of Camera Raw 5.5). 
More on Peripheral Illumination (vignetting) correction (<b>tag 0x4015</b>), see section 2.4.2<br>
- 01Sep2009: updates for the G11 and the 7D. Little correction about sRaw1 chroma subsampling values (4:2:0 instead of wrong 4:1:1), thanks to 
<a href="http://sh0dan.blogspot.com/">Klaus Post</a> for pointing out this.<br>
- 04Aug2009: Discovered (partially) the usage of <b>tags 0x4015 and 0x4016</b> for Peripheral Illumination Correction. Thanks to Laurent Lecatelier (50D) and Martial Maugest (500D) for the samples.<br>
- 26Jun2009: Camera calibration matrixes for SX1 and 500D from DNG files (release of Camera Raw 5.4)<br>
- 29Mar2009: updates of the sensor information tables (section 9.1)<br>
- 25Mar2009: updates for EOS 500D/Digital Rebel T1i/Digital Kiss X3<br>
- 19Mar2009: updates for SX1 IS with firmware 2.0<br>
- 14Mar2009: XYZ to RGB color conversions. Special thanks to <a href="http://desmisja.perso.cegetel.net/geraud/photo.php">Jacques Desmis</a> for his help.
Appendice with Camera calibration matrixes from DNG files.<br>
- 16Feb2009: Camera Color space to CIE XYZ conversion. Gamma correction.<br>
- 05Jan2009: Big update about <b>sRaw encoding</b>, almost complete. Many thanks to <a href="http://forums.dpreview.com/forums/read.asp?forum=1019&amp;message=26234685">Gao YANG</a> for the YCbCr hint! 
And to <a href="http://www.cybercom.net/~dcoffin/dcraw/">Dave Coffin</a> for his feedback. <br>
- 03Jan2009: Added StripOffset and StripByteCount to key tags for decoding.<br>
- 01Jan2009: More details in Section 3 Intro. 1D Mark III sRaw values, thanks to Olivier Ménétrey for the sample.<br>
- 31Dec2008: First paragraph of the new refreshed Section 3, with sRaw details. More to come. Thanks to Jean-Stéphane Martin for the 40D Sraw samples. 
New overview part for Section 2.<br>
- 21Dec2008: Introduction rewritten with advices of Jacques Desmis.<br>
- 13Dec2008: How Dcraw is finding WB values in tag 0x4001<br>
- 07Dec2008: demosaicing links. Thanks to <a href="http://desmisja.perso.cegetel.net/geraud/photo.php">Jacques Desmis</a><br>
- 06Dec2008: updates for the 5D Mark II (raw, sraw1, sraw2) and the G10. Thanks to <a href="http://www.noirsurblanc.book.fr/">Gil Couturiot</a> 
and Ine Dehandschutter for 5D Mark II samples.<br>
- 04Oct2008: updates for the 50D (raw, sraw1 and sraw2). Thanks to Laurent Lecatelier for the samples<br>
- 06Aug2008: Wildtramper.com CR2 description and C++ decoder link<br>
- 05Aug2008: details for the new 1000D (Rebel XS, Kiss F). Thanks to Darren Sim from Singapor for the samples<br>
- 14June2008: details for the 1Ds MarkIII sRaw. Thanks to <a href="http://www.taste-of-skin.com/">Dominique 'Mac Arthur'</a> for the samples<br>
- 28May2008: details and examples for IFD#2 and IFD#3. Complete description of a TIFF file structure and formats.<br>
- Apr2008: received my brand new Canon 450D/XSI, and wondering what .CR2 files inside look like...
<p>
</p><hr>
<p>
</p><h3>Special acknowledgments</h3>
</li><li><a href="http://crousseau.free.fr/">Cedric Rousseau</a> for the permission of translating some parts of his Web site. 
</li><li>Phil Harvey for his HUGE work about documenting Makernotes and <a href="http://www.sno.phy.queensu.ca/~phil/exiftool/">ExifTool</a>.
</li><li>Dave Coffin for discussions and of course having written <a href="http://www.cybercom.net/~dcoffin/dcraw/">dcraw</a>. 
Dcraw source code cited in this document is Copyright 1997-2010 by Dave Coffin.
</li><li><a href="http://desmisja.perso.cegetel.net/geraud/photo.php">Jacques Desmis</a> for the discussions.
</li><li>Many thanks to <a href="http://www.flickriver.com/photos/smwhang/popular-interesting/">Whang Sung Ming</a> for his many 7D samples!
<p>
</p><hr>
<p>
<a name="intro">
</a></p><h2><a name="intro">1. Introduction</a></h2><a name="intro">

<h3>1.1 What is a RAW and a .CR2 file ?</h3>

The .CR2 file format (Canon RAW version 2) is a digital photography </a><a href="http://lclevy.free.fr/raw/">RAW format</a> created by Canon. "RAW" here means that this file stores information directly 
coming from the sensor, almost without processing. RAW files can be seen as a digital negative format, and do not contains a "ready to view" picture, like jpeg. 
RAW file is the best quality/size ratio storage a photograph can use to store his picture, mainly because each primary color (R, G or B) is recorded in 12 or 14bits (8bits for Jpeg), 
and a lossless compression is used (lossy for Jpeg).<br>
Jpeg files on the opposite are "ready to use" files, but a lot a processing is necessary to obtain such file, it is made automatically 
by the Camera embedded software.
<p>
By choosing to stores pictures in a RAW format, a lot of post-processing is possible by the photograph, like the White Balance. With Jpeg, it is far more difficult,
and with a big quality loss.
</p><p>
The CR2 format is used by Canon since the 350D, 20D, G9 and 1D MarkII models. The first version of this RAW format was <a href="http://www.sno.phy.queensu.ca/%7Ephil/exiftool/canon_raw.html">.CRW</a> 
(see also <a href="http://web.archive.org/web/20130830102006/http://wildtramper.com/sw/crw/crw.html">here</a>) and is used by Canon D30, D60, 10D, 300D, PowerShot Pro1, G1-G6, S30-S70. The EOS 1Ds is writing TIFF files.
</p><p>
</p><h3>1.2 Motivation</h3>
Why writing a document to explain the CR2 format and why not just asking to Canon ? Canon do not want to release the official specification of the format for "Intellectual Property" reasons. 
<p>
I personnally own a 450D camera and I want to know how my pictures are stored on my hard disk. I would like also to understand how pictures are produced by my camera, 
and how a Jpeg can be created starting from a CR2 file. Some answers to these questions are in embedded in the code source of <a href="http://cybercom.net/%7Edcoffin/dcraw/">dcraw</a>, 
a great tool Dave Coffin has written to create a jpeg file from the RAW from almost all Camera models, including Canon ones. But the code source of Dcraw is not well commented,
its coding style is sometimes difficult to follow, and some processing is not explained: Dcraw can not be used directly as a documentation.
</p><p>
Thus this document is written as a background to explain the main tasks Dcraw is doing on CR2 files to create ("render") a Jpeg file, 
while also giving official or theorical references for a deeper understanding.

</p><h3>1.3 RAW rendering</h3>

The necessary steps to interpret a CR2 files (like any RAW format) are:
<ol>
<li>Decoding of the file format, to identify the Camera model, find the image dimensions and data. Finds White Balance information
</li><li>Decompression of the sensor data. We will see that it does NOT contains direct RGB data for each pixel.
</li><li>Interpolation of the sensor data to obtain an RGB picture.
</li><li>Applying some post-processing, at least White Balance and Gamma correction. Color Space conversion.
</li><li>Producing a final "ready to view" file, in Jpeg or Tiff format.
</li></ol>
<p>
This document is following the same progression to explain as most as possible the CR2 format and how to use it, but this format, 
like many other proprietary format, is not understood at 100%, despite the work of people like <a href="http://www.sno.phy.queensu.ca/~phil/exiftool/">Phil Harvey</a>, 
who is working on discovering and documenting the meaning of each section of the CR2 format. 
</p><p>
Of course other processing can also be applied :
</p><ul>
<li>to reduce artefacts or reduce noise produced at the 'interpolation' step, 
</li><li>to correct lenses distortion and chromatic abberrations
</li><li>to improve contrast, saturation, vibrance : to sharpen or accentuate the picture
</li><li>to apply color profile 
</li><li>etc...
</li></ul>
but this document will stay focused on the minimal steps to produce a 'correct' Jpeg, since the image processing science is progressing everyday and 
better algorithms that can be applied to RAW rendering will be available in the future.
<p>
The first step is to find the location of useful information in the CR2 file.

</p><p>
</p><hr>
<p>

</p><h2>2. Find image and camera properties: parsing the CR2 file and keep some tags values</h2>
<a name="parsing">

<h3>2.1. Overview</h3>

For a short and visual version, see </a><a href="https://github.com/lclevy/libcraw2/blob/master/docs/cr2_poster.pdf">CR2 file format poster</a>.
<p>
The .CR2 file is based on the <a href="http://en.wikipedia.org/wiki/TIFF">TIFF file format</a>.
This TIFF file has 4 Image File Directories (IFDs).
</p><p>
<table border="1" cellpadding="2">
<tbody>
<tr>
<th>Offset</th>
<th>Content </th>
<th>Comment </th>

</tr>
<tr>
<td valign="top">0x0000 </td>
<td valign="top">Header </td>
<td>contains the byte ordering, the version and the offset to the RAW picture</td>
</tr>


<tr style="BACKGROUND-COLOR: #c0c0c0">
<td valign="top">computed</td>
<td valign="top">IFD#0</td>
<td>this part contains the Exif section, which contains the Makernotes section.<br>
Information about picture#0.
</td>
</tr>

<tr style="BACKGROUND-COLOR: #c0c0c0">
<td valign="top">computed </td>
<td valign="top">picture#0</td>
<td>small version of the picture (one fourth the size of the original), compressed in Jpeg</td>
</tr>

<tr>
<td valign="top">computed </td>
<td valign="top">IFD#1</td>
<td>Information about picture#1.</td>
</tr>

<tr>
<td valign="top">computed </td>
<td valign="top">picture#1</td>
<td>small version of the picture, compressed in Jpeg</td>
</tr>

<tr style="BACKGROUND-COLOR: #c0c0c0">
<td valign="top">computed </td>
<td valign="top">IFD#2</td>
<td>Information about picture#2.</td>
</tr>

<tr style="BACKGROUND-COLOR: #c0c0c0">
<td valign="top">computed </td>
<td valign="top">picture#2</td>
<td>small version of the picture, not compressed</td>
</tr>

<tr>
<td valign="top">in header </td>
<td valign="top">IFD#3</td>
<td>Information about picture#3, the full dimension RAW image</td>
</tr>

<tr>
<td valign="top">computed </td>
<td valign="top">picture#3</td>
<td>RAW image data, lossless compressed in Jpeg (not RGB data!)</td>
</tr>
</tbody>
</table>


</p><p>A lot of meta-information is available in a RAW file such as a CR2 file. All of this is recorded using TIFF tags. 
The <a href="http://www.exif.org/">EXIF</a> part contains normalized information about the Camera characteristics, settings and measures when the picture has been taken : 
the ISO, Aperture and Speed values for example.<br> 
The <b>Makernotes</b> part is also containing interesting information but is a proprietary extension kept secret by manufacturers. 
</p><p>
</p><h3>2.2. Key information to get (not exhaustive)</h3>
<a name="key_info">

<p>
Dcraw is keeping the following information while parsing the CR2 file:
</p><ul>
<li>From IFD#0:
  <ul>
  <li>Camera make is taken from tag #271 (0x10f)
  </li><li>Camera model is from tag #272 (0x110)
  </li><li>model ID from Makernotes, Tag #0x10
  </li><li>white balance information is taken from tag #0x4001
  </li></ul>
</li><li>From IFD#3: 
  <ul>
  <li>StripOffset, offset to RAW data : tag #0x111
  </li><li>StripByteCount, length of RAW data : tag #0x117
  </li><li>image slice layout (cr2_slice[]) : tag #0xc640
  </li><li>the RAW image dimensions is taken from lossless jpeg (0xffc3 section)
  </li></ul>
</li></ul>
this list may not be complete.
<p>
The following sections are for technical people who want to understand the structure of a TIFF/CR2 file.
Others may want to continue directly to Section 3.
</p></a><p><a name="key_info">
Parts of the following sections are a tranlated from: 
</a><a href="http://crousseau.free.fr/imgfmt_raw.htm">Format d'images RAW</a> by C. Rousseau. (French), with his authorization, of course.

</p><p>
</p><h3>2.3 TIFF and CR2 file header</h3>
<p>

<table border="1" cellpadding="2">
<tbody>
<tr>
<th>Offset</th>
<th>Length </th>
<th>Type </th>
<th>Description</th>
<th>Value</th>
</tr>
<tr>
<td valign="top">0x0000 </td>
<td align="right" valign="top">2 </td>
<td valign="top">char </td>
<td valign="top">Byte order</td>
<td>"II" or 0x4949 means Intel byte order (little endian)<br>
"MM" or 0x4d4d means Motorola byte order (big endian) </td>
</tr>
<tr>
<td valign="top">0x0002 </td>
<td align="right" valign="top">1 </td>
<td valign="top">short </td>
<td valign="top">TIFF magic word</td>
<td>0x002a</td>
</tr>
<tr>
<td valign="top">0x0004 </td>
<td align="right" valign="top">1 </td>
<td valign="top">long </td>
<td valign="top">TIFF offset</td>
<td>0x0000 0010</td>
</tr>
<tr>
<td valign="top">0x0008 </td>
<td align="right" valign="top">1 </td>
<td valign="top">short </td>
<td valign="top">CR2 magic word</td>
<td>"CR" or 0x4352</td>
</tr>
<tr>
<td valign="top">0x000a </td>
<td align="right" valign="top">1 </td>
<td valign="top">char </td>
<td valign="top">CR2 major version</td>
<td>2</td>
</tr>
<tr>
<td valign="top">0x000b </td>
<td align="right" valign="top">1 </td>
<td valign="top">char </td>
<td valign="top">CR2 minor version</td>
<td>0</td>
</tr>
<tr>
<td valign="top">0x000c </td>
<td align="right" valign="top">1 </td>
<td valign="top">long </td>
<td valign="top">RAW IFD offset</td>
<td></td>
</tr>
</tbody>
</table>
</p>

<h4>Image File Directory</h4>
<p>
An given IFD contains all necessary information to read the associated picture.
</p><p>
<table border="1" cellpadding="2">
<tbody><tr>
<th> Offset </th>
<th> Size in bytes </th>
<th> Description</th>
</tr>
<tr>
<td> 0x00/0 </td>
<td> 2 </td>
<td> number of entries (N)</td>
</tr>
<tr>
<td> 0x02/2 </td>
<td> 12 </td>
<td> entry#0</td>
</tr>
<tr>
<td> 0x0e/14 </td>
<td> 12 </td>
<td> entry#1</td>
</tr>
<tr>
<td> ... </td>
<td> ... </td>
<td> ...</td>
</tr>
<tr>
<td> 2+12*(N-1) </td>
<td> 12 </td>
<td> entry #N-1</td>
</tr>
<tr>
<td> 2+12*N </td>
<td> 4 </td>
<td> next IFD offset</td>
</tr>
</tbody></table>
</p><p>
</p><h4>IFD Entry</h4>
<p>
A TIFF tag, is a logical entity which consist in: an record (Directory Entry) inside an IFD, and some data. These two parts are generally separated.
</p><p>
All directory entries are a sequence inside the same IFD, the data can be anywhere in the file.
</p><p>
<table border="1" cellpadding="2">
<tbody><tr>
<th> Offset </th>
<th> Size in bytes </th>
<th> Description</th>
</tr>
<tr>
<td> 0 </td>
<td> 2 </td>
<td> tag ID</td>
</tr>
<tr>
<td> 2 </td>
<td> 2 </td>
<td> tag type:<br>
1 = unsigned char<br>
2 = string (with an ending zero)<br>
3 = unsigned short (2 bytes)<br>
4 = unsigned long (4 bytes)<br>
5 = unsigned rationnal (2 unsigned long)<br>
6 = signed char<br>
7 = byte sequence<br>
8 = signed short<br>
9 = signed long<br>
10 = signed rationnal (2 signed long)<br>
11 = float, 4 bytes, IEEE format<br>
12 = float, 8 bytes, IEEE format<br>
</td>
</tr>
<tr>
<td> 4 </td>
<td> 4 </td>
<td> number of value</td>
</tr>
<tr>
<td> 8 </td>
<td> 4 </td>
<td> value, or pointer to the data</td>
</tr>
</tbody></table>
</p><p>
As a summary, here is the structure of a TIFF file with 2 IFDs:
</p><h4>TIFF structure</h4> (picture by C. Rousseau)
<p>
<img width="551" height="266" src="./doc_files/tiff_img1.gif" alt="Structure globale">
</p><p>
Remember that there is exactly on picture encoded per IFD, with different compression methods and sizes.
</p><p>
</p><h3>2.4 IFD #0</h3>
The first IFD is containing a small RGB version of the picture (one fourth
the size) compressed in Jpeg, the <a href="http://exif.org/">EXIF</a>
part and the Makernote part. <br>
See <a href="http://www.sno.phy.queensu.ca/%7Ephil/exiftool/TagNames/Canon.html">Exiftool Canon Makernote</a> for all known Makernote values and meaning.
<p>The picture in IFD #0, for the 450D, has 2256x1504 pixels. For
the 40D, the dimension is 1936x1288.
</p>
<p>the TIFF tags are:
<table border="1" cellpadding="2">
<tbody>
<tr>
<th> Tag value </th>
<th> Name </th>
<th> Type </th>
<th> Length </th>
<th> Description</th>
</tr>
<tr>
<td valign="top"> 0x0100 / 256 </td>
<td valign="top"> imageWidth </td>
<td align="right" valign="top">
3=unsigned_short</td>
<td align="right" valign="top"> 1</td>
<td valign="top"> 1936 for the 40D<br>
 2256 for the 450D </td>
</tr>
<tr>
<td valign="top"> 0x0101 / 257 </td>
<td valign="top"> imageLength </td>
<td align="right" valign="top">
3=unsigned_short</td>
<td align="right" valign="top"> 1</td>
<td valign="top"> 1288 for the 40D<br>
1504 for the 450D </td>
</tr>
<tr>
<td> 0x0102 / 258 </td>
<td> bitsPerSample </td>
<td align="right"> 3=unsigned_short</td>
<td align="right"> 3</td>
<td> [8,8,8] </td>
</tr>
<tr>
<td> 0x0103 / 259 </td>
<td> compression </td>
<td align="right"> 3=unsigned_short</td>
<td align="right"> 1</td>
<td> 6=old_jpeg </td>
</tr>
<tr>
<td> 0x010f / 271 </td>
<td> make </td>
<td align="right"> 2=string</td>
<td align="right"> 1</td>
<td> "Canon" </td>
</tr>
<tr>
<td> 0x0110 / 272 </td>
<td> model </td>
<td align="right"> 2=string</td>
<td align="right"> 1</td>
<td> Examples: "Canon EOS 40D" or "Canon EOS 450D" </td>
</tr>
<tr>
<td> 0x0111 / 273 </td>
<td> stripOffset </td>
<td align="right"> 4=pointer</td>
<td align="right"> 1</td>
<td> pointer to the image data in this IFD </td>
</tr>
<tr>
<td> 0x0112 / 274 </td>
<td> orientation </td>
<td align="right"> 3=unsigned_short</td>
<td align="right"> 1</td>
<td> 1="0,0 is top-left" </td>
</tr>
<tr>
<td> 0x0117 / 279 </td>
<td> stripByteCounts </td>
<td align="right"> 4=long</td>
<td align="right"> 1</td>
<td> size in bytes of the image data in this IFD </td>
</tr>
<tr>
<td> 0x011a / 282 </td>
<td> xResolution </td>
<td align="right"> 5=rational</td>
<td align="right"> 1</td>
<td> 72 </td>
</tr>
<tr>
<td> 0x011b / 283 </td>
<td> yResolution </td>
<td align="right"> 5=rational</td>
<td align="right"> 1</td>
<td> 72 </td>
</tr>
<tr>
<td> 0x0128 / 296 </td>
<td> resolutionUnit </td>
<td align="right"> 3=unsigned_short</td>
<td align="right"> 1</td>
<td> 2="pixels per inche" </td>
</tr>
<tr>
<td> 0x0132 / 306 </td>
<td> dateTime </td>
<td align="right"> 2=string</td>
<td align="right"> 20</td>
<td> "2008:02:16 17:02:52" </td>
</tr>
<tr>
<td> 0x8769 / 34665 </td>
<td> <b>EXIF</b> </td>
<td align="right"> 4=pointer</td>
<td align="right"> </td>
<td> contains the EXIF sub directory </td>
</tr>
<tr>
<td> 0x8825 / 34853 </td>
<td> GPS data </td>
<td align="right"> 4=pointer</td>
<td align="right"> </td>
<td> points to the GPS data </td>
</tr>
</tbody>
</table>
</p>
<h4>2.4.1 EXIF tags</h4>
<table border="1" cellpadding="2">
<tbody>
<tr>
<th> Tag value </th>
<th> Name </th>
<th> Type </th>
<th> Length </th>
<th> Description</th>
</tr>
<tr>
<td> 0x829a / 33434 </td>
<td> exposureTime </td>
<td align="right"> 5=rational</td>
<td align="right"> 1</td>
<td> exposure time. 660=0.1666 sec </td>
</tr>
<tr>
<td> 0x829d / 33437 </td>
<td> fNumber </td>
<td align="right"> 5=rational</td>
<td align="right"> 1</td>
<td> fNumber. 668=4 (f/4.0) </td>
</tr>
<tr>
<td> 0x927c / 37500 </td>
<td> <b>Makernote</b> </td>
<td align="right"> pointer</td>
<td align="right"> </td>
<td> contains the Makenote sub directory </td>
</tr>
</tbody>
</table>
<h4>2.4.2 Makernote</h4>
<p>
See <a href="http://www.sno.phy.queensu.ca/%7Ephil/exiftool/TagNames/Canon.html">Exiftool</a>
page for all Canon tags details.
</p>
<p>
<table border="1" cellpadding="2">
<tbody>
<tr>
<th> Tag value </th>
<th> Name </th>
<th> Type </th>
<th> Length </th>
<th> Description</th>
</tr>
<tr>
<td> 0x0001 / 1 </td>
<td> CameraSettings </td>
<td align="right"> 3=unsigned_short</td>
<td align="right"> 47</td>
<td> camera settings </td>
</tr>
<tr>
<td> 0x0002 / 2 </td>
<td> focusInfo </td>
<td align="right"> 3=unsigned_short</td>
<td align="right"> 4</td>
<td> focus info </td>
</tr>
<tr>
<td> 0x0006 / 6 </td>
<td> imageType </td>
<td align="right"> 2=string</td>
<td align="right"> 15</td>
<td>Examples:<br>
"Canon EOS 450D"<br>
</td>
</tr>

<tr>
<td> 0x0097 </td>
<td> DustDeleteData </td>
<td align="right"> 7=byte sequence</td>
<td align="right"> 1024</td>
<td>See <a href="http://www.freepatentsonline.com/7657116.html">United States Patent 7657116</a>
</td>
</tr>



<tr>
<td> 0x00e0 / 224 </td>
<td> sensorInfo </td>
<td align="right"> 3=unsigned_short</td>
<td align="right"> 17</td>
<td>
<table border="1" cellpadding="2">
<tbody>
<tr>
<th> Offset </th>
<th> Name </th>
<th> Type </th>
<th> Length </th>
<th> Description</th>
</tr>
<tr>
<td> 0x0001 / 1 </td>
<td> sensorWidth </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 3944 for the 40D, 4312 for the 450D, 3948 for the 1000D </td>
</tr>
<tr>
<td> 0x0002 / 2 </td>
<td> sensorHeight </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 2622 for the 40D, 2876 for the 450D, 2622 for the 1000D </td>
</tr>
<tr>
<td> 0x0005 / 5 </td>
<td> sensorLeftBorder </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 40 for the 40D, 32 for the 450D, 52 for the 1000D </td>
</tr>
<tr>
<td> 0x0006 / 6 </td>
<td> sensorTopBorder </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 23 for the 40D, 23 for the 450D, 23 for the 1000D </td>
</tr>
<tr>
<td> 0x0007 / 7 </td>
<td> sensorRightBorder </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 3927 for the 40D, 4303 for the 450D, 3939 for the 1000D </td>
</tr>
<tr>
<td> 0x0008 / 8 </td>
<td> sensorBottomBorder </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 2614 for the 40D, 2870 for the 450D, 2614 for the 1000D </td>
</tr>
<tr>
<td> 0x0009 / 9 </td>
<td> blackMaskLeftBorder </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td>  </td>
</tr><tr>
<td> 0x000a / 10 </td>
<td> blackMaskTopBorder </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> </td>
</tr><tr>
<td> 0x000b / 11 </td>
<td> blackMaskRightBorder </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td>  </td>
</tr><tr>
<td> 0x000c / 12 </td>
<td> blackMaskBottomBorder </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td>  </td>
</tr>
</tbody>
</table>
</td>
</tr>

<tr>
<td> 0x4001 / 16385 </td>
<td> colorBalance </td>
<td align="right"> 3=unsigned_short</td>
<td align="right"> variable<br>1227 for 450D</td>
<td> exists for all EOS models, and for the G10<br>
in this section:

 <table border="1" cellpadding="2">
 <tbody>
 <tr>
 <th> Offset </th>
 <th> Name </th>
 <th> Type </th>
 <th> Length </th>
 <th> Description</th>
 </tr>
 <tr>
 <td> 0x003f / 63 
 <br>(for 450D and 400D) </td>
 <td> RGGB_Level_As_Shot </td>
 <td align="right"> short</td>
 <td align="right"> 4</td>
 <td> Example:<br>
 [2564, 1024, 1024, 1254] for [R, G1, G2, B] white balance levels. </td>
 </tr>
 </tbody>
 </table>
</td>
</tr>

<tr>
<td> 0x4002 </td>
<td> ? </td>
<td align="right"> 3=unsigned_short</td>
<td align="right"> variable</td>
<td> only in .cr2, not in .jpg. <a href="http://lclevy.free.fr/cr2/4002.txt">details</a></td>
</tr>

<tr>
<td> 0x4003 </td>
<td> ? </td>
<td align="right"> 3=unsigned_short</td>
<td align="right"> 22</td>
<td> tag exists in 1D Mark II, 20D, 1Ds Mark II and 350D only. no tag since the 5D</td>
</tr>

<tr>
<td> 0x4004 </td>
<td> ? </td>
<td align="right"> 3=unsigned_short</td>
<td align="right"> 304</td>
<td> tag exists in 1D Mark II and 1Ds Mark II only.</td>
</tr>

<tr>
<td> 0x4005 </td>
<td> ? </td>
<td align="right"> 7=bytes sequence</td>
<td align="right"> variable</td>
<td> tag exists since the 5D and for the 5D Mark II. Only in .cr2, not in .jpg. <a href="http://lclevy.free.fr/cr2/4005.txt">structure</a></td>
</tr>

<tr>
<td> 0x4008 </td>
<td> BlackLevel? </td>
<td align="right"> 3=unsigned_short</td>
<td align="right"> 3</td>
<td> since the 5D. always [129, 129, 129]</td>
</tr>

<tr>
<td> 0x4009 </td>
<td> ? </td>
<td align="right"> 3=unsigned_short</td>
<td align="right"> 3</td>
<td> since the 5D, often [0, 0, 0].<br>
excepts: 1D Mark III and 1Ds Mark III : [65535,65535,65535],<br>
5D and 1D Mark II N : [129,129,129]
</td>
</tr>

<tr>
<td> 0x4010 </td>
<td> ? </td>
<td align="right"> 1=unsigned_char</td>
<td align="right"> 32</td>
<td> since the 30D. Empty string.
</td>
</tr>

<tr>
<td> 0x4011 </td>
<td> ? </td>
<td align="right"> 1=unsigned_char</td>
<td align="right"> 252</td>
<td> since the 30D. Empty string.
</td>
</tr>

<tr>
<td> 0x4012 </td>
<td> ? </td>
<td align="right"> 1=unsigned_char</td>
<td align="right"> 32</td>
<td> since the 30D. Empty string.
</td>
</tr>

<tr>
<td> 0x4013 </td>
<td> AFMicroAdj </td>
<td align="right"> long</td>
<td align="right"> 5</td>
<td> for 1d m3, 1ds m3, 50d and 5d m2. often [20, 0, 0, 10, 0]. 20=5*sizeof(long)
</td>
</tr>

<tr>
<td> 0x4014 </td>
<td> ? </td>
<td align="right"> bytes</td>
<td align="right"> 0</td>
<td> only for 1d m3 and 1ds m3. 
</td>
</tr>

<tr>
<td> 0x4015 </td>
<td> Vignetting Correction<br>
<a href="http://www.usa.canon.com/dlc/controller?act=GetArticleAct&amp;articleID=2027">See</a> </td>
<td align="right"> bytes</td>
<td align="right"> 116 <br>(66 for G11 and S90)</td>
<td> since 50D. for 50D, 5D Mark II, 7D, S90 and G11. <br>
<table border="1" cellpadding="2">
<tbody>
<tr>
<th> Offset </th>
<th> Name </th>
<th> Type </th>
<th> Length </th>
<th> Description</th>
</tr>
<tr>
<td> 0x0000  </td>
<td> tag version </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 0x1000 (0x1080 for S90 and G11)</td>
</tr>
<tr>
<td> 0x0002  </td>
<td> tag length </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 116 (66 for G11 and S90) </td>
</tr>
<tr>
<td> 0x0004  </td>
<td> Correction applied  </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 1=yes, 0=no </td>
</tr>
<tr>
<td> 0x0006 </td>
<td> short?  </td>
<td align="right"> ?</td>
<td align="right"> 1</td>
<td> value=2 with S90 </td>
</tr>
<tr>
<td> 0x000c  </td>
<td> DPP correction value </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td>  </td>
</tr>
<tr>
<td> 0x000e  </td>
<td> ? </td>
<td align="right"> short?</td>
<td align="right"> 1</td>
<td> 0x25e4 for the S90 </td>
</tr>
<tr>
<td> 0x0014  </td>
<td> flags? </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 0x125c for 500D and the 50D, 0x10cc for 7D and 550D, 0x1900 for 5D Mark II, 0x7ee for S90 and G11 </td>
</tr>
<tr>
<td> 0x0016  </td>
<td> ImageWidth </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 4752 for 500D and 50D, 5184 for 7D and 550D, 5616 for 5D Mark II, 4896 for 1DMarkIV, 3648 for S90 and G11 </td>
</tr>
<tr>
<td> 0x0018  </td>
<td> ImageHeight </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 3168 for 500D and 50D, 3456 for 7D and 550D, 3744 for 5D Mark II, 3264 for 1DMarkIV, 2736 for S90 and G11 </td>
</tr>
<tr>
<td> 0x0028  </td>
<td> Lenses related data </td>
<td align="right"> bytes?</td>
<td align="right"> 10</td>
<td>
<pre>EF  85mm f/1.2 L II USM        = 70 04 DF 08 92 0C CA 0E FF 0F 
EF  17-40 f/4.0 L USM          = 70 04 DF 08 92 0C CA 0E FF 0F 
EF  70-300 f/4.0-5.6 IS USM    = 70 04 DF 08 92 0C CA 0E FF 0F 
EF  24-70 L f/2.8 USM          = 70 04 DF 08 92 0C CA 0E FF 0F
EF  70-200mm f/2.8 L IS USM    = 70 04 DF 08 92 0C CA 0E FF 0F
EF  70-200mm f/4.0 L IS USM    = 38 02 9D 09 92 0C 0C 0E FF 0F 
EF 100-400mm 4.5-5.6 L IS USM  = 70 04 DF 08 92 0C CA 0E FF 0F
EF 100mm f/2.8 Macro USM (190) = 70 04 DF 08 92 0C CA 0E FF 0F
EF 100mm 2.8 IS USM Macro (254)= 70 04 DF 08 92 0C 0C 0E FF 0F 
EF  24-105mm f/4.0 L IS USM    = 70 04 DF 08 92 0C 0C 0E FF 0F 
EF  28-135 f/3.5-5.6 IS USM    = 70 04 DF 08 92 0C 0C 0E FF 0F
EF  28-105mm f/3.5-4.5 USM     = 70 04 22 08 D4 0B 4F 0D FF 0F
EFS 15-85mm f/3.5-5.6 IS USM   = B2 03 EA 05 65 07 22 08 1A 0A 
EFS 18-55 f/3.5-5.6 IS         = B2 03 EA 05 65 07 DF 08 1A 0A 
EFS 17-55 f/2.8 IS USM         = B2 03 EA 05 65 07 DF 08 1A 0A
EFS 17-85 f/4-5.6 IS USM       = B2 03 EA 05 22 08 DF 08 1A 0A
EFS 60 f/2.8 Macro USm         = B2 03 EA 05 22 08 9D 09 1A 0A
EFS 18-135 f/3.5-5.6 IS        = B2 03 2D 05 EA 05 65 07 1A 0A
EFS 10-22 f/3.5-4.5 USM        = 38 02 2D 05 65 07 DF 08 1A 0A
EFS 18-200 f/3.5-5.6 IS        = F5 02 65 07 DF 08 9D 09 1A 0A 
EF  300mm f/2.8L IS USM (1Dm4) = F5 02 EA 05 5A 0A D4 0B FF 0F 
EF  16-35mm f/2.8L II USM(1Dm4)= F5 02 EA 05 5A 0A D4 0B FF 0F 
</pre>
 </td>
</tr>
<tr>
<td> 0x001a  </td>
<td> ? </td>
<td align="right"> bytes?</td>
<td align="right"> 12</td>
<td> aperture and focal dependent. NOT time value depend. </td>
</tr>
</tbody>
</table>

</td>
</tr>

<tr>
<td> 0x4016 </td>
<td> flags ? </td>
<td align="right"> long</td>
<td align="right"> 6 or 12</td>
<td> since 50D. for 50D and 5D Mark II. [24, 0, 1, 0, 1, 1]. 24=6*sizeof(long).
See <a href="http://lclevy.free.fr/cr2/periph_notes.txt">Peripheral Illumination Correction</a>.<br>not for G11
</td>
</tr>

<tr>
<td> 0x4017 </td>
<td> ? </td>
<td align="right"> long</td>
<td align="right"> 2 or 4</td>
<td> since 50D. for 50D and 5D Mark II.
</td>
</tr>

<tr>
<td> 0x4018 </td>
<td> ? </td>
<td align="right"> long</td>
<td align="right"> 3</td>
<td> [12, 1, 0]. since 7D. 12=3*sizeof(long)
</td>
</tr>

<tr>
<td> 0x4019 </td>
<td> ? </td>
<td align="right"> undefined</td>
<td align="right"> 30</td>
<td> since 7D. empty
</td>
</tr>

</tbody>
</table>
</p><p>
<a name="odd">
</a></p><h4><a name="odd">Tag 0x0083 (Original Decision Data)</a></h4><a name="odd">

See </a><a href="http://cpn.canon-europe.com/content/education/infobank/image_verification/canon_data_verification_system.do">Canon data verification system</a>
<p>
See Original Data Decision <a href="http://www.elcomsoft.com/canon.html">presentation</a> by Dmitry Sklyarov 
at <a href="http://201002.confidence.org.pl/prelegenci/dmitry-sklyarov">Confidence 2.0 event</a> (Nov 2010, Praha), 
which confirms and details information given below (and earlier).  <br>
See also <b><a href="https://github.com/lclevy/odd_verify">odd_verif.py</a></b>, my tool to recompute/check Original Data Decision records.
</p><p>
</p></li><li>version 2 (Since 1D Mark II, verified with 20D)
<p>
From a 20D picture:
</p><pre style="BACKGROUND-COLOR: #c0c0c0">tag = 0x83/131, type = 4, length = 0x1/1, val = 0x6ec6b6/7259830 // in version 2 the tag is at the end of the file

0xffffffff , version = 0x00000002

0x5b023f80  0x1151f699  0xfef676cc  0xc80b18c5  0x42a3e08f       //this is certainly a first hmac (key is unknown)

hash_nb = 0x00000004
i=00, offset=0x000934ca, length=0x006591ec                           // offset and length of the RAW image, from IFD#3, tag 0x111 and 0x117.
             // 0x934ca+0x6591ec = 0x6ec6b6, the content of tag 0x83 ... excluded from the signatures
hmac=  0xcd0e98f2  0xad6d70fb  0xb24ce020  0x4c372016  0x25231f06    // certainly hmac-sha1 of this part
i=01, offset=0x00000000, length=0x0000006e                           // offset and length, from beginning of the file to just before 
                                                                     // orientation data value : tag 0x112. 
								     // could be modified by the camera after writing the 0x83 option... 
								     // so the signature must not depend on it. 4 bytes are ignored here
hmac=  0x4c702549  0xefcd6ca3  0xacf7a655  0xca38103c  0xda1af95f
i=02, offset=0x00000072, length=0x00000308                           // offset and length, after orientation value and just before pointer value... of the 0x83 tag.
4bytes are ignored (72+308=37a)
hmac=  0xd4a069de  0x99fba2b6  0xcc997593  0x210dd382  0x5d974b28
i=03, offset=0x0000037e, length=0x0009314c                           // offset and length, after tag 0x83 pointer until start of RAW data
hmac=  0x2487424c  0x0c81f0cb  0x2f4616e5  0xa2a06aa0  0x27951e8b 
</pre>

</li><li>version 3 (since 1D Mark III, verified with 450D, 40D, 7D):
<p>
From a 450D picture:
</p><pre style="BACKGROUND-COLOR: #c0c0c0">tag = 0x83/131, type = 4, length = 0x1/1, val = 0x11f0/4592

0xffffffff , version = 0x00000003
0x00000014  0x43abeb8a  0xfa3b8292  0xd455d49c  0xaa30292e  0x4c5f1be4          // first hmac-sha1 ? 20 bytes long == 0x14
0x00000014  0x97e19112  0xb26d3832  0x9f334f5f  0x563d0a30  0x709af924          // hmac-sha1 ?

0x00000228  // tag length
0x00000004  0x82b30b24  
0x00000003  0x00e866e9 // filesize
0x00000001  0x00000002  0x4e9ff8d5  0x607b5171  0x00000008

0x00000001  0x00000004  0x5e787eaf              // salt ? maybe to avoid recovering the secret key using a known clear text attack...
0x00000014  0x01c63a70  0xb674e0e2  0x9357db27  0x86c27ea7  0xb5ecf477 // hmac-sha1 ?
0x00000001  0x0018edfe  0x00cf78e9              // IFD3, tag 111+2, tag 117-4

0x00000002  0x00000004  0x27745229              // salt ?
0x00000014  0x1c5d2a1e  0x524ea087  0xed3032b3  0x06206bfa  0x4d6d5594          // hmac ?
n=0xa,                             // number of (offset, length) records to sha1 or hmac-sha1. 40d has 9 records, 7d have 10.
0x00000000 0x0000006e,             // before orientation value
0x00000072 0x00000476,             // after orientation value (72+476=4e8), skip makernote tag 3 value ?
0x000004ec 0x00000d04,             // 4ec+d04 = 11f0 == entire tag 0x83
0x00001450 0x00007e4c,             // after tag 0x83 . 1450+7e4c = 929c == user comment (tag 0x9286), len == 0x108
0x000093a4 0x00000166,             // 929c+108 = 93a4. 93a4+166 = 950a . IFD1, tag 0x201 ?
0x0000a21f 0x00000002,             // ???
0x0000a224 0x00000002,             // jpeg ffd8 ? IFD#0 picture (see tag 111)
0x00075caf 0x00000002,             // before picture of IFD#2, which pointer is tag 111 (value = 0x75cb4)
0x0018edfc 0x00000002,             // IFD#3, tag111 == 0x18edfc
0x00e866e7 0x00000002,             // end of file == 0x00e866e9

0x00000003  0x00000004  0x489f4754
0x00000014  0xa3a03349  0x516aa5a8  0xef830153  0x0f816991  0x4f422ecd
0x00000001  0x0000006e  0x00000004           // 6e=offset, 4==length

0x00000004  0x00000004  0x846c0e49
0x00000014  0xb65eaeb1  0xbc9c0aec  0x776aa98d  0xce081e1f  0x3da3b8bd
0x00000001  0x0000929c  0x00000108           // user comment, tag 9286, length=0x108

0x00000005  0x00000004  0x1dfe44f7
0x00000014  0x485868db  0xfa7f2ba6  0x102da3f5  0x8ef4b93b  0x245e8a8a
0x00000001  0x000004e8  0x00000004           // makernote, tag#3, flashinfo ?

0x00000006  0x00000004  0xf3de7c77
0x00000014  0xb2a9b992  0x8facb2bc  0x51c09c1c  0x2e708683  0x95a4c7c7
0x00000001  0x0000950a  0x00000d15           // ifd#1. tag201=9508 (+2), tag202=d19 (-4)

0x00000007  0x00000004  0xaf10d72c
0x00000014  0x155a434c  0xc5562c7a  0xef7a80b3  0x9e11fa5d  0x519b4dfe
0x00000001  0x0000a226  0x0006ba89           // ifd#0. tag111=a224 (+2), tag117=6da8d (-4 in tag83)

0x00000008  0x00000004  0xbae225a2
0x00000014  0xc6b71c64  0x2eaf9d18  0x39734de0  0x4ed2f053  0xca260f1c
0x00000001  0x00075cb4  0x00119148           // ifd#2. tag111 and tag 117 exactly
</pre>

<a name="ddd">
<h4>Tag 0x0097 (Dust Delete Data, DDD)</h4>

This tag has been introduced with the </a><a href="http://cpn.canon-europe.com/content/education/technical/eos_integrated_cleaning_system.do">EOS Integrated Cleaning System</a> with camera 400d (August 2006), 1D Mark III and 40D (08/2007).
See this <a href="http://www.freepatentsonline.com/7657116.html">patent</a>.<br>
This tag is also present in jpeg pictures produced by the camera.
<p>
450D, 550D, 5d Mark III, 650D have DDD Tag in version 0:
<table border="1" cellpadding="2">
<tbody>
<tr>
<th> Offset </th>
<th> Name </th>
<th> Type </th>
<th> Length </th>
<th> Description</th>
</tr>

<tr>
<td> 0x00 </td>
<td> version </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 0
</td>
</tr>
<tr>
<td> 0x01 </td>
<td> LensInfo </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 0x02 </td>
<td> AVValue </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 0x03 </td>
<td> POValue </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 0x04 </td>
<td> DustCount </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> how many dust data in the following table
</td>
</tr>
<tr>
<td> 0x06 </td>
<td> FocalLength </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 0x08 </td>
<td> LensID </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> See ExifTool table
</td>
</tr>
<tr>
<td> 0x0a </td>
<td> Width </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 
</td>
</tr><tr>
<td> 0x0c </td>
<td> Height </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 
</td>
</tr><tr>
<td> 0x0e </td>
<td> RAW_Width </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 
</td>
</tr><tr>
<td> 0x10 </td>
<td> RAW_Height </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 
</td>
</tr><tr>
<td> 0x12 </td>
<td> PixelPitch </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> in 1/1000 um
</td>
</tr><tr>
<td> 0x14 </td>
<td> LpfDistance </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> in 1/1000 mm
</td>
</tr><tr>
<td> 0x16 </td>
<td> TopOffset </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 0
</td>
</tr><tr>
<td> 0x17 </td>
<td> BottomOffset </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 0
</td>
</tr><tr>
<td> 0x18 </td>
<td> LeftOffset </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 0
</td>
</tr>
<tr>
<td> 0x19 </td>
<td> RightOffset </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 0
</td>
</tr>
<tr>
<td> 0x1a </td>
<td> Year </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 1900+value
</td>
</tr>
<tr>
<td> 0x1b </td>
<td> Month </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 1-12
</td>
</tr>
<tr>
<td> 0x1c </td>
<td> Day </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 0x1d </td>
<td> Hour </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 0x1e </td>
<td> Minutes </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 0x1f </td>
<td> BrigthDiff </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 0x22 </td>
<td> Dust records table </td>
<td align="right"> </td>
<td align="right"> 6*DustCount</td>
<td> 
</td>
</tr>
</tbody>
</table>
</p><p>
6D has version 1:

<table border="1" cellpadding="2">
<tbody>
<tr>
<th> Offset </th>
<th> Name </th>
<th> Type </th>
<th> Length </th>
<th> Description</th>
</tr>

<tr>
<td> 0x00 </td>
<td> Version </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> ==1
</td>
</tr>
<tr>
<td> 0x01 </td>
<td> LensInfo </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 0x02 </td>
<td> AVValue </td>
<td align="right"> <b>short</b></td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 0x04 </td>
<td> POValue </td>
<td align="right"> <b>short</b></td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 0x06 </td>
<td> DustCount </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> how many dust data in the following table
</td>
</tr>
<tr>
<td> 0x08 </td>
<td> FocalLength </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 0x0a </td>
<td> LensID </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> See ExifTool table
</td>
</tr>
<tr>
<td> 0x0c </td>
<td> Width </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 
</td>
</tr><tr>
<td> 0x0e </td>
<td> Height </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 
</td>
</tr><tr>
<td> 0x10 </td>
<td> RAW_Width </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 
</td>
</tr><tr>
<td> 0x12 </td>
<td> RAW_Height </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> 
</td>
</tr><tr>
<td> 0x14 </td>
<td> PixelPitch </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> in 1/1000 um
</td>
</tr><tr>
<td> 0x16 </td>
<td> LpfDistance </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> in 1/1000 mm
</td>
</tr><tr>
<td> 0x18 </td>
<td> TopOffset </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 0
</td>
</tr><tr>
<td> 0x19 </td>
<td> BottomOffset </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 0
</td>
</tr><tr>
<td> 0x1a </td>
<td> LeftOffset </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 0
</td>
</tr>
<tr>
<td> 0x1b </td>
<td> RightOffset </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 0
</td>
</tr>
<tr>
<td> 0x1c </td>
<td> Year </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 1900+value
</td>
</tr>
<tr>
<td> 0x1d </td>
<td> Month </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 1-12
</td>
</tr>
<tr>
<td> 0x1e </td>
<td> Day </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 0x1f </td>
<td> Hour </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 0x20 </td>
<td> Minutes </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 0x21 </td>
<td> BrigthDiff </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 0x24 </td>
<td> Dust records table </td>
<td align="right"> </td>
<td align="right"> 6*DustCount</td>
<td> 
</td>
</tr>
</tbody>
</table>
</p><p>
Dust records are:
</p><p>
<table border="1" cellpadding="2">
<tbody>
<tr>
<th> Offset </th>
<th> Name </th>
<th> Type </th>
<th> Length </th>
<th> Description</th>
</tr>

<tr>
<td> 0 </td>
<td> x </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> within Width
</td>
</tr>

<tr>
<td> 2 </td>
<td> y </td>
<td align="right"> short</td>
<td align="right"> 1</td>
<td> within Height
</td>
</tr>
<tr>
<td> 4 </td>
<td> size </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 
</td>
</tr>
<tr>
<td> 5 </td>
<td> ? </td>
<td align="right"> byte</td>
<td align="right"> 1</td>
<td> 0
</td>
</tr>

</tbody>
</table>
</p><p>
Examples

</p><p>
<b>550d</b>
</p><p>
</p><pre>0001503605003700f000200ac0064014800dcc10420e000000007001080f3b1d
0x00000000: Version = 0
0x00000001: LensInfo = 1
0x00000002: AVValue = 80
0x00000003: POValue = 54
0x00000004: DustCount = 5
0x00000006: FocalLength = 55
0x00000008: LensID = 240
0x0000000a: Width = 2592 (0xa20)
0x0000000c: Height = 1728 (0x6c0)
0x0000000e: RAW_Width = 5184
0x00000010: RAW_Height = 3456
0x00000012: PixelPitch  : 4300/1000 [um]
0x00000014: LpfDistance : 3650/1000 [mm]
0x00000016: TopOffset = 0
0x00000017: BottomOffset = 0
0x00000018: LeftOffset = 0
0x00000019: RightOffset = 0
0x0000001a: Year = 2012
0x0000001b: Month = 1
0x0000001c: Day = 8
0x0000001d: Hour = 15
0x0000001e: Minutes = 59
0x0000001f: BrightDiff = 29
dust table at 0x22:
e001f0001100 x= 480 y= 240 size=17
6b05dc040500 x=1387 y=1244 size=5
3a0915040400 x=2362 y=1045 size=4
610402040300 x=1121 y=1026 size=3
67070c050300 x=1895 y=1292 size=3 
</pre>
<p>
<b>6D</b>
</p><pre>01015000630004006200ed00b00a20076015400e96196608000000007103070f1b06
0x00000000: Version = 1
0x00000001: LensInfo = 1
0x00000002: AVValue = 80
0x00000004: POValue = 99
0x00000006: DustCount = 4
0x00000008: FocalLength = 98
0x0000000a: LensID = 237
0x0000000c: Width = 2736 (0xab0)
0x0000000e: Height = 1824 (0x720)
0x00000010: RAW_Width = 5472
0x00000012: RAW_Height = 3648
0x00000014: PixelPitch  : 6550/1000 [um]
0x00000016: LpfDistance : 2150/1000 [mm]
0x00000018: TopOffset = 0
0x00000019: BottomOffset = 0
0x0000001a: LeftOffset = 0
0x0000001b: RightOffset = 0
0x0000001c: Year = 2013
0x0000001d: Month = 3
0x0000001e: Day = 7
0x0000001f: Hour = 15
0x00000020: Minutes = 27
0x00000021: BrightDiff = 6
dust table at 0x24:
660ad9010400 x=2662 y= 473 size=4
60079a010300 x=1888 y= 410 size=3
6505c6010300 x=1381 y= 454 size=3
fe0296050300 x= 766 y=1430 size=3 
</pre>
<p>
<a href="http://lclevy.free.fr/cr2/450d_dust.txt">450D</a>, <a href="http://lclevy.free.fr/cr2/5dm3_dust.txt">5d Mark III</a>, <a href="http://lclevy.free.fr/cr2/650d_dust.txt">650D</a>
</p><p>
Example of jpeg analysis (exifprobe):
</p><pre>===== Start of JPEG data for IFD 0, data length 524974
    JPEG_SOI
      JPEG_DHT length 418 table class = 0 table id = 0
      JPEG_DQT length 132
      JPEG_SOF_0 length 17, 8 bits/sample, components=3, width=2256, height=1504
      JPEG_SOS length 12  start of JPEG data, 3 components 3393024 pixels
    JPEG_EOI JPEG length 524974
===== End of JPEG data ====
</pre>
<p>
</p><h3>2.5 IFD #1</h3>
<p>
The second IFD is containing a small RGB version (160x120 pixels) of
the picture compressed in Jpeg.
</p><p>
<table border="1" cellpadding="2">
<tbody>
<tr>
<th> Tag value </th>
<th> Name </th>
<th> Type </th>
<th> Length </th>
<th> Description</th>
</tr>
<tr>
<td> 0x0201 / 513 </td>
<td> thumbnailOffset </td>
<td align="right"> 4=long </td>
<td align="right"> 1</td>
<td> </td>
</tr>
<tr>
<td> 0x0202 / 514 </td>
<td> thumbnailLenght </td>
<td align="right"> 4=long </td>
<td align="right"> 1</td>
<td> </td>
</tr>
</tbody></table>
</p><p>
Example of IFD#1 jpeg (exifprobe):<br>
</p><pre>  #### Start of JPEG thumbnail data for IFD 1, length 8390 ####
  JPEG_SOI
    JPEG_DHT length 418 table class = 0 table id = 0
    JPEG_DQT length 132
    JPEG_SOF_0 length 17, 8 bits/sample, components=3, width=160, height=120
    JPEG_SOS length 12  start of JPEG data, 3 components 19200 pixels
  JPEG_EOI JPEG length 8390
  #### End of JPEG thumbnail data for IFD 1, length 8390 ####
</pre>
<p>
</p><h3>2.6 IFD #2</h3>
The third IFD is containing a small RGB version of the picture NOT compressed (even with compression==6) 
and one which no white balance correction has been applied.
<p>
<table border="1" cellpadding="2">
<tbody>
<tr>
<th> Tag value </th>
<th> Name </th>
<th> Type </th>
<th> Length </th>
<th> Description</th>
</tr>
<tr>
<td> 0x0100 / 256 </td>
<td> imageWidth </td>
<td align="right"> 3=unsigned_short </td>
<td align="right"> 1</td>
<td> 539 for the 450D<br>
486 for the 40D and 1000D<br>
476 for the 1Ds MarkIII
</td>
</tr>

<tr>
<td> 0x0101 / 257 </td>
<td> imageHeight</td>
<td align="right"> 3=unsigned_short </td>
<td align="right"> 1</td>
<td> 356 for the 450D<br>
324 for the 40D and 1000D<br>
312 for the 1Ds MarkIII
</td>
</tr>

<tr>
<td> 0x0102 / 258 </td>
<td> bitsPerSample </td>
<td align="right"> 3=unsigned_short </td>
<td align="right"> 3</td>
<td> [16,16,16] for 14 bits models (1Ds MarkIII, 40D, 450D),<br>
[16,16,16] for the G9 and 1000D (Digic III and 12bits),<br>
[8,8,8] for 12 bits models (30D, 400D, 1d MarkII, ...).
</td>
</tr>

<tr>
<td> 0x0103 / 259 </td>
<td> compression </td>
<td align="right"> 3=unsigned_short </td>
<td align="right"> 1</td>
<td> 1=uncompressed (450D, 40D, 1Ds MarkIII, 1000D)<br>
6=old_jpeg (5D, G9)</td>
</tr>
<tr>
<td> 0x0106 / 262 </td>
<td> photometricInterpretation </td>
<td align="right"> 3=unsigned_short </td>
<td align="right"> 1</td>
<td> 2=RGB (450D, G9, 5D, 1Ds MarkIII)</td>
</tr>

<tr>
<td> 0x0111 / 273 </td>
<td> stripOffset </td>
<td align="right"> 4=long </td>
<td align="right"> 1</td>
<td> </td>
</tr>

<tr>
<td> 0x0115 / 277 </td>
<td> samplesPerPixel </td>
<td align="right"> 3=unsigned_short </td>
<td align="right"> 1</td>
<td> 3 (20D, 450D)</td>
</tr>

<tr>
<td> 0x0116 / 278 </td>
<td> rowPerStrip </td>
<td align="right"> 3=unsigned_short </td>
<td align="right"> 1</td>
<td> 536 for the 450D<br>
324 for the 40D and 1000D<br>
312 for the 1Ds MarkIII</td>
</tr>

<tr>
<td> 0x0117 / 279 </td>
<td> stripByteCounts </td>
<td align="right"> 4=long </td>
<td align="right"> 1</td>
<td> 1151304 for 450D (=539*356*3*2)<br>
1131208 for 1000D
</td>
</tr>

<tr>
<td> 0x011c / 284 </td>
<td> planarConfiguration </td>
<td align="right"> 3=unsigned_short </td>
<td align="right"> 1</td>
<td> 1=chunky (G9, 450D, 5D)</td>
</tr>

<tr>
<td> 0xc5d9 /  </td>
<td> ? </td>
<td align="right"> 4=long </td>
<td align="right"> 1</td>
<td>value=2. always here (20D, 450D, 40D)
</td>
</tr>

<tr>
<td> 0xc6c5 /  </td>
<td> ? </td>
<td align="right"> 4=long </td>
<td align="right"> 3</td>
<td> seems here with 14bits models and 0xc6dc tag.<br>
here for the 1000D (12 bits and DigicIII)
</td>
</tr>

<tr>
<td> 0xc6dc / 50908 </td>
<td> ?<br>
only with 14bits models </td>
<td align="right"> 3=unsigned_short </td>
<td align="right"> 4</td>
<td> [536,356,3,0] for the 450D,<br>
[486,323,0,1] for the 40D and 1000D,<br>
[468,312,6,0] for 1Ds MarkIII.<br>
it seems that 536+3=539 (width) and 323+1=324 (height).<br>
maybe [columns, rows, columns2, rows2],<br>
but for 1Ds MarkIII: 468+6=474 and not 476.
</td>
</tr>

</tbody>
</table>
</p>

<p>
<b>values for unknown tags</b>

<table border="1" cellpadding="2">

<tbody><tr><th>model</th>
<th>0xc5d9</th>
<th>0xc6c5</th>
<th>0xc6dc</th>

</tr><tr>
<td>1D Mark II, 20D, 1Ds Mark II, 350D, 5D, 1D Mark IIn, 30D, 400D</td>
<td>2</td>
<td>no tag</td>
<td>no tag</td>
</tr>

<tr>
<td>1D MarkIII raw and sraw</td>
<td>2</td>
<td>3</td>
<td>[486,323,0,1]</td>
</tr>
<tr>

</tr><tr>
<td>G9</td>
<td>2</td>
<td>no tag</td>
<td>no tag</td>
</tr>

<tr>
<td>40D raw and sraw</td>
<td>2</td>
<td>3</td>
<td>[486,323,0,1]</td>
</tr>

<tr>
<td>1Ds MarkIII</td>
<td>2</td>
<td>3</td>
<td>[468,312,6,0]</td>
</tr>

<tr>
<td>1Ds MarkIII sraw</td>
<td>2</td>
<td>3</td>
<td>[468,312,0,0]</td>
</tr>

<tr>
<td>450D</td>
<td>2</td>
<td>3</td>
<td>[536,356,3,0]</td>
</tr>

<tr>
<td>1000D</td>
<td>2</td>
<td>3</td>
<td>[486,323,0,1]</td>
</tr>

<tr>
<td>50D</td>
<td>2</td>
<td>3</td>
<td>[594,396,9,0]</td>
</tr>
<tr>
<td>50D sraw1, sraw2</td>
<td>2</td>
<td>3</td>
<td>[594,396,0,0]</td>
</tr>

<tr>
<td>G10, SX1 IS, G11, S90, S95</td>
<td>2</td>
<td>3</td>
<td>[0,0,0,0]</td>
</tr>

<tr>
<td>5D Mark II</td>
<td>2</td>
<td>3</td>
<td>[348,232,13,2]</td>
</tr>

<tr>
<td>5D Mark II sraw1</td>
<td>2</td>
<td>3</td>
<td>[351,234,0,0]</td>
</tr>

<tr>
<td>5D Mark II sraw2</td>
<td>2</td>
<td>3</td>
<td>[459,309,4,3]</td>
</tr>

<tr>
<td>500D</td>
<td>2</td>
<td>3</td>
<td>[594, 396, 9, 0]</td>
</tr>

<tr>
<td>7D</td>
<td>2</td>
<td>3</td>
<td>[648, 432, 21, 0]</td>
</tr>

<tr>
<td>7D mraw, sraw</td>
<td>2</td>
<td>3</td>
<td>[432, 288, 0, 0]</td>
</tr>

<tr>
<td>1D Mark IV</td>
<td>2</td>
<td>3</td>
<td>[612, 408, 19, 0]</td>
</tr>

<tr>
<td>550D</td>
<td>2</td>
<td>3</td>
<td>[650, 432, 19, 0]</td>
</tr>

<tr>
<td>60D</td>
<td>2</td>
<td>3</td>
<td>[650, 432, 19, 0]</td>
</tr>

<tr>
<td>60D mraw, sraw</td>
<td>2</td>
<td>3</td>
<td>[432, 288, 0, 0]</td>
</tr>

<tr>
<td>5D Mark III raw</td>
<td>2</td>
<td>3</td>
<td>[577, 386, 14, 9]</td>
</tr>

</tbody></table>
</p><p>
Example:
</p><pre>Start of  TIFF RGB uncompressed image data for IFD 2, data length 1151304
    01 04 06 04  0d 04 09 04  ff 03 08 04  1a 04 1e 04  |................|
    0a 04 71 04  66 04 23 04  60 04 69 04  23 04 5f 04  |..q.f.#.`.i.#._.|
    5c 04 1a 04  4d 04 4f 04  14 04 47 04  3e 04 12 04  |\...M.O...G.&gt;...|
    4a 04 40 04  19 04 55 04  54 04 1a 04  69 04 6a 04  |J.@...U.T...i.j.| etc...
End of image data
</pre>
<p>

</p><h3>2.7 IFD #3</h3>
The fourth IFD is containing the RAW data compressed in lossless Jpeg.
The RAW offset field in the CR2 header is pointing to the beginning of
this IFD.<p>
This picture, once decoded, maybe split in several vertical strips, like for the 350D or the 5D. Each strip is then decoded from left to right.
The tag 0xc640 is indicating this specificity: If the tag is absent, the picture in in one part (like with the 20D), 
if it is present, it indicates the number of verticals strips, and their width. 
</p><p>
For the 450D, it is a 2156x2876 picture, with 14 bits and 2 components.
</p><p>
<table border="1" cellpadding="2">
<tbody>
<tr>
<th> Tag value </th>
<th> Name </th>
<th> Type </th>
<th> Length </th>
<th> Description</th>
</tr>
<tr>
<td> 0x0103 / 259 </td>
<td> compression </td>
<td align="right"> 3=unsigned_short </td>
<td align="right"> 1</td>
<td> 6=old Jpeg</td>
</tr>
<tr>
<td> 0x0111 / 273 </td>
<td> StripOffset </td>
<td align="right"> 4=unsigned_long </td>
<td align="right"> 1</td>
<td> offset to the RAW image data</td>
</tr>
<tr>
<td> 0x0117 / 279 </td>
<td> StripByteCounts </td>
<td align="right"> 4=unsigned_long </td>
<td align="right"> 1</td>
<td> length of the RAW image data</td>
</tr>
<tr>
<td> 0xc5d8 / 50648 </td>
<td> ? </td>
<td align="right"> 4=unsigned_long </td>
<td align="right"> 1</td>
<td> 1 for 350D, 450D, G9, 40D, 5D, 1Ds MarkIII.<br>
0 for 1D MarkII, 20D. </td>
</tr>

<tr>
<td> 0xc5e0 / 50656 </td>
<td> ? </td>
<td align="right"> 4=unsigned_long </td>
<td align="right"> 1</td>
<td> always 1 </td>
</tr>
<tr>
<td> 0xc640 / 50752 </td>
<td> cr2 slice </td>
<td align="right"> 3=unsigned_short </td>
<td align="right"> 3</td>
<td> [2, 1440, 1432] for the 450D, which means 2 first
strips of 1440 pixels and the last strip of 1432 pixels.<br>
[1, 1952, 1972] for the 40D, which means 1 first strip of 1952 pixels
and the last strip of 1972 pixels. </td>
</tr>
<tr>
<td> 0xc6c5 / 50885 </td>
<td> ? </td>
<td align="right"> 4=unsigned_long </td>
<td align="right"> 1</td>
<td> 1 for 40D Raw, 450D, 1000D, 50D Raw, 5D Mark II and 1DsMarkIII Raw, <br>
4 for 40D sRaw, 50D sRaw1+sRaw2, 5D Mark II sRaw1+sRaw2 and 1Ds MarkIII sRaw.<br>
no tag for G9, 5D, 350D, 20D. 
</td>
</tr></tbody>
</table>
</p><p>
See section 9.1 for the values of the 0xC640 tag per models

</p><p>
</p><hr>
<p>

<a name="lossless">
</a></p><h2><a name="lossless">3. Decode the lossless jpeg grayscale picture</a></h2><a name="lossless">

See also this visual document : </a><a href="https://github.com/lclevy/libcraw2/blob/master/docs/cr2_lossless.pdf?raw=true">Lossless Jpeg compression</a>.<br>

<h3>3.1. Introduction</h3>

The RAW or the sRAW data is in IFD #3, encoded in Jpeg lossless format. See <a href="http://www.w3.org/Graphics/JPEG/itu-t81.pdf">ITU-T81</a> document.
This is NOT the JPEG-LS compression (ISO/CEI 14495-1, UIT T.87) !
<p>
Before decompression, the image is stored as vertical "slices", from left to right. <br>
Number and dimensions of these slices are stored in Tag 0xc640 of IFD#3,
this array is noted "cr2_slice[]" and stores 3 values. N-1 is stored in cr2_slices[0] if there is N slices.
</p><p>
<table border="1" cellpadding="2">
<tbody><tr height="400" style="BACKGROUND-COLOR: #c0c0c0">
<td valign="top" width="150">
<b>Slice #0</b><br>
height = jpeg high value <br>
width = cr2_slice[1]<br>
</td>
<td valign="top" width="150">
...
</td>
<td valign="top" width="150">
<b>Slice #N-2</b><br>
height = jpeg high value <br>
width = cr2_slice[1]
</td>
<td valign="top" width="150">
<b>Slice #N-1</b><br>
height = jpeg high value<br>
width = cr2_slice[2]<br>
</td>
</tr>
</tbody></table>
</p><p>
Of course, cr2_slices[0]*cr2_slices[1] + cr2_slices[2] = image_width.
</p><p>
We can suppose that this data organisation is used to allow some parallelization between the sensor and the DDR memory : 
two slices might be transfered or processed simulteanously, or it might be due to memory constraints.
</p><p>
In <a href="http://cpn.canon-europe.com/content/technical/eos7d.do">Inside the Canon EOS 7D: examining the technology and its benefits</a>, page 2, 
it is written that the 7D has two Digic4 processors, each of them having a "4-channel pipeline to process", which is entitled "8 channel readout". 
</p><p>
Thus, we have to decompress first, slice#0 (from row#0 to row #(height-1) ), then slice#1, ..., and ends with slice #n-1.

<a name="sraw">
</a></p><h3><a name="sraw">3.2. the sRaw data</a></h3><a name="sraw">

The sRaw format (for "small RAW") was introduced with the 1D Mark III in 2007. It is a smaller version of the RAW picture.
<p>
For the 1D Mark III, then the 1Ds Mark III and the 40D (all with the Digic III), the sRaw size is exactly 1/4 (one fourth) of the RAW size. 
We can thus suppose than each group of 4 "sensor pixels" is summarized into 1 "pixel" for the sRaw. 
</p><p>
With the 50D and the 5D Mark II (with the Digic IV chip), the 1/4th size RAW is still there (sRaw2), and a half size RAW is also appearing : sRaw1.<br>
With the 7D, the half size raw is called mraw (same encoding as sraw1), 1/4th raw is called sraw (like the sraw2).
</p><p>
the sRaw lossless Jpeg is always encoded with 3 colors component (nb_comp) and 15 bits.
</p><p>
<table border="1" cellpadding="2">
<tbody><tr style="BACKGROUND-COLOR: #c0c0c0">
<td valign="top">
<pre>(40D sraw)
JPEG_SOF3: length=17
 bits=15, wide=1944, high=1296, nb comp=3
  index=1, h=2, v=1, qt=0
  index=2, h=1, v=1, qt=0
  index=3, h=1, v=1, qt=0
</pre>
</td>
<td valign="top">
<pre>(1Ds Mark III sraw)
JPEG_SOF3: length=17
 bits=15, wide=2808, high=1872, nb comp=3
  index=1, h=2, v=1, qt=0
  index=2, h=1, v=1, qt=0
  index=3, h=1, v=1, qt=0
</pre>
</td>
</tr>

<tr>
<td style="BACKGROUND-COLOR: #c0c0c0" valign="top">
<pre>  
(50D sraw2)  
JPEG_SOF3: length=17
 bits=15, wide=2376, high=1584, nb comp=3
  index=1, h=2, v=1, qt=0
  index=2, h=1, v=1, qt=0
  index=3, h=1, v=1, qt=0
</pre>
</td>
<td style="BACKGROUND-COLOR: #ff9900" valign="top">
<pre>(50D sraw1)  
JPEG_SOF3: length=17
 bits=15, wide=3344, high=2178, nb comp=3
  index=1, h=2, v=2, qt=0
  index=2, h=1, v=1, qt=0
  index=3, h=1, v=1, qt=0
</pre>
</td>
</tr>

<tr>
<td style="BACKGROUND-COLOR: #c0c0c0" valign="top">
<pre>  
(5D Mark II sraw2)  
JPEG_SOF3: length=17
 bits=15, wide=2808, high=1872, nb comp=3
  index=1, h=2, v=1, qt=0
  index=2, h=1, v=1, qt=0
  index=3, h=1, v=1, qt=0
</pre>
</td>
<td style="BACKGROUND-COLOR: #ff9900" valign="top">
<pre>(5D Mark II sraw1)  
JPEG_SOF3: length=17
 bits=15, wide=3872, high=2574, nb comp=3
  index=1, h=2, v=2, qt=0
  index=2, h=1, v=1, qt=0
  index=3, h=1, v=1, qt=0  
</pre>
</td>
</tr>

<tr>
<td style="BACKGROUND-COLOR: #c0c0c0" valign="top">
<pre>  
(7D sraw)  
JPEG_SOF3: length=17
 bits=15, high=1728, wide=2592, nb comp=3
  index=1, h=2, v=1, qt=0
  index=2, h=1, v=1, qt=0
  index=3, h=1, v=1, qt=0
</pre>
</td>
<td style="BACKGROUND-COLOR: #ff9900" valign="top">
<pre>(7D mraw)  
JPEG_SOF3: length=17
 bits=15, high=2592, wide=3888, nb comp=3
  index=1, h=2, v=2, qt=0
  index=2, h=1, v=1, qt=0
  index=3, h=1, v=1, qt=0
</pre>
</td>
</tr>

<tr>
<td style="BACKGROUND-COLOR: #c0c0c0" valign="top">
<pre>  
(1D Mark IV s-raw)  
JPEG_SOF3: length=17
 bits=15, high=1632, wide=2448, nb comp=3
  index=1, h=2, v=1, qt=0
  index=2, h=1, v=1, qt=0
  index=3, h=1, v=1, qt=0
</pre>
</td>
<td style="BACKGROUND-COLOR: #ff9900" valign="top">
<pre>(1D Mark IV m-raw) 
JPEG_SOF3: length=17
 bits=15, high=2448, wide=3672, nb comp=3
  index=1, h=2, v=2, qt=0
  index=2, h=1, v=1, qt=0
  index=3, h=1, v=1, qt=0
</pre>
</td>
</tr>



</tbody></table>
</p><p>
Jpeg code of Dcraw was first modified (8.79) to handle sRaw because of the h=2 value of the first component (grey background in the table). Normal RAW have always h=1. <br>
Starting with the 50D, we have v=2 instead of v=1 (orange in the table). Dcraw 8.89 is the first version to handle this and the sraw1 from 50d and 5D Mark II.
</p></a><p><a name="sraw">
"h" is the horizontal sampling factor and "v" the vertical sampling factor. It specifies how many horizontal/vertical data unit are encoded in each MCU (minimum coded unit). 
See </a><a href="http://www.w3.org/Graphics/JPEG/itu-t81.pdf">T-81</a>, page 36.<br>

</p><h4>3.2.1. sRaw and sRaw2 format</h4>

h=2 means that the decompressed data will contain 2 values for the first component, 1 for column n and 1 for column n+1. With the 2 other components, 
decompressed sraw and sraw2 (which all have h=2 &amp; v=1), always have 4 elementary values : 
<pre style="BACKGROUND-COLOR: #c0c0c0">[ y1 y2 x z ] [ y1 y2 x z ] [ y1 y2 x z ] ...
(y1 and y2 for first component)

y2 belongs to the next image column, thus a row will look like:
[ y1 x z ] [ y2 . . ] [ y1 x z ] [ y2 . . ] [ y1 x z ] [ y2 . . ] ...

Each value has 15 bits. y1 and y2 are <b>unsigned</b>. x and z must be interpreted as <b>signed</b>. 

(these 2 lines from Dcraw are a 'sign extension' operation (for our x and z):
	      ip[1] = (short) (rp[jcol+2] &lt;&lt; 2) &gt;&gt; 2;
	      ip[2] = (short) (rp[jcol+3] &lt;&lt; 2) &gt;&gt; 2;)

</pre>
<a href="http://forums.dpreview.com/forums/read.asp?forum=1019&amp;message=26234685">Gao YANG suggested on DPReview forums</a> 
these data are Y Cb Cr (luminance/chrominance blue/chrominance red) because the following transformation in Dcraw is a <b>YCbCr to sRGB</b> conversion:
<pre style="BACKGROUND-COLOR: #c0c0c0">in Dcraw 8.88 in canon_sraw_load_raw() 
(I have added comments)

      pix[0] = ip[2] + ip[0];
      pix[2] = ip[1] + ip[0];
      pix[1] = ((ip[0] &lt;&lt; 12) - ip[1]*778 - (ip[2] &lt;&lt; 11)) &gt;&gt; 12;
      /* 
       * 778/(2^12) = 0.19 and (2^11)/(2^12) = 0.5
       * it becomes: pix[1] = ip[0] - ip[1]*0.19 - ip[2]*0.5
       */               
</pre>
as Gao said, if ip[1] = 2Cb and ip[2] = 1.6Cr, the Dcraw formula becomes :
<pre style="BACKGROUND-COLOR: #c0c0c0">R = 1.6Cr + Y
B = 2Cb + Y
G = Y - 0.38 Cb - 0.8 Cr
</pre>
which is very close to the YCbCr to <b>RGB</b> transformation described in <a href="http://www.w3.org/Graphics/JPEG/jfif3.pdf">JFIF specification</a>, page 3.
<pre style="BACKGROUND-COLOR: #c0c0c0">R = Y + 1.40 Cr
G = Y - 0.34414 Cb - 0.71414 Cr
B = Y + 1.772 Cb
</pre>
<p style="COLOR: #ff0000">
sRaw and sRaw2 (and surely sRaw1) are encoded in YCbCr format, and not as CFA RGB data like full RAW ! 
</p>
thus sRaw and sRaw2 original format is
<pre style="BACKGROUND-COLOR: #c0c0c0">[ Y1 Cb Cr ] [ Y2 . . ] [ Y1 Cb Cr ] [ Y2 . . ] [ Y1 Cb Cr ] [ Y2 . . ] ...
</pre>
Gao also highlighted in his message the interpolation for missing Cb and Cr values for even colums.<br>
Let's see in Dcraw:
<pre style="BACKGROUND-COLOR: #c0c0c0">(comments are from me)

    for (col=1; col &lt; width-1; col+=2, ip+=8) {
      //  Cb[row][column] = ( Cb[row][column-1] + Cb[row][column+1] + 1 ) / 2 
      ip[1] = (ip[-3] + ip[5] + 1) &gt;&gt; 1;
      //  Cr[row][column] = ( Cr[row][column-1] + Cr[row][column+1] + 1 ) / 2 
      ip[2] = (ip[-2] + ip[6] + 1) &gt;&gt; 1;
    }
</pre>
after interpolation (interpolated data has the * sign)
<pre style="BACKGROUND-COLOR: #c0c0c0">[ Y1 Cb Cr ] [ Y2 Cb* Cr* ] [ Y1 Cb Cr ] [ Y2 Cb* Cr* ] [ Y1 Cb Cr ] [ Y2 Cb* Cr* ] ...
</pre>
<p>
After all, YCbCr is not surprising. Sraw has appeared exactly at the same time than the liveview feature, which is known to require a special sensor... 
maybe with a YCbCr low-resolution capture mode, in order to easily display the picture on the LCD and later record it on the memory card ... several time per second.
</p><p>
US Patents <a href="http://www.freepatentsonline.com/7542076.html">7542076</a> and 
<a href="http://www.freepatentsonline.com/6958772.html">6958772</a> describe such a RGB to YUV conversion.

<!--  http://www.patents.com/IMAGE-SENSING-APPARATUS-AND-IMAGE-PROCESSING-METHOD-THEREFOR/US20090207275/en-US/ 
US7589858 http://www.patents.com/Image-processing-apparatus-method-image-output-unit-well-digital-camera-portable-terminal-using-imag/US7589858/en-US/
US6958772 http://www.patents.com/Image-sensing-apparatus-image-processing-therefor/US6958772/en-US/
-->

</p><h4>3.2.2. sRaw1 (mraw) format</h4>

<table border="1" cellpadding="2">
<tbody><tr valign="top">
<td style="BACKGROUND-COLOR: #ff9900" valign="top">
<pre>(50D sraw1)  
JPEG_SOF3: length=17
 bits=15, wide=3344, high=2178, nb comp=3
  index=1, h=2, v=2, qt=0
  index=2, h=1, v=1, qt=0
  index=3, h=1, v=1, qt=0
</pre>
</td>
<td style="BACKGROUND-COLOR: #ff9900" valign="top">
<pre>(5D Mark II sraw1)  
JPEG_SOF3: length=17
 bits=15, wide=3872, high=2574, nb comp=3
  index=1, h=2, v=2, qt=0
  index=2, h=1, v=1, qt=0
  index=3, h=1, v=1, qt=0  
</pre>
</td>
</tr>
</tbody></table>
<p>
h=2 and v=2 means that 4 values (2*2) are recorded for the 1st component. With the 2 others components, it make a group of 6 values:
</p><pre style="BACKGROUND-COLOR: #c0c0c0">[ y1 y2 y3 y4 Cb Cr ] [ y1 y2 y3 y4 Cb Cr ] [ y1 y2 y3 y4 Cb Cr ] ...
</pre>
which must be interpretated this way
<pre style="BACKGROUND-COLOR: #c0c0c0">row i  : [y1 Cb Cr ] [ y2 . . ] [y1 Cb Cr ] [ y2 . . ] 
row i+1: [y3 .  .  ] [ y4 . . ] [y3 .  .  ] [ y4 . . ]
</pre>
in dcraw 8.89, the interpolation for Cb Cr is done this way:
<ol>
<li>For odd rows, same linear interpolation, inside a row, as in sraw and sraw2 : Cb and Cr in even colums in interpolated from values in previous and next columns.
</li><li>For even rows, for each column, the Cb and Cr values are interpolated from the previous and next rows in the same column. <br>
Cb and Cr values in the cell with "y4" are inperpolated from interpolated values. Any link with the "vertical banding effect" when applied by Canon ? 
</li></ol>
We have now
<pre style="BACKGROUND-COLOR: #c0c0c0">         column n      column n+1     column n+2   column n+3      ...
row i  : [y1 Cb  Cr ] [ y2 Cb*  Cr* ] [y1 Cb  Cr ] [ y2 Cb*  Cr* ] ... 
row i+1: [y3 Cb* Cr*] [ y4 Cb** Cr**] [y3 Cb* Cr*] [ y4 Cb** Cr**] ...
row i+2: [y1 Cb  Cr ] [ y2 Cb*  Cr* ] [y1 Cb  Cr ] [ y2 Cb*  Cr* ] ...
row i+3: [y3 Cb* Cr*] [ y4 Cb** Cr**] [y3 Cb* Cr*] [ y4 Cb** Cr**] ...
...
(n and i are odd)
</pre>
the number of ** is the level of interpolation.
<p>
Let's see how Dcraw 8.89 is doing in canon_sraw_load_raw():
</p><pre style="BACKGROUND-COLOR: #c0c0c0">(comments are from me)

  for ( ; rp &lt; ip[0]; rp+=4) {
    if (unique_id &lt; 0x80000200) { // same processing as in dcraw 8.88 for sraw...
      pix[0] = rp[0] + rp[2] - 512;
      pix[2] = rp[0] + rp[1] - 512;
      pix[1] = rp[0] + ((-778*rp[1] - (rp[2] &lt;&lt; 11)) &gt;&gt; 12) - 512;
    } else { // for 50D, 5D Mark II ... but also 1Ds Mark III (model_id=0x80000215, only sraw) and 400D (model_id=0x80000236)
      rp[1] += jh.sraw+1;
      rp[2] += jh.sraw+1;
      pix[0] = rp[0] + ((  200*rp[1] + 22929*rp[2]) &gt;&gt; 12);
      pix[1] = rp[0] + ((-5640*rp[1] - 11751*rp[2]) &gt;&gt; 12);
      pix[2] = rp[0] + ((29040*rp[1] -   101*rp[2]) &gt;&gt; 12);
      
      /* it is also a YCbCr -&gt; RGB conversion :
       * pix[0] = rp[0] + 0.049 * rp[1] + 5.598 * rp[2]
       * pix[1] = rp[0] - 1.377 * rp[1] - 2.869 * rp[2] 
       * pix[2] = rp[0] + 7,090 * rp[1] - 0.025 * rp[2]
       * 
       * R = Y + 0.049 Cb' + 5.598 Cr'
       * G = Y - 1.377 Cb' - 2.869 Cr'
       * B = Y + 7.090 Cb' - 0.025 Cr'
       * where roughly Cb'= 0.25Cb and Cr' = 0.25Cr                                     
       */      
    }
    FORC3 rp[c] = CLIP(pix[c] * sraw_mul[c] &gt;&gt; 10);
  }
</pre>
Dave Coffin added :
<pre style="BACKGROUND-COLOR: #e0c0c0">Note that the raw colors in the table are actually
raw colors minus the black level times the corresponding
sRAW coefficient (Note: sraw_mul[]).  That way, when the "raw" colors are all
equal, Cb and Cr should be zero.

     The final matrix comes out as:

    1.000797     0.020063     5.607888
    0.985194    -1.384822    -2.857547
    1.000000     7.101428    -0.009787

     Enjoy!
				Dave Coffin  1/3/2009
</pre>

<p>
We can summary by the fact that:
</p><ul>
<li>sRaw and sRaw2 use a YCbCr 4:2:2 
<a href="http://en.wikipedia.org/wiki/Chroma_subsampling#Sampling_systems_and_ratios">chroma subsampling</a> encoding : 
2 Chroma values on the 1st Row of 4 pixels and 2 Chroma values on the 2nd row of 4 pixels,<br>
</li><li>and sRaw1 use a 4:2:0 encoding : 2 Chroma values on the 1st Row of 4 pixels and 0 Chroma value on the 2nd row of 4 pixels.
</li></ul>
YCbCr may be also written YUV in the litterature.
<p>
</p><h3>3.3. the RAW data</h3>

the Full Raw Jpeg is encoded with 14 bits, in 2 colors (prior to the 50D and the Digic IV), then using 4 colors with the 50D up to 1100D. Since 1D X and up to 6D, Canon is back to 2 components. 
<p>
<table border="1" cellpadding="2">

<tbody><tr style="BACKGROUND-COLOR: #66ff33">
<td valign="top">
<pre>  
(40D RAW)
JPEG_SOF3: length=14
 bits=14, wide=1972, high=2622, nb comp=2
  index=1, h=1, v=1, qt=0
  index=2, h=1, v=1, qt=0
</pre>
</td>
<td valign="top">
<pre>    
(1Ds Mark III RAW)  
JPEG_SOF3: length=14
 bits=14, wide=2856, high=3774, nb comp=2
  index=1, h=1, v=1, qt=0
  index=2, h=1, v=1, qt=0
</pre>
</td>
</tr>  

<tr style="BACKGROUND-COLOR: #66ccff">
<td valign="top">
<pre>  
(50D RAW)  
JPEG_SOF3: length=20
 bits=14, wide=1208, high=3228, nb comp=4
  index=1, h=1, v=1, qt=0
  index=2, h=1, v=1, qt=0
  index=3, h=1, v=1, qt=0
  index=4, h=1, v=1, qt=0
</pre>
</td>
<td valign="top">
<pre>  
(5D Mark II RAW)  
JPEG_SOF3: length=20
 bits=14, wide=1448, high=3804, nb comp=4
  index=1, h=1, v=1, qt=0
  index=2, h=1, v=1, qt=0
  index=3, h=1, v=1, qt=0
  index=4, h=1, v=1, qt=0
</pre>
</td>
</tr>

<tr>

<td valign="top" style="BACKGROUND-COLOR: #ff6633">
<pre>    
(S95 RAW)  
JPEG_SOF3: length=14
 bits=12, high=2784, wide=1872, nb comp=2
  index=1, h=1, v=1, qt=0
  index=2, h=1, v=1, qt=0
</pre>
</td>


<td valign="top" style="BACKGROUND-COLOR: #66ccff">
<pre>    
(1100D)  
JPEG_SOF3: length=20
 bits=14, high=2874, wide=1088, nb comp=4
  index=1, h=1, v=1, qt=0
  index=2, h=1, v=1, qt=0
  index=3, h=1, v=1, qt=0
  index=4, h=1, v=1, qt=0
</pre>
</td>
</tr>  

<tr>

<td valign="top" style="BACKGROUND-COLOR: #66ff33">
<pre>    
(1D X RAW)
JPEG_SOF3: length = 0xe
 bits=14, high=3584, wide=2672, nb comp=2
  index=1, h=1, v=1, qt=0
  index=2, h=1, v=1, qt=0
</pre>
</td>


<td valign="top" style="BACKGROUND-COLOR: #66ff33">
<pre>    
(6D RAW)  
JPEG_SOF3: length = 0xe
 bits=14, high=3708, wide=2784, nb comp=2
  index=1, h=1, v=1, qt=0
  index=2, h=1, v=1, qt=0
</pre>
</td>
</tr>  

</tbody></table>
</p><p>
It can be noticed that <i>jpeg.wide * jpeg.nb_comp = sensor_width</i>. (See section 9.1 for sensor values per Camera models)

</p><h3>3.4 Dual Pixel RAW</h3>
<p>
Starting with 5D Mark IV, the camera can store the sensor data from the 2 half pixels.

</p><pre>anton-reiser  wrote (6 sept 2016):
 Hi,

 just want to share some observations, found within CR2 from the announced Canon EOD 5D iv.

 The BlackLevel BIAS used seems 512 for ISO 100 and 2048 for other ISO.
 But only have some samples seen.

 MakerNote:

 Tag 4001 (ColorBalanceBlock) Version 12, additional 32 entries at the end, otherwise like version 12.

 Tag 402E new, 152 bytes

 Tag 4031 new, 158 bytes, seem used if shoot DualPixel-RAW

 DualPixel-RAW:

 Additional IFD4. Same struct as IFD3, but additional Tag C6DD with 256 bytes (no sensible data seen)

 IFD3 data ADU seem created by simple Addition (A+B) with A and B the different half pixels.
 Proof:
 (IFD4 ADU - BlackLevel) * 2 + BlackLevel show the same histogram distribution.
 A restored by (IFD3 - BlackLevel) - (IFD4 - BlackLevel) + BlackLevel shows nearly the same histogramm.
 The optical horizontal displacement in the background between A and B greater than between IFD3 and IFD4.

 Toni
</pre> 

dumping IFD#3 and IFD#4 values from <a href="http://www.imaging-resource.com/PRODS/canon-5d-iv/E5D4hSLI000100DPRaw_FINE.CR2.HTM">Imaging Resource</a> example: 
<pre>    3 0x00b308   256/0x100     ushort(3)*1           6880/0x1ae0, 6880 (0x1ae0)
    3 0x00b314   257/0x101     ushort(3)*1           4544/0x11c0, 4544 (0x11c0)
    3 0x00b320   259/0x103     ushort(3)*1              6/0x6, 6 (0x0006)
    3 0x00b32c   273/0x111      ulong(4)*1        4276472/0x4140f8, 4276472 (0x004140f8)
    3 0x00b338   279/0x117      ulong(4)*1       34876918/0x2142df6, 34876918 (0x02142df6)
    3 0x00b344 50648/0xc5d8     ulong(4)*1              1/0x1, 1 (0x00000001)
    3 0x00b350 50656/0xc5e0     ulong(4)*1              1/0x1, 1 (0x00000001)
    3 0x00b35c 50752/0xc640    ushort(3)*3          45944/0xb378, 1 3440 3440
    3 0x00b368 50885/0xc6c5     ulong(4)*1              1/0x1, 1 (0x00000001)
</pre>
<pre>    
    4 0x00b380   256/0x100     ushort(3)*1           6880/0x1ae0, 6880 (0x1ae0)
    4 0x00b38c   257/0x101     ushort(3)*1           4544/0x11c0, 4544 (0x11c0)
    4 0x00b398   259/0x103     ushort(3)*1              6/0x6, 6 (0x0006)
    4 0x00b3a4   273/0x111      ulong(4)*1       39153390/0x2556eee, 39153390 (0x02556eee)
    4 0x00b3b0   279/0x117      ulong(4)*1       32200312/0x1eb5678, 32200312 (0x01eb5678)
    4 0x00b3bc 50648/0xc5d8     ulong(4)*1              1/0x1, 1 (0x00000001)
    4 0x00b3c8 50656/0xc5e0     ulong(4)*1              1/0x1, 1 (0x00000001)
    4 0x00b3d4 50752/0xc640    ushort(3)*3          46076/0xb3fc, 1 3440 3440
    4 0x00b3e0 50885/0xc6c5     ulong(4)*1              1/0x1, 1 (0x00000001)
    4 0x00b3ec 50909/0xc6dd    ushort(3)*256        46082/0xb402, 0 0 0 0 0 0 0 0 0 0 ...
</pre>
<pre>$ src/craw2tool.exe -v 1  /g/cr2_samples/5dm4/E5D4hSLI000100DPRaw_FINE.CR2
IFD#4 at 0xb37e
ImageB: stripOffsets=0x2556eee, stripByteCounts=32200312, slices[]=1, 3440, 3440,
SensorInfo: W=6880 H=4544, L/T/R/B=148/54/6867/4533
ImageInfo: W=6720 H=4480
...
cRaw2Unslice, RAW: wide*ncomp (13760) != width (6880) or high (2272) != height (4544)
slice# 0, scol=    0, ecol=  860, jpeg-&gt;rawBuffer[ j ]=0
slice# 1, scol=  860, ecol= 1720, jpeg-&gt;rawBuffer[ j ]=15631360
cRaw2Unslice, RAW: wide*ncomp (13760) != width (6880) or high (2272) != height (4544)
slice# 0, scol=    0, ecol=  860, jpeg-&gt;rawBuffer[ j ]=0
slice# 1, scol=  860, ecol= 1720, jpeg-&gt;rawBuffer[ j ]=15631360

ImageHeight=4480 [54-4533], ImageWidth=6720 [148-6867]. vshift=0
</pre>
<p>


</p><h3>3.5. Jpeg decompression</h3>

See : <a href="https://github.com/lclevy/libcraw2/blob/master/docs/cr2_lossless.pdf?raw=true">Lossless Jpeg compression</a>.



<p>

</p><hr>

<a name="interpol">
<h2>4. Creating RGB picture from the grayscale CFA values</h2>
<h3>4.1 Color Filter Array</h3>
The 450d, like all Canon EOS cameras, and the G9, have a RGGB CFA. Dcraw Filters = 0x94949494 (00x94 = 10 01 01 00, 2/1/1/0, B/G/G/R) 
<pre>RGRGRG
GBGBGB
RGRGRG
GBGBGB
</pre>
<p>
the G10 has a GBRG CFA (0x49494949 in dcraw, 0x49 = 01 00 10 01, 1/0/2/1, G/R/B/G ).
</p><p>
</p><pre>GBGBGB
RGRGRG
GBGBGB
RGRGRG
</pre>
<p>
So for EOS models, the output of the jpeg lossless decompression is (here with 2 components, before the 50D):<br>
<br>

<table style="WIDTH: 190px; HEIGHT: 190px; TEXT-ALIGN: left" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td height="30">c1</td>
<td height="30">c2</td>
<td height="30">c1</td>
<td height="30">c2</td>
<td height="30">c1</td>
<td height="30">c2</td>
</tr>
<tr>
<td align="undefined" valign="undefined">c1</td>
<td align="undefined" valign="undefined">c2</td>
<td align="undefined" valign="undefined">c1</td>
<td align="undefined" valign="undefined">c2</td>
<td align="undefined" valign="undefined">c1</td>
<td align="undefined" valign="undefined">c2</td>
</tr>
<tr>
<td align="undefined" valign="undefined">c1</td>
<td align="undefined" valign="undefined">c2</td>
<td align="undefined" valign="undefined">c1</td>
<td align="undefined" valign="undefined">c2</td>
<td align="undefined" valign="undefined">c1</td>
<td align="undefined" valign="undefined">c2</td>
</tr>
<tr>
<td align="undefined" valign="undefined">c1</td>
<td align="undefined" valign="undefined">c2</td>
<td align="undefined" valign="undefined">c1</td>
<td align="undefined" valign="undefined">c2</td>
<td align="undefined" valign="undefined">c1</td>
<td align="undefined" valign="undefined">c2</td>
</tr>
<tr>
<td align="undefined" valign="undefined">c1</td>
<td align="undefined" valign="undefined">c2</td>
<td align="undefined" valign="undefined">c1</td>
<td align="undefined" valign="undefined">c2</td>
<td align="undefined" valign="undefined">c1</td>
<td align="undefined" valign="undefined">c2</td>
</tr>
<tr>
<td align="undefined" valign="undefined">c1</td>
<td align="undefined" valign="undefined">c2</td>
<td align="undefined" valign="undefined">c1</td>
<td align="undefined" valign="undefined">c2</td>
<td>c1</td>
<td align="undefined" valign="undefined">c2</td>
</tr>
</tbody>
</table>

<br>
must be interpreted this way:<br>
<br>
<table style="WIDTH: 190px; HEIGHT: 190px; TEXT-ALIGN: left" border="0" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="BACKGROUND-COLOR: red">R</td>
<td style="BACKGROUND-COLOR: lime">G1</td>
<td style="BACKGROUND-COLOR: red">R</td>
<td style="BACKGROUND-COLOR: lime">G1</td>
<td style="BACKGROUND-COLOR: red">R</td>
<td style="BACKGROUND-COLOR: lime">G1</td>
</tr>
<tr>
<td style="BACKGROUND-COLOR: lime">G2</td>
<td style="BACKGROUND-COLOR: blue">B</td>
<td style="BACKGROUND-COLOR: lime">G2</td>
<td style="BACKGROUND-COLOR: blue">B</td>
<td style="BACKGROUND-COLOR: lime">G2</td>
<td style="BACKGROUND-COLOR: blue">B</td>
</tr>
<tr>
<td style="BACKGROUND-COLOR: red">R</td>
<td style="BACKGROUND-COLOR: lime">G1</td>
<td style="BACKGROUND-COLOR: red">R</td>
<td style="BACKGROUND-COLOR: lime">G1</td>
<td style="BACKGROUND-COLOR: red">R</td>
<td style="BACKGROUND-COLOR: lime">G1</td>
</tr>
<tr>
<td style="BACKGROUND-COLOR: lime">G2</td>
<td style="BACKGROUND-COLOR: blue">B</td>
<td style="BACKGROUND-COLOR: lime">G2</td>
<td style="BACKGROUND-COLOR: blue">B</td>
<td style="BACKGROUND-COLOR: lime">G2</td>
<td style="BACKGROUND-COLOR: blue">B</td>
</tr>
<tr>
<td style="BACKGROUND-COLOR: red">R</td>
<td style="BACKGROUND-COLOR: lime">G1</td>
<td style="BACKGROUND-COLOR: red">R</td>
<td style="BACKGROUND-COLOR: lime">G1</td>
<td style="BACKGROUND-COLOR: red">R</td>
<td style="BACKGROUND-COLOR: lime">G1</td>
</tr>
<tr>
<td style="BACKGROUND-COLOR: lime">G2</td>
<td style="BACKGROUND-COLOR: blue">B</td>
<td style="BACKGROUND-COLOR: lime">G2</td>
<td style="BACKGROUND-COLOR: blue">B</td>
<td style="BACKGROUND-COLOR: lime">G2</td>
<td style="BACKGROUND-COLOR: blue">B</td>
</tr>
</tbody>
</table>
<br>
let's separate it into 3 RGB components:<br>
<br>

<table>
<tbody><tr>
<td>

<table style="WIDTH: 190px; HEIGHT: 190px; TEXT-ALIGN: left" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>

<td style="BACKGROUND-COLOR: red" height="30" width="30">R</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br> </td>
<td style="BACKGROUND-COLOR: red" height="30" width="30">R</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br> </td>
<td style="BACKGROUND-COLOR: red" height="30" width="30">R</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br> </td>
</tr>
<tr>
<td style="BACKGROUND-COLOR: white" height="30"><br></td>
<td style="BACKGROUND-COLOR: white"><br></td>
<td style="BACKGROUND-COLOR: white"><br></td>
<td style="BACKGROUND-COLOR: white"><br></td>
<td style="BACKGROUND-COLOR: white"><br></td>
<td style="BACKGROUND-COLOR: white"><br></td>

</tr>
<tr>
<td style="BACKGROUND-COLOR: red" height="30" width="30">R</td>
<td style="BACKGROUND-COLOR: white" height="30"><br></td>
<td style="BACKGROUND-COLOR: red" height="30">R</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: red" height="30" width="30">R</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
</tr>
<tr>
<td height="30" width="30"><br></td>
<td height="30"><br></td>
<td height="30"><br></td>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
</tr>
<tr>
<td style="BACKGROUND-COLOR: red" height="30" width="30">R</td>
<td style="BACKGROUND-COLOR: white" height="30"><br></td>
<td style="BACKGROUND-COLOR: red" height="30">R</td>
<td style="BACKGROUND-COLOR: white" height="30"><br></td>
<td style="BACKGROUND-COLOR: red" height="30">R</td>
<td style="BACKGROUND-COLOR: white" height="30"><br></td>
</tr>
<tr>
<td height="30" width="30"><br></td>
<td height="30"><br></td>
<td height="30"><br></td>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
</tr>
</tbody></table>

</td>

<td>

<table style="WIDTH: 190px; HEIGHT: 190px; TEXT-ALIGN: left" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br> </td>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G1</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G1</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G1</td>
</tr>
<tr>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G2</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G2</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G2</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
</tr>
<tr>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br> </td>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G1</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G1</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G1</td>
</tr>
<tr>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G2</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G2</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G2</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
</tr>
<tr>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br> </td>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G1</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G1</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G1</td>
</tr>
<tr>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G2</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G2</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: lime" height="30" width="30">G2</td>
<td style="BACKGROUND-COLOR: white" height="30" width="30"><br></td>
</tr>
</tbody>
</table>

</td>

<td>


<table style="WIDTH: 190px; HEIGHT: 190px; TEXT-ALIGN: left" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
</tr>
<tr>
<td height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: blue" height="30" width="30">B</td>
<td height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: blue" height="30" width="30">B</td>
<td height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: blue" height="30" width="30">B</td>
</tr>
<tr>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
</tr>
<tr>
<td height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: blue" height="30" width="30">B</td>
<td height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: blue" height="30" width="30">B</td>
<td height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: blue" height="30" width="30">B</td>
</tr>
<tr>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
<td height="30" width="30"><br></td>
</tr>
<tr>
<td height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: blue" height="30" width="30">B</td>
<td height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: blue" height="30" width="30">B</td>
<td height="30" width="30"><br></td>
<td style="BACKGROUND-COLOR: blue" height="30" width="30">B</td>
</tr>
</tbody>
</table>

</td>
</tr></tbody></table>

</p><p>

A Bayer CFA sensor only captures 1/3 of the color information : 
</p><ul>
<li>only the Red information for pixel (0,0) (top, left)
</li><li>only the Green information for pixel (0,1) and pixel (1,0)
</li><li>only Blue information for pixel (1,1)
</li></ul>
the missing color information must be obtained by interpolating the color values of neighbor pixels. <br>
For example the Red value of pixel (1,1) can be calculated by averaging the Red value of pixels (0,0), (0,2), (2,0) and (2,2).
</a><p><a name="interpol">
See </a><a href="http://www.site.uottawa.ca/%7Eedubois/courses/CEG4311/slides/InterpolationRGBcomponents.ppt">Interpolation
of RGB components in Bayer CFA images</a>, by Eric Dubois, for more details.
</p><p>
</p><h3>4.2 Bayer Interpolation</h3>
<a href="http://www.csee.wvu.edu/~xinl/papers/demosaicing_survey.pdf">Image Demosaicing: A Systematic Survey</a> is reviewing 
the 11 best demosaicing algorithms.
<p>This <a href="http://www.csie.ntu.edu.tw/%7Ecyy/courses/vfx/05spring/lectures/handouts/lec02_camera.ppt">presentation</a>
(slides 30-40) compares different interpolation techniques.
</p>
<p><a href="http://www.accidentalmark.com/research/papers/Hirakawa03MNdemosaicICIP.pdf">This
paper</a> explains the Adaptative Homogeneity-Directed algorithm
(AHD) by Keigo Hirakawa and Thomas W. Parks. This algorithm is also by
Dcraw when choosing the better interpolation quality. </p>
<p>
<a href="http://sites.google.com/site/demosaicalgorithms/modified-dcraw">Paul Lee</a> is proposing a modified dcraw version 
with improved demosaicing algorithms.
</p><p>

</p><hr>
<p>
<a name="wb">
</a></p><h2><a name="wb">5. White Balance correction, Black substraction and Color scaling</a></h2><a name="wb">

<h3>5.1 White balance values in the CR2 file</h3>
</a><p><a name="wb">
The White Balance is a color ratio correction between the R, G and B
values. In </a><a href="http://www.guillermoluijk.com/tutorial/dcraw/index_en.htm">this document</a> it is explained that it is advised 
to apply white balance correction before demosaicing to avoid artifacts. 
</p><p>
In IFD#0, in the Makernote part, depending of the camera model, RGGB multipliers (4 shorts) are stored in differents offsets, 63 (in shorts) for the 450D.  
These values can be used to apply the WhiteBalance correction.
</p><p>
</p><pre>from dcraw.c v8.89, parse_makernote(). Copyright Dave Coffin:
(I have added comments.)

    /* the White Balance multipliers are taken from the 0x4001 tag of the Makernote section */
    if (tag == 0x4001 &amp;&amp; len &gt; 500) {
      i = len == 582 ? 50 : len == 653 ? 68 : len == 5120 ? 142 : 126;
      /* 582 is the length of the 0x4001 tag for 20D and 350D. skip length is 50 bytes. 
       *  (See Phil Harvey's "ColorBalance1" WB_RGGBLevelsAsShot tag at short offset 25)
       * 653 is the length for 1D Mark II and 1Ds Mark II. skip length is 68 bytes. 
       *  (See "ColorBalance2" WB_RGGBLevelsAsShot tag of Phil Harvey, short offset is 34.)
       * 5120 is the size for the Canon G10. skip offset is 142 bytes, 71 shorts.
       * default skip value is 126 bytes, 63 shorts. See "ColorBalance3" and "ColorBalance4" WB_RGGBLevelsAsShot tags             
       */  
      fseek (ifp, i, SEEK_CUR);
get2_rggb:
      FORC4 cam_mul[c ^ (c &gt;&gt; 1)] = get2();
      /* read 4 shorts (White Balance RGGB multipliers) from the Makernote part, at offset i 
       * and store them in cam_mul[0], cam_mul[1], cam_mul[3], cam_mul[2],
       * because Canon multipliers order is RGGB and DCraw internal ones are RGBG (2 and 3 are swapped).       
       */
      fseek (ifp, 22, SEEK_CUR);
      /* skip 22 bytes, and read 4 shorts, for the sraw image */
      FORC4 sraw_mul[c ^ (c &gt;&gt; 1)] = get2();
    }
</pre>
<p>
</p><h3>5.2 Black substraction</h3>
<p>
Even if encoded using 14bits, the "real black" may not be recorded as RGB = ( 0, 0, 0) and the white as ( 16384, 16384, 16384 ), 
because of the sensor physical characteristics (2^14 == 16384). For example for the 5D Mark II, the black level is ( 1023, 1023, 1023 ) 
and the white level ( 15600, 15600, 15600 ). 
</p><p>

Below is an extract of emails exchanges between Doug Kerr and Dave Coffin about how black level is computed for Canon CR2 pictures:

</p><pre style="BACKGROUND-COLOR: #e0c0c0">From: dcoffin@cybercom.net
Hi Doug,

     The best measurement of the black level is the frame
of masked pixels bordering the image at left and right.
Older versions of dcraw averaged them into a single black
value, while the latest code calculates four black values
according to their positions in the 2x2 Bayer array.
[...]
There is no one right way.  Look for statistical
patterns in the masked pixels, shoot a few dark frames,
and decide which noise model fits them best.

                                   Dave Coffin  8/17/2010
---
I ignore the first two columns of masked pixels on
either side of the image, because they sometimes have a
bright stripe.

     The assumed filter pattern for the masked pixels is
the same as for image pixels.  In fact, there are no
filters here, but a few Canon images have an even column/
odd column skew in the black level, and a 2x2 black block
surpresses this nicely.
                                   Dave Coffin  8/18/2010

</pre>
Following is a attempt to follow inside Dcraw code how it is computed in lossless_jpeg_load_raw() and applied in scale_colors().


<pre style="BACKGROUND-COLOR: #c0c0c0">
  unsigned black, cblack[8];
  memset (cblack, 0, sizeof cblack);

void CLASS adobe_coeff (const char *make, const char *model)
{
  static const struct {
    const char *prefix;
    short black, maximum, trans[12];
...
    { "Canon EOS 550D", 0, 0x3dd7,    // black is 0
	{ 6941,-1164,-857,-3825,11597,2534,-416,1540,6039 } },
}


void CLASS lossless_jpeg_load_raw()
{
      ...
  for (jrow=0; jrow &lt; jh.high; jrow++) {
    rp = ljpeg_row (jrow, &amp;jh);
    for (jcol=0; jcol &lt; jwide; jcol++) {
      val = *rp++;
      ...
      if ((unsigned) (row-top_margin) &lt; height) {
	      c = FC(row-top_margin,col-left_margin);
	      if ((unsigned) (col-left_margin) &lt; width) {
	        BAYER(row-top_margin,col-left_margin) = val;
	        if (min &gt; val) min = val;
	    } else if (col &gt; 1 &amp;&amp; (unsigned) (col-left_margin+2) &gt; width+3) // end of the row
	        cblack[c] += (cblack[4+c]++,val);
  ...
    } // end of for (jcol 
  } // end of for (jrow
  ljpeg_end (&amp;jh);
  FORC4 if (cblack[4+c]) cblack[c] /= cblack[4+c];
  ...
}


void CLASS scale_colors()
{
...
  FORC4 cblack[c] += black;
...
  size = iheight*iwidth;
  for (i=0; i &lt; size*4; i++) {
    val = image[0][i];
    if (!val) continue;
    val -= cblack[i &amp; 3];      // black substraction, depending on color (R,G1,G2,B)
    val *= scale_mul[i &amp; 3];   // scaling
    image[0][i] = CLIP(val);
  }
...
}
</pre>

<h3>5.3 Color Scaling</h3>
<p>
</p><hr>
<p>
<a name="color">
</a></p><h2><a name="color">6. Color space conversions and Gamma correction</a></h2><a name="color">
</a><p><a name="color">
Cameras are using an RGB color space (</a><a href="http://en.wikipedia.org/wiki/SRGB_color_space">sRGB</a> 
or <a href="http://en.wikipedia.org/wiki/Adobe_RGB_color_space">Adobe1998</a>), the standard display color space is sRGB 
and the standard "pivot" color space is the <a href="http://en.wikipedia.org/wiki/CIE_1931_color_space">CIE XYZ</a> system, 
thus conversions to and from the XYZ color model are required.
</p><p>
</p><h3>6.1 RGB to XYZ color space conversion</h3>
<p>
The image produced by cameras are using the RGB color model and they are calibrated using this same model. 
Here "calibrated" means how the Red, Green and Blue components are recorded. </p><p>
Canon RAW pictures can be produced using either the sRGB or the Adode_RGB_1998 color spaces, which have the same 
white reference, named <a href="http://en.wikipedia.org/wiki/D65">D65</a> and defined in the XYZ color model.

</p><p>
</p><h4>6.1.1 Camera specific values: the cam_xyz matrix </h4>
<p>
A camera specific 3x3 matrix is first needed, as well as the black/minimum value and the white/maximum value.
</p><p>
In Dcraw, the function <i>adobe_coeff()</i> is filling this <b>cam_xyz</b> matrix. 
</p><p>
</p><pre style="BACKGROUND-COLOR: #c0c0c0">/*
   Thanks to Adobe for providing these excellent CAM -&gt; XYZ matrices!
 */
void CLASS adobe_coeff (char *make, char *model)
...
  static const struct {
    const char *prefix;
    short black, maximum, trans[12];
  } table[] = {
...
    { "Canon EOS 5D Mark II", 0, 0x3cf0,
	{ 4716,603,-830,-7798,15474,2480,-1496,1937,6651 } },
    { "Canon EOS 450D", 0, 0x390d,
	{ 5784,-262,-821,-7539,15064,2672,-1982,2681,7427 } },
...
  for (j=0; j &lt; 12; j++)
	  cam_xyz[0][j] = table[i].trans[j] / 10000.0;
...
}
</pre>
When divided by 10000, the trans[] values are stored in <b>cam_xyz</b>:
<pre>/*  5D Mark II : black=0, max=15600
 *  [  0.4716 0.0603 -0.0830 ]
 *  [ -0.7798 1.5474  0.248  ]
 *  [ -0.1496 0.1937  0.6651 ] 
 *   
 *  450D : black=0, max=14605
 *  [  0.5784 0.0262 -0.0821 ]
 *  [ -0.7539 1.5064  0.2672 ]
 *  [ -0.1982 0.2681  0.7427 ]
 */
</pre>
The values are coming from tags in DNG images procuded by DNG converter from CR2 files. 
See <a href="http://www.adobe.com/products/dng/pdfs/dng_spec.pdf">DNG specification</a>.<p>

<table border="1" cellpadding="2" cellspacing="2">
<tbody><tr>
<th>DNG Tag name<br>and hexa value</th><th width="600">description</th><th>length</th><th>type</th><th>example</th>
</tr>

<tr>
<td>ColorMatrix2 (0xC622)</td><td>ColorMatrix2 defines a transformation matrix that converts XYZ values to reference camera native color space values, 
under the second calibration illuminant. The matrix values are stored in row scan order.</td>
<td>9</td><td>10=srational</td><td>for the 5d MarkII<br>[  0.4716, 0.0603, -0.0830 ]<br>[ -0.7798, 1.5474, 0.248  ]<br>[ -0.1496, 0.1937, 0.6651 ]
</td>
</tr>

<tr>
<td>BlackLevel (0xC61A)</td><td>This tag specifies the zero light (a.k.a. thermal black or black current) encoding level, 
as a repeating pattern. The origin of this pattern is the top-left corner of the ActiveArea rectangle. 
The values are stored in row-column-sample scan order.</td>
<td>3</td><td>5=rational</td><td>for the 5d MarkII,<br>[ 0, 0, 0 ] for sRaw, <br>[ 1023, 1023, 1023 ] for full RAW.
</td>
</tr>

<tr>
<td>WhiteLevel (0xC61D)</td><td>This tag specifies the fully saturated encoding level for the raw sample values. 
Saturation is caused either by the sensor itself becoming highly non-linear in response, 
or by the camera's analog to digital converter clipping.</td>
<td>3</td><td>3=short</td><td>for the 5d MarkII<br>[ 15600, 15600, 15600 ]
</td>
</tr>

</tbody></table>
</p><p>
For information, the DNG processing is using these other tags:
</p><p>
<table border="1" cellpadding="2" cellspacing="2">
<tbody><tr>
<th>DNG Tag name<br>and hexa value</th><th width="600">description</th><th>length</th><th>type</th><th>example</th>
</tr>
<tr>
<td>CalibrationIlluminant2 (0xC65B)</td><td width="600">The illuminant used for an optional second set of color calibration tags. 
The legal values for this tag are the same as the legal values for the CalibrationIlluminant1 tag; 
however, if both are included, neither is allowed to have a value of 0 (unknown).</td>
<td>1</td><td>3=short</td><td>for the 5d MarkII<br>21 = D65 white
</td>
</tr>
<tr>
<td>CameraCalibration2 (0xC624)</td><td width="600">CameraCalibration2 defines a calibration matrix that transforms reference camera 
native space values to individual camera native space values under the second calibration illuminant. The matrix is stored in row scan order.
This matrix is stored separately from the matrix specified by the ColorMatrix2 tag to allow raw converters to swap in replacement 
color matrices based on UniqueCameraModel tag, while still taking advantage of any per-individual camera calibration performed 
by the camera manufacturer.</td>
<td>9</td><td>10=srational</td><td>for the 5d MarkII<br>[ 0.983, 0, 0 ]<br>[ 0, 1, 0 ]<br>[ 0, 0, 0.9907 ]
</td>
</tr>
<tr>
<td>AnalogBalance (0xC627)</td><td width="600">Normally the stored raw values are not white balanced, since any digital white balancing 
will reduce the dynamic range of the final image if the user decides to later adjust the white balance; however, 
if camera hardware is capable of white balancing the color channels before the signal is digitized, it can improve the dynamic range 
of the final image.
AnalogBalance defines the gain, either analog (recommended) or digital (not recommended) that has been applied the stored raw values.</td>
<td>3</td><td>5=rational</td><td>example: [ 1.833333, 1, 2.341856 ] for sRaw,<br>[ 1, 1, 1 ] for full Raw.
</td>
</tr>
<tr>
<td>AsShotNeutral (0xC628)</td><td width="600">AsShotNeutral specifies the selected white balance at time of capture, 
encoded as the coordinates of a perfectly neutral color in linear reference space values. 
The inclusion of this tag precludes the inclusion of the AsShotWhiteXY tag.</td>
<td>3</td><td>5=rational</td><td>example: [ 1, 1, 1 ] for sRaw,<br>[ 0.549928, 1, 0.407871 ] for full Raw.
</td>
</tr>
</tbody></table>
</p><p>
</p><h4>6.1.2 sRGB: the constant xyz_rgb matrix and D65 definitions</h4>

<p>

the <b>xyz_rgb</b> matrix is defined in the sRGB standard definition. See International Color Consortium (ICC), 
<a href="http://www.color.org/sRGB.xalter">A Standard Default Color Space for the Internet: sRGB</a>, equation 1.8.
</p><p>
and of course in Dcraw:
</p><pre style="BACKGROUND-COLOR: #c0c0c0">// in Dcraw, around line 130:
const double xyz_rgb[3][3] = {			/* XYZ from RGB */
  { 0.412453, 0.357580, 0.180423 },
  { 0.212671, 0.715160, 0.072169 },
  { 0.019334, 0.119193, 0.950227 } };
</pre>
The sRGB color space definition is also using the D65 white point.
<p>
See <a href="http://www.brucelindbloom.com/index.html?Eqn_ChromAdapt.html">Some Common Chromatic Adaptation Matrices</a> (by Bruce Lindbloom), 
in D65 line to find the same values as in Dcraw.<br>
In the <a href="http://www.adobe.com/products/dng/pdfs/dng_spec.pdf">DNG specification</a>, as listed above, 
the usage of the D65 white point is explicited with the <i>CalibrationIlluminant2</i> tag, with the value 21 (decimal).
</p><pre style="BACKGROUND-COLOR: #c0c0c0">in Dcraw, after the xyz_rgb definition:

const float d65_white[3] = { 0.950456, 1, 1.088754 };
</pre>
the D65 values are used in Dcraw only with:
<ul>
<li><i>ahd_interpolate()</i>,
</li><li>and when reading DNG files as input, for the AsShotWhiteXY tag (0xC629/50729), in <i>parse_tiff_ifd()</i>.  
</li></ul>
<p>
</p><h4>6.1.3 Camera color space to CIE XYZ conversion</h4>
In Dcraw, the processing is:
<ol>
<li><b>cam_xyz[3][3]</b> initialisation, in <i>adobe_coeff()</i>
</li><li>in <i>cam_xyz_coeff()</i>
  <ol>
  <li><b>cam_rgb[3][3]</b> = <b>cam_xyz[3][3]</b> * <b>xyz_rgb[3][3]</b>
  </li><li>normalization of <b>cam_rgb[3][3]</b>
  </li><li><b>rgb_cam[3][3]</b> = pseudoinverse(<b>cam_rgb[3][3]</b>)
  </li></ol>

</li></ol>
rgb_cam[][] is used in <i>ahd_interpolate()</i> and <i>convert_to_rgb()</i>.
<p>
The <a href="http://www.adobe.com/products/dng/pdfs/dng_spec.pdf">DNG specification</a> v1.2 is describing 
a similar processing in Section 6: "Mapping Camera Color Space to CIE XYZ Space", page 62.
</p><p>

</p><p>

</p><h3>6.2 XYZ to RGB conversion</h3>
<p>
The convert_to_RGB() function in Dcraw is creating an <a href="http://www.color.org/index.xalter">ICC</a> color profile.<br>
The image/color data in Dcraw are in the XYZ color space with the D65 white point as reference. 
The <a href="http://www.color.org/icc_specs2.xalter">ICC profile standard</a> requires a D50 white point as reference
and Dcraw output files are created using the RGB color space, the most common one.
</p><p>
The following Dcraw code computes the ICC tags rXYZ, gXYZ and bXYZ 
(see <a href="http://www.color.org/ICC_Minor_Revision_for_Web.pdf">ICC profile format</a>, section 6.4) 
which is a 3x3 matrix. See the column "Stored in ICC profile" in the table below.<br>
The exact matrix stored in the profile is 0x10000 * <b>xyzd50_srgb[][]</b> * inverse ( <b>out_rgb[][]</b> ). <br>
<b>Out_rgb[][]</b> is filled either with <b>rgb_rgb[][]</b> (sRGB), <b>adobe_rgb[][]</b>, 
<b>wide_rgb[][]</b>, <b>prophoto_rgb[][]</b> or <b>xyz_rgb[][]</b> (See column#2, Dcraw matrix in the table). <br>
Each value is stored in the profile as a 16bits fixed float (1.0 is 0x10000) intead of a C double.
</p><p>
</p><pre style="BACKGROUND-COLOR: #c0c0c0">  static const double (*out_rgb[])[3] =
  { rgb_rgb, adobe_rgb, wide_rgb, prophoto_rgb, xyz_rgb };
  static const char *name[] =
  { "sRGB", "Adobe RGB (1998)", "WideGamut D65", "ProPhoto D65", "XYZ" };
...
    pseudoinverse ((double (*)[3]) out_rgb[output_color-1], inverse, 3);
    // out_rgb is either rgb_rgb (sRGB), adobe_rgb, wide_rgb, prophoto_rgb or xyz_rgb 
    for (i=0; i &lt; 3; i++)
      for (j=0; j &lt; 3; j++) {
	      for (num = k=0; k &lt; 3; k++)
	        num += xyzd50_srgb[i][k] * inverse[j][k];
        oprof[pbody[j*3+23]/4+i+2] = num * 0x10000 + 0.5;
        // fills the rXYZ, gXYZ and bXYZ lines of the 3x3 matrix depending of the output color space
      }
</pre>

<p>
In the following table are compared the original matrix (from Bruce Lindbloom site) and the D50 chromatic adapted matrix using the Bradford method. <br>
when required, the white points values used are: D65 (source) = { 0.950470, 1.000000, 1.088830}, D50 (destination) = { 0.964220, 1.000000, 0.825210 }.
</p><p>
<a href="http://www.brucelindbloom.com/index.html?Eqn_ChromAdapt.html">The chromatic adaption method</a> is described on Bruce's site.
</p><p>
<table border="1" cellpadding="2" cellspacing="2">
<tbody><tr><th>Color spaces<br>(original white point)</th><th>dcraw matrix<br>( out_rgb[] )</th><th>Original matrix<br>(Bruce Lindbloom)</th>
<th>Stored in ICC profile<br>=xyzd50_srgb * inv( out_rgb )</th><th>Adapted matrix</th></tr>

<tr><td>sRGB (D65)</td>
<td>
<pre>   rgb_rgb[3][3] =
  { { 1,0,0 }, 
    { 0,1,0 }, 
    { 0,0,1 } };
</pre>
</td>

<td>
<pre>Bruce Lindbloom:
 0.412424 0.212656  0.0193324  
 0.357579 0.715158  0.119193   
 0.180464 0.0721856 0.950444
</pre>
<pre>Dcraw :  xyz_rgb[3][3] = {			
 { 0.412453, 0.357580, 0.180423 },
 { 0.212671, 0.715160, 0.072169 },
 { 0.019334, 0.119193, 0.950227 } };
</pre>
</td>
<td>
<pre>rXYZ
gXYZ
bXYZ
==
0.43608 0.22250 0.01393
0.38509 0.71689 0.09709
0.14305 0.06061 0.71402
</pre>
<a href="http://lclevy.free.fr/cr2/srgbd50_xyz2.txt">Details</a>
</td>
<td>
<pre>Dcraw :  xyzd50_srgb[3][3] = {
 { 0.436083, 0.385083, 0.143055 },
 { 0.222507, 0.716888, 0.060608 },
 { 0.013930, 0.097097, 0.714022 } };
</pre>
Computed, <a href="http://lclevy.free.fr/cr2/srgbd50_xyz.txt">d65-&gt;d50 Chromatic Adaptation</a>:<pre> 0.436071 0.222488 0.013931
 0.385068 0.716884 0.097105
 0.143102 0.060626 0.714279
</pre>
</td>
</tr>

<tr><td>Adobe RGB 1998<br> (D65)</td>
<td>
<pre> double adobe_rgb[3][3] = {
 { 0.715146, 0.284856, 0.000000 },
 { 0.000000, 1.000000, 0.000000 },
 { 0.000000, 0.041166, 0.958839 } };
</pre>
<a href="http://lclevy.free.fr/cr2/adobe2.txt">Details</a>
</td>
<td>
<pre> 0.576700 0.297361  0.0270328  
 0.185556 0.627355  0.0706879  
 0.188212 0.0752847 0.991248
 </pre>
</td>
<td>
<pre>0.60979 0.31114 0.01949
0.20525 0.62566 0.06090
0.14920 0.06322 0.74467
</pre>
</td>
<td>
Computed, <a href="http://lclevy.free.fr/cr2/adobe.txt">d65-&gt;d50 Chromatic Adaptation</a>:<pre> 0.609723 0.311107 0.019480
 0.205243 0.625662 0.060891
 0.149246 0.063228 0.744944
</pre>
</td>
</tr>



<tr><td>Wide RGB (D50)</td>
<td>
<pre> wide_rgb[3][3] = {
 { 0.593087, 0.404710, 0.002206 },
 { 0.095413, 0.843149, 0.061439 },
 { 0.011621, 0.069091, 0.919288 } };
</pre>
</td>
<td>
<pre> 0.716105 0.258187  0.000000   
 0.100930 0.724938  0.0517813  
 0.147186 0.0168748 0.773429
 </pre>
</td>
<td>
<pre>0.71616 0.25821 0.00000
0.10091 0.72493 0.05179
0.14716 0.01686 0.77325
</pre>
</td>
<td>
<a href="http://lclevy.free.fr/cr2/pro_wide.txt">Details</a>
<pre> 0.593069 0.095412 0.011624
 0.404687 0.843152 0.069102
 0.002201 0.061443 0.919408
</pre>
</td>
</tr>

<tr><td>ProPhoto (D50)</td>
<td>
<pre> prophoto_rgb[3][3] =  {
 { 0.529317, 0.330092, 0.140588 },
 { 0.098368, 0.873465, 0.028169 },
 { 0.016879, 0.117663, 0.865457 } };
</pre>
</td>
<td>
<pre> 0.797675  0.288040 0.000000   
 0.135192  0.711874 0.000000   
 0.0313534 0.000086 0.825210
 </pre>
</td>
<td>
<pre>0.79774 0.28807 0.00000
0.13518 0.71187 0.00003
0.03131 0.00006 0.82503
</pre>
</td>
<td>
<a href="http://lclevy.free.fr/cr2/pro_wide.txt">Details</a>
<pre> 0.529304 0.098366 0.016882
 0.330076 0.873468 0.117673
 0.140602 0.028168 0.865572
</pre>
</td>
</tr>

<tr><td>XYZ</td>
<td>
<pre> xyz_rgb[3][3] = {			
 { 0.412453, 0.357580, 0.180423 },
 { 0.212671, 0.715160, 0.072169 },
 { 0.019334, 0.119193, 0.950227 } };
</pre>
</td>

<td>
<pre>
 </pre>
</td>

<td>
<pre>1.04784 0.02956 -0.00922
0.02290 0.99048 0.01505
-0.05013 -0.01704 0.75203
(This is the sRGB D65-&gt;D50 
Chromatic Adaption matrix)
See <a href="http://www.brucelindbloom.com/index.html?Eqn_ChromAdapt.html">here</a>.
</pre>
</td>

<td>
xyz_rgb[] is the matrix to convert RGB to XYZ, starting from sRGB (d65).
</td>

</tr>

</tbody></table>
</p><p>
The following code is converting back image data from the XYZ spave into the RGB space. 
First <b>out_cam[][]</b> is computed, then applied to image data.
</p><p>
</p><pre style="BACKGROUND-COLOR: #c0c0c0">  float out[3], out_cam[3][4];
...
  for (i=0; i &lt; 3; i++)
    for (j=0; j &lt; colors; j++)
      for (out_cam[i][j] = k=0; k &lt; 3; k++)
	      out_cam[i][j] += out_rgb[output_color-1][i][k] * rgb_cam[k][j];
        // matrix multiplication : out_cam[3][3] = out_rgb[3][3] * rgb_cam[3][3]
...
  for (img=image[0], row=0; row &lt; height; row++)
    for (col=0; col &lt; width; col++, img+=4) {
      if (!raw_color) {
	      out[0] = out[1] = out[2] = 0;
	      FORCC {
	        // convert pixels data back to RGB
	        out[0] += out_cam[0][c] * img[c];
	        out[1] += out_cam[1][c] * img[c];
	        out[2] += out_cam[2][c] * img[c];
	      }
	      FORC3 img[c] = CLIP((int) out[c]);
      }
</pre>

<p>
</p><h3>6.3 Gamma correction for 16bits-&gt;8bits conversion</h3>

the <a href="http://www.color.org/sRGB.xalter">sRGB standard</a> document is defining the sRGB gamma tranfer function: See equations 1.2a and 1.2b.
<p>
</p><pre>if ( r &lt; 0.00304 ) 
  r = r*12.92
else 
  r = ( 1.055 * r^(1.0/2.4) ) - 0.055
  // ^ means "at exponent"
</pre>

<pre style="BACKGROUND-COLOR: #c0c0c0">in Dcraw v8.91, in gamma_lut() 

#ifdef SRGB_GAMMA
  // sRGB gamma transfer function
  //  http://www.w3.org/Graphics/Color/sRGB , Part 2: Definition of the sRGB Color Space, Colorimetric definitions and digital encodings
  //  http://www.color.org/sRGB.xalter , equations 1.2a and 1.2b.
  //  See IEC 61966-2-1 : sRGB default RGB colour space
  
	r &lt;= 0.00304 ? r*12.92 : pow(r,2.5/6)*1.055-0.055 );
	
	// 1.0/2.4 in the spec instead of 2.5/6 = 0.417
#else
  // Rec 709 transfer function : Recommendation ITU-R BT.709, Basic Parameter Values for the HDTV
  //  Standard for the Studio and for International Programme Exchange (1990) [formerly CCIR Rec. 709]. (Geneva: ITU, 1990)
  
	r &lt;= 0.018 ? r*4.5 : pow(r,0.45)*1.099-0.099 );
	
	// 0.45 is (1.0/2.2) : a 2.2 gamma
#endif
</pre>
In Dcraw v8.92, the gamma value can be chosen by the user, with the -g command line option.<br>
But the code is more difficult to read
<pre style="BACKGROUND-COLOR: #c0c0c0">// default gamma value is 1/0.45 = 2.2
double  gamm[5]={ 0.45,4.5,0,0,0 }; 
// gamm[0] stores 0.45 for 1/0.45 = 2.2, the defaut gamma value (RGB). 
// gamm[1] stores "r factor", the slope of the linear part of the curve (4.5 for RGB, 12.92 for sRGB)
// gamm[2] stores the "condition value": 0.00304 for srgb, 0.018 for rgb
// gamm[3] stores 0.055 (srgb) or 0.099 (RGB)
...
      // gamma value given by the user
    puts(_("-g <p ts=""> Set custom gamma curve (default = 2.222 4.5)"));
...
      case 'g':  gamm[0] = 1 / atof(argv[arg++]);
                 gamm[1] =     atof(argv[arg++]);  break;
</p></pre>
<p>
</p><pre style="BACKGROUND-COLOR: #c0c0c0">in convert_to_rgb()
...
  double bnd[2]={0,0};
  // interval to look for the solution using dichotomy
...
  bnd[gamm[1] &gt;= 1] = 1;
  if (gamm[1] &amp;&amp; (gamm[1]-1)*(gamm[0]-1) &lt;= 0) {
    // using dichotomy, finds the intersection between the linear part and the power part of the gamma curve
    // gamm[2] stores this value. 
    // For gamm[0] = 0.45 and gamm[1] = 4.5, the output of the "for loop" is gamm[2] = 0.08242859 
    for (i=0; i &lt; 36; i++) {
      gamm[2] = (bnd[0] + bnd[1])/2;
      bnd[ (pow(gamm[2]/gamm[1],-gamm[0])-1)/gamm[0]-1/gamm[2] &gt; -1 ] = gamm[2];
      
    }
    gamm[3] = gamm[2]*(1/gamm[0]-1);
    // gamm[3] = 0.09930 for RGB
    gamm[2] /= gamm[1];
    // for gamm[1] = 4.5, here gamm[2] = 0.0180539
  }

  gamm[4] = 1 / (gamm[1]/2*SQR(gamm[2]) - gamm[3]*(1-gamm[2]) +
        (1-pow(gamm[2],1+gamm[0]))*(1+gamm[3])/(1+gamm[0])) - 1;

  if (output_bps == 8)
    pcurve[3] = (short)(256/gamm[4]+0.5) &lt;&lt; 16;        
  // in v8.91, pcurve[3] was 0x2330000 for sRGB and 0x1f00000 (1.94?) for RGB
</pre>
<p>
</p><pre style="BACKGROUND-COLOR: #c0c0c0">in gamma_lut()
...
    // should be compared by code in v8.91 to understand
    r &lt;= gamm[2] ? r*gamm[1] : pow(r,gamm[0])*(1+gamm[3])-gamm[3]);
...
</pre>

See also the <a href="http://www.poynton.com/PDFs/GammaFAQ.pdf">Gamma FAQ</a> by Charles Poynton: Question #6, "what is Gamma correction".
<p>

</p><hr>
<p>
<a name="ref">
</a></p><h2><a name="ref">7. References</a></h2><a name="ref">

</a><ul><a name="ref">
</a><li><a name="ref"><b></b></a><b><a href="https://rcsumner.net/raw_guide/RAWguide.pdf">Processing RAW Images in MATLAB</a></b>, Rob Sumner, Department of Electrical Engineering, UC Santa Cruz, November 18, 2013
</li><li>Open source decoders:
  <ul>
  <li><b><a href="http://cybercom.net/~dcoffin/dcraw/">DCRaw</a></b>, the reference open source software to decode RAW formats, by Dave Coffin.
  </li><li><a href="https://bitbucket.org/baldand/mlrawviewer/src/e7abaaf4cf9be66f46e0c8844297be0e7d88c288/liblj92/?at=master">lj92</a> Lossless jpeg 92, by Andrew Baldwin 2014
  </li><li><a href="https://web.archive.org/web/20100125074422/http://jrawio.tidalwave.it/">jrawio</a>. Service Provider Implementation for the Java ImageIO API, by Fabrizio Giudici. [Frozen since 11/2009]
  </li><li><a href="https://github.com/hfiguiere/libopenraw">Libopenraw</a> is a C++ library to decode RAW files, by Hubert Figuiere. 
  </li><li><a href="https://web.archive.org/web/20130523031826/http://wildtramper.com/sw/cr2/cr2.html">Canon's CR2 Raw File Format Specification</a>. by Wildtramper.com, with C++ decoder. 03/2007. [broken link]
<!-- Herbert Steierman, herb.s@ix.netcom.com, herb@wildtramper.com -->
  </li><li><a href="http://www.libraw.org/">libraw</a>. Based on dcraw. by Alex Tutubalin and Illiah Borg
  </li><li><a href="http://www.fastcinemadng.com/info/jpeg/lossless-jpeg-decoder.html">Fast DNG decoding on CPU</a>. Fastcinemadng.com.
  </li><li>http://www.rawdigger.com. Uses libraw, ExifTool and RawSpeed. Commercial software built from others' free ones!!!
  </li><li><a href="http://rawstudio.org/">rawstudio</a>, by Anders Brander and Anders Kvist
  </li><li><a href="http://sh0dan.blogspot.com/">Rawspeed</a>, Klaus Post. C++ and ASM decoder
  </li><li><a href="http://www.panix.com/~eli/jpeg/">PVRG Jpeg</a>. From Stanford Portable Video Research Group
  </li></ul>
</li><li>Standards:
  <ul>
  <li><a href="http://www.metadataworkinggroup.com/">Metadata working group</a>. "Preservation and seamless interoperability of digital image metadata". nothing about Makernotes.
  </li><li><a href="http://exif.org/">EXIF</a> organisation.
  </li><li><a href="http://www.w3.org/Graphics/JPEG/itu-t81.pdf">Jpeg</a> file format, ITU-t81 and ISO/IEC IS 10918-1 standard.
  </li><li><a href="http://www.w3.org/Graphics/JPEG/jfif3.pdf">jfif</a> Jpeg File Interchange Format, v1.02
  </li><li><a href="http://partners.adobe.com/public/developer/tiff/index.html">TIFF resources</a>. Adobe.
  </li><li><a href="http://xyrion.org/ciff/">xyrion.org/ciff</a>. CIFF (.CRW) official specifications.
  </li></ul>
</li><li>Patents:
<ul>
<li><a href="http://www.google.com/patents?id=Q_o7AAAAEBAJ&amp;printsec=abstract&amp;zoom=4&amp;dq=us+3+971+065">Color imaging array</a>, by Bryce E. Bayer (1976)
</li></ul>
</li><li>by Cedric Rouseau (French):
  <ul>
  <li><a href="http://crousseau.free.fr/imgfmt_raw.htm">Format d'images, RAW</a> C. Rousseau. (French) (<a href="http://lclevy.free.fr/cr2/imgfmt_raw.htm">local copy</a>)
  </li><li><a href="http://crousseau.free.fr/imgfmt_jpeg.htm">Jpeg</a> format, C. Rousseau (French).  
  </li></ul>
</li><li>by Phil Harvey, the author of Exiftool:
  <ul>
  <li><b><a href="http://www.sno.phy.queensu.ca/~phil/exiftool/TagNames/Canon.html">Canon Makernote</a></b> reference by Phil Harvey.
  </li><li><a href="http://www.sno.phy.queensu.ca/~phil/exiftool/canon_raw.html">CRW file format</a>, Phil Harvey, author of Exiftool.
  </li></ul>
</li><li><a href="http://www.impulseadventure.com/photo/jpeg-huffman-coding.html">Jpeg encoding</a> tutorial by Calvin Hass.
</li><li>demosaicing
  <ul>
  <li><a href="http://en.wikipedia.org/wiki/Demosaicing">Wikipedia</a>
  </li><li><a href="http://www.site.uottawa.ca/~edubois/courses/CEG4311/slides/InterpolationRGBcomponents.ppt">Interpolation of RGB components in Bayer CFA images</a>, by Eric Dubois
  </li><li><a href="http://www.accidentalmark.com/research/papers/Hirakawa03MNdemosaicICIP.pdf">Adaptative Homogeneity-Directed algorithm (AHD)</a> by 
  Keigo Hirakawa and Thomas W. Parks.
  </li><li><a href="http://www.csee.wvu.edu/~xinl/papers/demosaicing_survey.pdf">Image Demosaicing: A Systematic Survey</a>. Xin Lia, Bahadir Gunturkb and Lei Zhang. (Jan 2008)
  </li><li><a href="http://sites.google.com/site/demosaicalgorithms/modified-dcraw">Paul Lee</a> dcraw.
</li></ul>
</li><li>Color
  <ul>
  <li><a href="http://www.poynton.com/ColorFAQ.html">Color FAQ</a>. Charles Poynton
  </li><li><a href="http://www.brucelindbloom.com/index.html">Color models and rendering</a>. Bruce Lindbloom
  </li><li><a href="http://www.w3.org/Graphics/Color/sRGB">sRGB definition</a>.
  </li><li><a href="http://www.cis.rit.edu/fairchild/PDFs/AppearanceLec.pdf">Color Appearance Models: CIECAM02 and Beyond</a>. Mark D. Fairchild, 2004
  </li></ul>
</li><li>other tools:
<ul>
<li><a href="http://www.photome.de/">PhotoME</a>. Digital Photo Metadata Editor. Free.
</li><li><a href="http://www.cryptobola.com/PhotoBola/Rawnalyze.htm">Rawnalyze</a>. RAW analyser. Free
</li><li><a href="http://www.sensorgen.info/">http://www.sensorgen.info/</a>. Sensor info
</li></ul>
</li><li>Canon
<ul>
<li><a href="http://cpn.canon-europe.com/content/technical.do">Canon professional network technical</a> 
</li><li><a href="http://cpn.canon-europe.com/content/infobank.do">Canon professional network infobank</a> 
</li><li><a href="http://www.usa.canon.com/dlc/controller?act=GetArticleAct&amp;articleID=1426">John Paul Caponigro's "Lens Vignetting"</a>
</li></ul>
</li><li><a href="http://en.wikipedia.org/wiki/Chroma_subsampling">Chroma subsampling</a> article on Wikipedia.
</li><li><a href="http://www.cambridgeincolour.com/tutorials.htm">Cambridge in colour</a>
</li><li><a href="http://www.youtube.com/watch?v=8ZTVal7ofZ8&amp;feature=PlayList&amp;p=F7C5C8C217CF2E13&amp;index=5">PhotoTechEDU Day 6: Digital Camera Image Processing</a>
</li><li><a href="http://www.youtube.com/watch?v=gLw0A-Y8rQk&amp;feature=PlayList&amp;p=F7C5C8C217CF2E13&amp;index=17">PhotoTechEDU Day23: Raw Files and Formats</a>
</li><li>to get RAW samples: <a href="http://www.imaging-resource.com/">imaging-resource</a>, <a href="http://www.photographyblog.com/">photographyblog.com</a>, 
<a href="http://www.focus-numerique.com/">focus-numerique</a>, 
<a href="https://raw.pixls.us/data/Canon/">raw.pixls.us</a>, 
<a href="http://digikam3rdparty.free.fr/TEST_IMAGES/RAW/">digikam3rdparty.free.fr</a>,
http://raw.fotosite.pl/, <a href="http://http//www.rawsamples.ch/index.php/en/">www.rawsamples.ch</a>.

<!--

<li>http://doug.kerr.home.att.net/pumpkin/Cosine_Fourth_Falloff.pdf
-->

</li></ul>
<p>
</p><hr>
<p>
<a name="soft">
</a></p><h2><a name="soft">8. Related patents</a></h2><a name="soft">

<!--

http://www.freepatentsonline.com/8314857.html, Data processing apparatus and control method thereof with generating of single unique identification information using device identification information, device state information and recording information 
http://www.freepatentsonline.com/7705894.html, Data processing apparatus and control method thereof with updating of unique identification information of a changed recorded file 

<h2>Canon published Patents about Digital Camera</h2>

<li>http://www.freepatentsonline.com/7636114.html, dust correction
<li>http://www.freepatentsonline.com/8237821.html, distortion correction

Assignees are <a href="http://www.faqs.org/patents/asn/444"> CANON KABUSHIKI KAISHA </a>.
<ul>
<li><a href="http://appft1.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&co1=AND&d=PG01&s1=20100013962.PGNR.&OS=DN/20100013962RS=DN/20100013962">US20100013962</a>dust reduction
http://appft1.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&co1=AND&d=PG01&s1=20100013962.PGNR.&OS=DN/20100013962RS=DN/20100013962

<li><a href="http://www.faqs.org/patents/app/20090232484">US20090232484</a>. A lens barrel having an increased strength against external impact.
<li><a href="http://www.faqs.org/patents/app/20090225226">US20090225226</a>. WB correction using face detection.
<li><a href="http://www.faqs.org/patents/app/20090224346">US20090224346</a>. "To suppress leakage of electric charges into an adjacent pixel that is caused by obliquely incident light"
<li><a href="http://www.faqs.org/patents/app/20090219636">US20090219636</a>. Lens with magnetic parts
<li><a href="http://www.faqs.org/patents/app/20090219420">US20090219420</a>. image sensor in still and video mode
<li><a href="http://www.faqs.org/patents/app/20090219414">US20090219414</a>. image sensor.
<li><a href="http://www.faqs.org/patents/app/20090219405">US20090219405</a>. "detects the face of a person from the input image, and calculates a feature amount associated with the open/closed state of eyes of the detected face"
<li><a href="http://www.faqs.org/patents/app/20090218479">US20090218479</a>. sensor to better receive Red color 
<li><a href="http://www.faqs.org/patents/app/20090218477">US20090218477</a>. improved sensor
<li>20090213472. lens system
<li>20090213249. against dust on sensor
<li>20090213238. "capture a still image with high image quality during capturing of a moving image"
<li>20090213237. "to obtain a high-resolution still image and prevent drop frame of an obtained moving image even when parallel shooting of still and moving images is performed".
<li>20090208126. lossless compression for character. jpeg compression for the background
<li>20090207501. zoom lens
<li>20090207493. cleaning sensor system 
<li>20090207298. auto focus using object detection in motion picture
<li>..
<li>http://www.freepatentsonline.com/y2009/0252232.html. image encoding technique
<li>...
<li><a href="http://www.faqs.org/patents/app/20080292301">US20080292301</a>. Liveview
<li><a href="http://www.faqs.org/patents/app/20080292197">US20080292197</a>. encoding technique of an image
<li><a href="http://www.faqs.org/patents/app/20080291547">US20080291547</a>. Zoom lens system.
<li><a href="http://www.faqs.org/patents/app/20080291546">US20080291546</a>. Zoom lens system.
<li><a href="http://www.faqs.org/patents/app/20080291317">US20080291317</a>. "to photograph images with unevenness of exposure reduced in a case in which an electronic shutter and a mechanical shutter are used in combination to carry out photography in an image sensing apparatus with an exchangeable lens unit."
<li><a href="http://www.faqs.org/patents/app/20080291306">US20080291306</a>. "a technique for controlling exposure and charge accumulation using an electronic shutter function that controls the charge accumulation time in an image sensing element and a mechanical shutter function for shielding the light receiving surface of the image sensing element with shutter blades"
<li><a href="http://www.faqs.org/patents/app/20080291304">US20080291304</a>. "provide an imaging device capable of realizing prevention of decrease in frame rate without complicating reading of an image in low resolution and an image in high resolution and to provide a driving method thereof"
<li><a href="http://www.faqs.org/patents/app/20080291299">US20080291299</a>. light fall-off correction
<li><a href="http://www.faqs.org/patents/app/20080291293">US20080291293</a>. Exposure correction
<li><a href="http://www.faqs.org/patents/app/20080291290">US20080291290</a>. my summary : Usage of ineffective pixel region to know black pixel level noise and remove it, without using large memory.<br>
Seems to be the same thing described <a href="http://www.pictureline.com/newsletter/article.php?id=684">here</a> as 'CMOS Noise Cancellation Technology'
<li><a href="http://www.faqs.org/patents/app/20080285791">US20080285791</a>. Face detection.
<li><a href="http://www.faqs.org/patents/app/20080285864">US20080285864</a>. "encoding and decoding techniques of an image. "
<li><a href="http://www.faqs.org/patents/app/20080285146">US20080285146</a>. "zoom lens system"
<li><a href="http://www.faqs.org/patents/app/20080284874">US20080284874</a>. "An image capturing apparatus performs photographing multiple times and composing these multiple images to obtain one image of a correct exposure"
<li><a href="http://www.faqs.org/patents/app/20080284873">US20080284873</a>. liveview related
<li><a href="http://www.faqs.org/patents/app/20080273249">US20080273249</a>. compact zoom lens system
<li><a href="http://www.faqs.org/patents/app/20080267608">US20080267608</a>. exposure control with electronic shutter.
<li><a href="http://www.faqs.org/patents/app/20080267607">US20080267607</a>. "An image pickup apparatus includes an eyepiece portion and a touch panel..."
<li><a href="http://www.faqs.org/patents/app/20080266673">US20080266673</a>. zoom lens system
<li><a href="http://www.faqs.org/patents/app/20080260273">US20080260273</a>. image compression
<li><a href="http://www.faqs.org/patents/app/20080259454">US20080259454</a>. zoom lens system
<li><a href="http://www.faqs.org/patents/app/20080198257">US20080198257</a>. constrast and phase diff Auto Focus sensor ?
</ul>

<h2>Other Patents</h2>
<ul>
<li><a href="http://www.freepatentsonline.com/20070211154.pdf">Us20070211154</a>. Lens vignetting correction algorithm in digital cameras.

</ul>
 -->
</a><ul><a name="soft">
</a><li><a name="soft">sRaw. RGB-&gt;YUV conversion
  </a><ul><a name="soft">
  </a><li><a name="soft"></a><a href="http://www.freepatentsonline.com/7542076.html">US7542076, Image sensing apparatus having a color interpolation unit and image processing method therefor</a>. 
  </li><li><a href="http://www.freepatentsonline.com/6958772.html">US6958772, Image sensing apparatus and image processing method therefor</a><a>.
  </a></li></ul><a>
</a></li><li><a>Original Decision Data (Tag #0x0083)
  </a><ul><a>
  </a><li><a></a><a href="http://www.freepatentsonline.com/7535488.html">US patent 7535488 (Nov 2001), Image data verification system</a>
  </li><li><a href="http://www.freepatentsonline.com/7630510.html">US patent 7630510 (Mar 2004), Image verification apparatus and image verification method </a>
  </li><li><a href="http://www.freepatentsonline.com/7783071.html">US patent 7783071 (Dec 2004), Imaging apparatus having a slot in which an image verification apparatus is inserted </a>
  </li><li><a href="http://www.google.com/patents/US7650511">US patent 7650511 (Feb 2005), Information processing method, falsification verification method and device, storage medium, and program</a>
  </li><li><a href="http://www.google.com/patents/US7930544">US patent 7930544 (Oct 2005), Data processing apparatus and its method</a>
  </li><li><a href="http://www.google.com/patents/US7949124">US patent 7949124 (Jan 2007), Information processing apparatus, control method for the same, program and storage medium</a>
  </li><li><a href="http://www.google.com/patents/US8005213">US patent 8005213 (Jul 2007), Method, apparatus, and computer program for generating session keys for encryption of image data</a>
  </li><li><a href="http://www.freepatentsonline.com/8031239.html">US Patent 8031239 (2008), Image sensing apparatus for generating image data authentication data of the image data</a>
  </li><li><a href="http://www.freepatentsonline.com/8037543.html">US Patent 8037543 (Mar 2010), Image processing apparatus, image processing method, computer program and computer-readable recording medium </a>
  </li></ul>
</li><li>Dust Delete Data (Tag #0x0097)
  <ul>
  <li><a href="http://www.freepatentsonline.com/7657116.html">US patent 7657116 (Sept 2004), Correction method of defective pixel in image pickup device and image processing apparatus using the correction method </a>
  </li><li><a href="http://www.freepatentsonline.com/7636114.html">US patent 7636114 (Sept 2005), Image sensing apparatus and control method capable of performing dust correction</a>
  </li><li><a href="http://www.freepatentsonline.com/7705906.html">US patent 7705906 (Dec 2006), Image sensing apparatus and control method thereof and program for implementing the method </a>
  </li><li><a href="http://www.freepatentsonline.com/8089554.html">US patent 8089554 (June 2008), Image capturing apparatus, control method therefor, and program</a>
  </li><li><a href="http://www.freepatentsonline.com/8208752.html">US patent 8208752 (Feb 2008), Image processing apparatus, control method therefor, program, storage medium, and image capturing apparatus</a>
  </li></ul>
</li></ul>

<p>
</p><hr>
<p>
<a name="ml">
</a></p><h2><a name="ml">9. Magic Lantern work</a></h2><a name="ml">

People of Magic Lantern project have reversed of a lot of Canon firmware and hardware, thus there is link between their findings and how CR2 format data must be interpreted.
</a><ul><a name="ml">
</a><li><a name="ml">Software
</a><ul><a name="ml">
</a><li><a name="ml"></a><a href="http://magiclantern.wikia.com/wiki/Update_records">firmware updates</a> LENS part, contains lens data (PROP_OPTICAL_CORRECT_PARAM, likely for optical correction)
</li><li><a href="http://www.magiclantern.fm/forum/index.php?topic=17795.msg171595#msg171595"> TUNE part</a>, contains vertical stripes correction
</li><li><a href="https://bitbucket.org/hudson/magic-lantern/src/fa4b9a00d0ca859ea86a4a0c9b0b144ef2e9b02b/contrib/indy/readme.TXT?at=unified&amp;fileviewer=file-view-default">old code</a> to parse LENS and TUNE data from camera memory. 
See <a href="http://www.magiclantern.fm/forum/index.php?topic=4729.0">PropertyEditor</a> from G3gg0. 
</li></ul>
</li><li>Hardware
<ul>
<li><a href="http://www.magiclantern.fm/forum/index.php?topic=18443.0">ProcessTwoInTwoOutLosslessPath</a> is about raw/sraw compression and decompression
</li><li><a href="http://magiclantern.wikia.com/wiki/Register_Map#JPCORE">JP57</a> is the hardware for lossless to jpeg rendering 
</li><li><a href="http://www.magiclantern.fm/forum/index.php?topic=18315.0">EDMAC</a> internals 
</li></ul>
</li></ul>

<hr>
<p>
<a name="app">
</a></p><h2><a name="app">10. Appendices</a></h2><a name="app">

<h3>10.1 Sensor information for each model</h3>

<div id="sensors"><table border="1" cellpadding="2"><colgroup><col span="2" style="background-color:white"><col span="6" style="background-color:#D8D8D8"><col span="3" style="background-color:white"><col span="2" style="background-color:#D8D8D8"><col span="4" style="background-color:white"><col span="4" style="background-color:#D8D8D8"></colgroup><tbody><tr><th>modelId</th><th> modelName</th><th> jpeg bits</th><th> jpeg wide</th><th> jpeg high</th><th> jpeg comp</th><th> jpeg hsf</th><th> jpeg vsf</th><th> slices[0]</th><th> slices[1]</th><th> slices[2]</th><th> sensor Width</th><th> sensor Height</th><th> sensor Left border</th><th> sensor Top border</th><th> sensor Bottom border</th><th> sensor Right border</th><th>black mask Left border</th><th>black mask top border</th><th>black mask Bottom border</th><th>black mask Right border</th><th> image Width</th><th> image Height</th><th> vShift</th></tr><tr><td>0x80000174</td><td> Canon EOS-1D Mark II</td><td> 12</td><td> 1798</td><td> 2360</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 3596</td><td> 3596</td><td> 2360</td><td> 84</td><td> 19</td><td> 3587</td><td> 2354</td><td> 14</td><td> 162</td><td> 55</td><td> 2209</td><td> 3504</td><td> 2336</td><td> 1</td></tr><tr><td>0x80000188</td><td> Canon EOS-1Ds Mark II</td><td> 12</td><td> 2554</td><td> 3349</td><td> 2</td><td> 1</td><td> 1</td><td> 2</td><td> 1680</td><td> 1748</td><td> 5108</td><td> 3349</td><td> 108</td><td> 19</td><td> 5099</td><td> 3346</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 4992</td><td> 3328</td><td> 0</td></tr><tr><td>0x80000175</td><td> Canon EOS 20D</td><td> 12</td><td> 1798</td><td> 2360</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 3596</td><td> 3596</td><td> 2360</td><td> 84</td><td> 19</td><td> 3587</td><td> 2354</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3504</td><td> 2336</td><td> 1</td></tr><tr><td>0x80000189</td><td> Canon EOS 350D DIGITAL</td><td> 12</td><td> 1758</td><td> 2328</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 1758</td><td> 1758</td><td> 3516</td><td> 2328</td><td> 52</td><td> 19</td><td> 3507</td><td> 2322</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3456</td><td> 2304</td><td> 1</td></tr><tr><td>0x80000213</td><td> Canon EOS 5D</td><td> 12</td><td> 2238</td><td> 2954</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2238</td><td> 2238</td><td> 4476</td><td> 2954</td><td> 100</td><td> 39</td><td> 4467</td><td> 2950</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 4368</td><td> 2912</td><td> 1</td></tr><tr><td>0x80000232</td><td> Canon EOS-1D Mark II N</td><td> 12</td><td> 1798</td><td> 2360</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 1798</td><td> 1798</td><td> 3596</td><td> 2360</td><td> 84</td><td> 19</td><td> 3587</td><td> 2354</td><td> 14</td><td> 162</td><td> 55</td><td> 2209</td><td> 3504</td><td> 2336</td><td> 1</td></tr><tr><td>0x80000234</td><td> Canon EOS 30D</td><td> 12</td><td> 1798</td><td> 2360</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 1798</td><td> 1798</td><td> 3596</td><td> 2360</td><td> 84</td><td> 19</td><td> 3587</td><td> 2354</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3504</td><td> 2336</td><td> 1</td></tr><tr><td>0x80000236</td><td> Canon EOS 400D DIGITAL</td><td> 12</td><td> 1974</td><td> 2622</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 1974</td><td> 1974</td><td> 3948</td><td> 2622</td><td> 52</td><td> 23</td><td> 3939</td><td> 2614</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3888</td><td> 2592</td><td> 1</td></tr><tr><td>0x80000169</td><td> Canon EOS-1D Mark III</td><td> 14</td><td> 1992</td><td> 2622</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 1992</td><td> 1992</td><td> 3984</td><td> 2622</td><td> 88</td><td> 25</td><td> 3975</td><td> 2616</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3888</td><td> 2592</td><td> 1</td></tr><tr><td>0x80000190</td><td> Canon EOS 40D</td><td> 14</td><td> 1972</td><td> 2622</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 1952</td><td> 1992</td><td> 3944</td><td> 2622</td><td> 40</td><td> 23</td><td> 3927</td><td> 2614</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3888</td><td> 2592</td><td> 1</td></tr><tr><td>0x80000215</td><td> Canon EOS-1Ds Mark III</td><td> 14</td><td> 2856</td><td> 3774</td><td> 2</td><td> 1</td><td> 1</td><td> 2</td><td> 1920</td><td> 1872</td><td> 5712</td><td> 3774</td><td> 72</td><td> 25</td><td> 5687</td><td> 3768</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5616</td><td> 3744</td><td> 1</td></tr><tr><td>0x02230000</td><td> Canon PowerShot G9</td><td> 12</td><td> 2052</td><td> 3048</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2056</td><td> 2048</td><td> 4104</td><td> 3048</td><td> 64</td><td> 24</td><td> 4063</td><td> 3023</td><td> 38</td><td> 24</td><td> 41</td><td> 3023</td><td> 4000</td><td> 3000</td><td> 0</td></tr><tr><td>0x80000176</td><td> Canon EOS 450D</td><td> 14</td><td> 2156</td><td> 2876</td><td> 2</td><td> 1</td><td> 1</td><td> 2</td><td> 1440</td><td> 1432</td><td> 4312</td><td> 2876</td><td> 32</td><td> 23</td><td> 4303</td><td> 2870</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 4272</td><td> 2848</td><td> 1</td></tr><tr><td>0x80000254</td><td> Canon EOS 1000D</td><td> 12</td><td> 1974</td><td> 2622</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 1964</td><td> 1984</td><td> 3948</td><td> 2622</td><td> 52</td><td> 23</td><td> 3939</td><td> 2614</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3888</td><td> 2592</td><td> 1</td></tr><tr><td>0x80000261</td><td> Canon EOS 50D</td><td> 14</td><td> 1208</td><td> 3228</td><td> 4</td><td> 1</td><td> 1</td><td> 2</td><td> 1616</td><td> 1600</td><td> 4832</td><td> 3228</td><td> 72</td><td> 56</td><td> 4823</td><td> 3223</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 4752</td><td> 3168</td><td> 1</td></tr><tr><td>0x02490000</td><td> Canon PowerShot G10</td><td> 12</td><td> 2240</td><td> 3348</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2236</td><td> 2244</td><td> 4480</td><td> 3348</td><td> 20</td><td> 17</td><td> 4435</td><td> 3328</td><td> 4466</td><td> 17</td><td> 4469</td><td> 3328</td><td> 4416</td><td> 3312</td><td> 0</td></tr><tr><td>0x80000218</td><td> Canon EOS 5D Mark II</td><td> 14</td><td> 1448</td><td> 3804</td><td> 4</td><td> 1</td><td> 1</td><td> 2</td><td> 1936</td><td> 1920</td><td> 5792</td><td> 3804</td><td> 168</td><td> 56</td><td> 5783</td><td> 3799</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5616</td><td> 3744</td><td> 1</td></tr><tr><td>0x02460000</td><td> Canon PowerShot SX1 IS</td><td> 12</td><td> 2076</td><td> 2772</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2168</td><td> 1984</td><td> 4152</td><td> 2772</td><td> 344</td><td> 24</td><td> 3991</td><td> 2759</td><td> 168</td><td> 312</td><td> 171</td><td> 2471</td><td> 3648</td><td> 2736</td><td> 0</td></tr><tr><td>0x80000252</td><td> Canon EOS Kiss X3</td><td> 14</td><td> 1208</td><td> 3204</td><td> 4</td><td> 1</td><td> 1</td><td> 2</td><td> 1616</td><td> 1600</td><td> 4832</td><td> 3204</td><td> 72</td><td> 31</td><td> 4823</td><td> 3198</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 4752</td><td> 3168</td><td> 1</td></tr><tr><td>0x02700000</td><td> Canon PowerShot G11</td><td> 12</td><td> 1872</td><td> 2784</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 1848</td><td> 1896</td><td> 3744</td><td> 2784</td><td> 24</td><td> 28</td><td> 3671</td><td> 2763</td><td> 3732</td><td> 28</td><td> 3735</td><td> 2763</td><td> 3648</td><td> 2736</td><td> 0</td></tr><tr><td>0x02720000</td><td> Canon PowerShot S90</td><td> 12</td><td> 1872</td><td> 2784</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 1848</td><td> 1896</td><td> 3744</td><td> 2784</td><td> 24</td><td> 28</td><td> 3671</td><td> 2763</td><td> 3732</td><td> 28</td><td> 3735</td><td> 2763</td><td> 3648</td><td> 2736</td><td> 0</td></tr><tr><td>0x80000250</td><td> Canon EOS 7D</td><td> 14</td><td> 1340</td><td> 3516</td><td> 4</td><td> 1</td><td> 1</td><td> 2</td><td> 1728</td><td> 1904</td><td> 5360</td><td> 3516</td><td> 168</td><td> 56</td><td> 5351</td><td> 3511</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5184</td><td> 3456</td><td> 1</td></tr><tr><td>0x80000281</td><td> Canon EOS-1D Mark IV</td><td> 14</td><td> 1280</td><td> 3318</td><td> 4</td><td> 1</td><td> 1</td><td> 2</td><td> 1728</td><td> 1664</td><td> 5120</td><td> 3318</td><td> 152</td><td> 50</td><td> 5047</td><td> 3313</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 4896</td><td> 3264</td><td> 1</td></tr><tr><td>0x80000270</td><td> Canon EOS 550D</td><td> 14</td><td> 1336</td><td> 3516</td><td> 4</td><td> 1</td><td> 1</td><td> 2</td><td> 1728</td><td> 1888</td><td> 5344</td><td> 3516</td><td> 152</td><td> 56</td><td> 5335</td><td> 3511</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5184</td><td> 3456</td><td> 1</td></tr><tr><td>0x02950000</td><td> Canon PowerShot S95</td><td> 12</td><td> 1872</td><td> 2784</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 1848</td><td> 1896</td><td> 3744</td><td> 2784</td><td> 72</td><td> 24</td><td> 3719</td><td> 2759</td><td> 40</td><td> 24</td><td> 43</td><td> 2759</td><td> 3648</td><td> 2736</td><td> 0</td></tr><tr><td>0x80000287</td><td> Canon EOS 60D</td><td> 14</td><td> 1336</td><td> 3516</td><td> 4</td><td> 1</td><td> 1</td><td> 2</td><td> 1728</td><td> 1888</td><td> 5344</td><td> 3516</td><td> 152</td><td> 56</td><td> 5335</td><td> 3511</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5184</td><td> 3456</td><td> 1</td></tr><tr><td>0x02920000</td><td> Canon PowerShot G12</td><td> 12</td><td> 1872</td><td> 2784</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 1848</td><td> 1896</td><td> 3744</td><td> 2784</td><td> 72</td><td> 24</td><td> 3719</td><td> 2759</td><td> 40</td><td> 24</td><td> 43</td><td> 2759</td><td> 3648</td><td> 2736</td><td> 0</td></tr><tr><td>0x80000286</td><td> Canon EOS REBEL T3i</td><td> 14</td><td> 1336</td><td> 3516</td><td> 4</td><td> 1</td><td> 1</td><td> 2</td><td> 1728</td><td> 1888</td><td> 5344</td><td> 3516</td><td> 152</td><td> 56</td><td> 5335</td><td> 3511</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5184</td><td> 3456</td><td> 1</td></tr><tr><td>0x80000288</td><td> Canon EOS REBEL T3</td><td> 14</td><td> 1088</td><td> 2874</td><td> 4</td><td> 1</td><td> 1</td><td> 2</td><td> 1440</td><td> 1472</td><td> 4352</td><td> 2874</td><td> 72</td><td> 23</td><td> 4343</td><td> 2870</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 4272</td><td> 2848</td><td> 1</td></tr><tr><td>0x03110000</td><td> Canon PowerShot S100</td><td> 12</td><td> 2080</td><td> 3124</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2128</td><td> 2032</td><td> 4160</td><td> 3124</td><td> 128</td><td> 35</td><td> 4127</td><td> 3034</td><td> 128</td><td> 2</td><td> 4127</td><td> 7</td><td> 4000</td><td> 3000</td><td> 0</td></tr><tr><td>0x80000269</td><td> Canon EOS-1D X</td><td> 14</td><td> 2672</td><td> 3584</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2672</td><td> 2672</td><td> 5344</td><td> 3584</td><td> 144</td><td> 114</td><td> 5327</td><td> 3569</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5184</td><td> 3456</td><td> 0</td></tr><tr><td>0x03080000</td><td> Canon PowerShot G1 X</td><td> 14</td><td> 2248</td><td> 3366</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 4496</td><td> 4496</td><td> 3366</td><td> 108</td><td> 76</td><td> 4459</td><td> 3339</td><td> 80</td><td> 3</td><td> 959</td><td> 5</td><td> 4352</td><td> 3264</td><td> 0</td></tr><tr><td>0x80000285</td><td> Canon EOS 5D Mark III</td><td> 14</td><td> 2960</td><td> 3950</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2960</td><td> 2960</td><td> 5920</td><td> 3950</td><td> 140</td><td> 96</td><td> 5899</td><td> 3935</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5760</td><td> 3840</td><td> 0</td></tr><tr><td>0x80000301</td><td> Canon EOS REBEL T4i</td><td> 14</td><td> 2640</td><td> 3528</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2640</td><td> 2640</td><td> 5280</td><td> 3528</td><td> 84</td><td> 64</td><td> 5267</td><td> 3519</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5184</td><td> 3456</td><td> 0</td></tr><tr><td>0x80000331</td><td> Canon EOS M</td><td> 14</td><td> 2640</td><td> 3528</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2640</td><td> 2640</td><td> 5280</td><td> 3528</td><td> 84</td><td> 64</td><td> 5267</td><td> 3519</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5184</td><td> 3456</td><td> 0</td></tr><tr><td>0x03360000</td><td> Canon PowerShot S110</td><td> 12</td><td> 2080</td><td> 3124</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2128</td><td> 2032</td><td> 4160</td><td> 3124</td><td> 128</td><td> 35</td><td> 4127</td><td> 3034</td><td> 128</td><td> 2</td><td> 4127</td><td> 7</td><td> 4000</td><td> 3000</td><td> 0</td></tr><tr><td>0x03330000</td><td> Canon PowerShot G15</td><td> 12</td><td> 2080</td><td> 3124</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2128</td><td> 2032</td><td> 4160</td><td> 3124</td><td> 128</td><td> 35</td><td> 4127</td><td> 3034</td><td> 128</td><td> 2</td><td> 4127</td><td> 7</td><td> 4000</td><td> 3000</td><td> 0</td></tr><tr><td>0x03340000</td><td> Canon PowerShot SX50 HS</td><td> 12</td><td> 2088</td><td> 3062</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 4176</td><td> 4176</td><td> 3062</td><td> 132</td><td> 40</td><td> 4131</td><td> 3039</td><td> 120</td><td> 2</td><td> 4143</td><td> 15</td><td> 4000</td><td> 3000</td><td> 0</td></tr><tr><td>0x80000302</td><td> Canon EOS 6D</td><td> 14</td><td> 2784</td><td> 3708</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2784</td><td> 2784</td><td> 5568</td><td> 3708</td><td> 84</td><td> 50</td><td> 5555</td><td> 3697</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5472</td><td> 3648</td><td> 0</td></tr><tr><td>0x80000326</td><td> Canon EOS REBEL T5i</td><td> 14</td><td> 2640</td><td> 3528</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2640</td><td> 2640</td><td> 5280</td><td> 3528</td><td> 84</td><td> 64</td><td> 5267</td><td> 3519</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5184</td><td> 3456</td><td> 0</td></tr><tr><td>0x80000346</td><td> Canon EOS Kiss X7</td><td> 14</td><td> 2640</td><td> 3528</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2640</td><td> 2640</td><td> 5280</td><td> 3528</td><td> 84</td><td> 64</td><td> 5267</td><td> 3519</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5184</td><td> 3456</td><td> 0</td></tr><tr><td>0x80000325</td><td> Canon EOS 70D</td><td> 14</td><td> 2784</td><td> 3708</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2784</td><td> 2784</td><td> 5568</td><td> 3708</td><td> 84</td><td> 50</td><td> 5555</td><td> 3697</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5472</td><td> 3648</td><td> 0</td></tr><tr><td>0x03540000</td><td> Canon PowerShot G16</td><td> 12</td><td> 2096</td><td> 3062</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 4192</td><td> 4192</td><td> 3062</td><td> 132</td><td> 40</td><td> 4131</td><td> 3039</td><td> 120</td><td> 2</td><td> 4143</td><td> 15</td><td> 4000</td><td> 3000</td><td> 0</td></tr><tr><td>0x03550000</td><td> Canon PowerShot S120</td><td> 12</td><td> 2096</td><td> 3062</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 4192</td><td> 4192</td><td> 3062</td><td> 132</td><td> 40</td><td> 4131</td><td> 3039</td><td> 120</td><td> 2</td><td> 4143</td><td> 15</td><td> 4000</td><td> 3000</td><td> 0</td></tr><tr><td>0x80000355</td><td> Canon EOS M2</td><td> 14</td><td> 2640</td><td> 3528</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2640</td><td> 2640</td><td> 5280</td><td> 3528</td><td> 84</td><td> 64</td><td> 5267</td><td> 3519</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5184</td><td> 3456</td><td> 0</td></tr><tr><td>0x80000327</td><td> Canon EOS 1200D</td><td> 14</td><td> 1336</td><td> 3516</td><td> 4</td><td> 1</td><td> 1</td><td> 2</td><td> 1728</td><td> 1888</td><td> 5344</td><td> 3516</td><td> 152</td><td> 56</td><td> 5335</td><td> 3511</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5184</td><td> 3456</td><td> 1</td></tr><tr><td>0x03640000</td><td> Canon PowerShot G1 X Mark II</td><td> 14</td><td> 2240</td><td> 3366</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 4480</td><td> 4480</td><td> 3366</td><td> 204</td><td> 148</td><td> 4363</td><td> 3267</td><td> 272</td><td> 3</td><td> 4303</td><td> 4</td><td> 4160</td><td> 3120</td><td> 0</td></tr><tr><td>0x80000289</td><td> Canon EOS 7D Mark II</td><td> 14</td><td> 2784</td><td> 3708</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2784</td><td> 2784</td><td> 5568</td><td> 3708</td><td> 84</td><td> 50</td><td> 5555</td><td> 3697</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5472</td><td> 3648</td><td> 0</td></tr><tr><td>0x03780000</td><td> Canon PowerShot G7 X</td><td> 12</td><td> 2816</td><td> 3710</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 5632</td><td> 5632</td><td> 3710</td><td> 132</td><td> 40</td><td> 5603</td><td> 3687</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5472</td><td> 3648</td><td> 0</td></tr><tr><td>0x03750000</td><td> Canon PowerShot SX60 HS</td><td> 12</td><td> 2384</td><td> 3516</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 4768</td><td> 4768</td><td> 3516</td><td> 124</td><td> 38</td><td> 4731</td><td> 3493</td><td> 112</td><td> 0</td><td> 4743</td><td> 15</td><td> 4608</td><td> 3456</td><td> 0</td></tr><tr><td>0x80000401</td><td> Canon EOS 5DS R</td><td> 14</td><td> 4448</td><td> 2960</td><td> 4</td><td> 1</td><td> 1</td><td> 1</td><td> 4448</td><td> 4448</td><td> 8896</td><td> 5920</td><td> 196</td><td> 102</td><td> 8883</td><td> 5893</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 8688</td><td> 5792</td><td> 0</td></tr><tr><td>0x80000393</td><td> Canon EOS Rebel T6i</td><td> 14</td><td> 3048</td><td> 4056</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 3048</td><td> 3048</td><td> 6096</td><td> 4056</td><td> 84</td><td> 46</td><td> 6083</td><td> 4045</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 6000</td><td> 4000</td><td> 0</td></tr><tr><td>0x80000347</td><td> Canon EOS Rebel T6s</td><td> 14</td><td> 3048</td><td> 4056</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 3048</td><td> 3048</td><td> 6096</td><td> 4056</td><td> 84</td><td> 46</td><td> 6083</td><td> 4045</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 6000</td><td> 4000</td><td> 0</td></tr><tr><td>0x03740000</td><td> Canon EOS M3</td><td> 14</td><td> 3048</td><td> 4056</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 6096</td><td> 6096</td><td> 4056</td><td> 84</td><td> 46</td><td> 6083</td><td> 4045</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 6000</td><td> 4000</td><td> 0</td></tr><tr><td>0x03850000</td><td> Canon PowerShot G3 X</td><td> 14</td><td> 2816</td><td> 3710</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 5632</td><td> 5632</td><td> 3710</td><td> 132</td><td> 40</td><td> 5603</td><td> 3687</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5472</td><td> 3648</td><td> 0</td></tr><tr><td>0x03840000</td><td> Canon EOS M10</td><td> 14</td><td> 2640</td><td> 3528</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 5280</td><td> 5280</td><td> 3528</td><td> 84</td><td> 62</td><td> 5267</td><td> 3517</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5184</td><td> 3456</td><td> 0</td></tr><tr><td>0x03950000</td><td> Canon PowerShot G5 X</td><td> 14</td><td> 2816</td><td> 3710</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 5632</td><td> 5632</td><td> 3710</td><td> 132</td><td> 40</td><td> 5603</td><td> 3687</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5472</td><td> 3648</td><td> 0</td></tr><tr><td>0x03930000</td><td> Canon PowerShot G9 X</td><td> 14</td><td> 2816</td><td> 3710</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 5632</td><td> 5632</td><td> 3710</td><td> 132</td><td> 40</td><td> 5603</td><td> 3687</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5472</td><td> 3648</td><td> 0</td></tr><tr><td>0x80000350</td><td> Canon EOS 80D</td><td> 14</td><td> 3144</td><td> 4056</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 3144</td><td> 3144</td><td> 6288</td><td> 4056</td><td> 276</td><td> 46</td><td> 6275</td><td> 4045</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 6000</td><td> 4000</td><td> 0</td></tr><tr><td>0x03970000</td><td> Canon PowerShot G7 X Mark II</td><td> 14</td><td> 2816</td><td> 3710</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 5632</td><td> 5632</td><td> 3710</td><td> 132</td><td> 40</td><td> 5603</td><td> 3687</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5472</td><td> 3648</td><td> 0</td></tr><tr><td>0x80000328</td><td> Canon EOS-1D X Mark II</td><td> 14</td><td> 2784</td><td> 3708</td><td> 2</td><td> 1</td><td> 1</td><td> 1</td><td> 2784</td><td> 2784</td><td> 5568</td><td> 3708</td><td> 84</td><td> 50</td><td> 5555</td><td> 3697</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5472</td><td> 3648</td><td> 0</td></tr><tr><td>0x80000404</td><td> Canon EOS Rebel T6</td><td> 14</td><td> 1336</td><td> 3516</td><td> 4</td><td> 1</td><td> 1</td><td> 2</td><td> 1728</td><td> 1888</td><td> 5344</td><td> 3516</td><td> 152</td><td> 56</td><td> 5335</td><td> 3511</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5184</td><td> 3456</td><td> 1</td></tr><tr><td>0x80000349</td><td> Canon EOS 5D Mark IV</td><td> 14</td><td> 3440</td><td> 2272</td><td> 4</td><td> 1</td><td> 1</td><td> 1</td><td> 3440</td><td> 3440</td><td> 6880</td><td> 4544</td><td> 148</td><td> 54</td><td> 6867</td><td> 4533</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 6720</td><td> 4480</td><td> 0</td></tr><tr><td>0x80000349</td><td> Canon EOS 5D Mark IV</td><td> 14</td><td> 3440</td><td> 2272</td><td> 4</td><td> 1</td><td> 1</td><td> 1</td><td> 3440</td><td> 3440</td><td> 6880</td><td> 4544</td><td> 148</td><td> 54</td><td> 6867</td><td> 4533</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 6720</td><td> 4480</td><td> 0</td></tr><tr><td>0x03940000</td><td> Canon EOS M5</td><td> 14</td><td> 3144</td><td> 4056</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 6288</td><td> 6288</td><td> 4056</td><td> 276</td><td> 48</td><td> 6275</td><td> 4047</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 6000</td><td> 4000</td><td> 0</td></tr><tr><td>0x04070000</td><td> Canon EOS M6</td><td> 14</td><td> 3144</td><td> 4056</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 6288</td><td> 6288</td><td> 4056</td><td> 276</td><td> 48</td><td> 6275</td><td> 4047</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 6000</td><td> 4000</td><td> 0</td></tr><tr><td>0x80000406</td><td> Canon EOS 6D Mark II</td><td> 14</td><td> 3192</td><td> 2112</td><td> 4</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 12768</td><td> 6384</td><td> 4224</td><td> 132</td><td> 56</td><td> 6371</td><td> 4215</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 6240</td><td> 4160</td><td> 0</td></tr><tr><td>0x80000417</td><td> Canon EOS Rebel SL2</td><td> 14</td><td> 3144</td><td> 4056</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 6288</td><td> 6288</td><td> 4056</td><td> 276</td><td> 48</td><td> 6275</td><td> 4047</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 6000</td><td> 4000</td><td> 0</td></tr><tr><td>0x03980000</td><td> Canon EOS M100</td><td> 14</td><td> 3144</td><td> 4056</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 6288</td><td> 6288</td><td> 4056</td><td> 276</td><td> 48</td><td> 6275</td><td> 4047</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 6000</td><td> 4000</td><td> 0</td></tr><tr><td>0x04100000</td><td> Canon PowerShot G9 X Mark II</td><td> 14</td><td> 2816</td><td> 3710</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 5632</td><td> 5632</td><td> 3710</td><td> 132</td><td> 40</td><td> 5603</td><td> 3687</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5472</td><td> 3648</td><td> 0</td></tr><tr><td>0x04180000</td><td> Canon PowerShot G1 X Mark III</td><td> 14</td><td> 3144</td><td> 4056</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 6288</td><td> 6288</td><td> 4056</td><td> 276</td><td> 48</td><td> 6275</td><td> 4047</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 6000</td><td> 4000</td><td> 0</td></tr><tr><td>0x80000432</td><td> Canon EOS 2000D</td><td> 14</td><td> 1524</td><td> 4051</td><td> 4</td><td> 1</td><td> 1</td><td> 2</td><td> 2016</td><td> 2064</td><td> 6096</td><td> 4051</td><td> 88</td><td> 47</td><td> 6087</td><td> 4046</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 6000</td><td> 4000</td><td> 0</td></tr><tr><td>0x80000422</td><td> Canon EOS 4000D</td><td> 14</td><td> 1336</td><td> 3516</td><td> 4</td><td> 1</td><td> 1</td><td> 2</td><td> 1728</td><td> 1888</td><td> 5344</td><td> 3516</td><td> 152</td><td> 56</td><td> 5335</td><td> 3511</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5184</td><td> 3456</td><td> 1</td></tr><tr><td>0x80000405</td><td> Canon EOS Rebel T7i</td><td> 14</td><td> 3144</td><td> 4056</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 6288</td><td> 6288</td><td> 4056</td><td> 276</td><td> 48</td><td> 6275</td><td> 4047</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 6000</td><td> 4000</td><td> 0</td></tr><tr><td>0x80000408</td><td> Canon EOS 77D</td><td> 14</td><td> 3144</td><td> 4056</td><td> 2</td><td> 1</td><td> 1</td><td> 0</td><td> 0</td><td> 6288</td><td> 6288</td><td> 4056</td><td> 276</td><td> 48</td><td> 6275</td><td> 4047</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 6000</td><td> 4000</td><td> 0</td></tr><tr><td>0x80000169</td><td> Canon EOS-1D Mark III</td><td> 15</td><td> 1944</td><td> 1296</td><td> 3</td><td> 2</td><td> 1</td><td> 3</td><td> 976</td><td> 960</td><td> 1944</td><td> 1296</td><td> 4</td><td> 3</td><td> 1939</td><td> 1290</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 1936</td><td> 1288</td><td> 0</td></tr><tr><td>0x80000190</td><td> Canon EOS 40D</td><td> 15</td><td> 1944</td><td> 1296</td><td> 3</td><td> 2</td><td> 1</td><td> 3</td><td> 976</td><td> 960</td><td> 1944</td><td> 1296</td><td> 4</td><td> 3</td><td> 1939</td><td> 1290</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 1936</td><td> 1288</td><td> 0</td></tr><tr><td>0x80000215</td><td> Canon EOS-1Ds Mark III</td><td> 15</td><td> 2808</td><td> 1872</td><td> 3</td><td> 2</td><td> 1</td><td> 3</td><td> 1440</td><td> 1296</td><td> 2808</td><td> 1872</td><td> 12</td><td> 7</td><td> 2795</td><td> 1862</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 2784</td><td> 1856</td><td> 0</td></tr><tr><td>0x80000261</td><td> Canon EOS 50D</td><td> 15</td><td> 3344</td><td> 2178</td><td> 3</td><td> 2</td><td> 2</td><td> 7</td><td> 1254</td><td> 1254</td><td> 3344</td><td> 2178</td><td> 0</td><td> 0</td><td> 3266</td><td> 2177</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3267</td><td> 2178</td><td> 0</td></tr><tr><td>0x80000261</td><td> Canon EOS 50D</td><td> 15</td><td> 2376</td><td> 1584</td><td> 3</td><td> 2</td><td> 1</td><td> 3</td><td> 1440</td><td> 432</td><td> 2376</td><td> 1584</td><td> 0</td><td> 0</td><td> 2375</td><td> 1583</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 2376</td><td> 1584</td><td> 0</td></tr><tr><td>0x80000218</td><td> Canon EOS 5D Mark II</td><td> 15</td><td> 3872</td><td> 2574</td><td> 3</td><td> 2</td><td> 2</td><td> 10</td><td> 1056</td><td> 1056</td><td> 3872</td><td> 2574</td><td> 0</td><td> 0</td><td> 3860</td><td> 2573</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3861</td><td> 2574</td><td> 0</td></tr><tr><td>0x80000218</td><td> Canon EOS 5D Mark II</td><td> 15</td><td> 2808</td><td> 1872</td><td> 3</td><td> 2</td><td> 1</td><td> 3</td><td> 1440</td><td> 1296</td><td> 2808</td><td> 1872</td><td> 12</td><td> 8</td><td> 2795</td><td> 1863</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 2784</td><td> 1856</td><td> 0</td></tr><tr><td>0x80000250</td><td> Canon EOS 7D</td><td> 15</td><td> 2592</td><td> 1728</td><td> 3</td><td> 2</td><td> 1</td><td> 5</td><td> 864</td><td> 864</td><td> 2592</td><td> 1728</td><td> 0</td><td> 0</td><td> 2591</td><td> 1727</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 2592</td><td> 1728</td><td> 0</td></tr><tr><td>0x80000250</td><td> Canon EOS 7D</td><td> 15</td><td> 3888</td><td> 2592</td><td> 3</td><td> 2</td><td> 2</td><td> 8</td><td> 1296</td><td> 1296</td><td> 3888</td><td> 2592</td><td> 0</td><td> 0</td><td> 3887</td><td> 2591</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3888</td><td> 2592</td><td> 0</td></tr><tr><td>0x80000281</td><td> Canon EOS-1D Mark IV</td><td> 15</td><td> 3672</td><td> 2448</td><td> 3</td><td> 2</td><td> 2</td><td> 8</td><td> 1224</td><td> 1224</td><td> 3672</td><td> 2448</td><td> 0</td><td> 0</td><td> 3671</td><td> 2447</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3672</td><td> 2448</td><td> 0</td></tr><tr><td>0x80000281</td><td> Canon EOS-1D Mark IV</td><td> 15</td><td> 2448</td><td> 1632</td><td> 3</td><td> 2</td><td> 1</td><td> 5</td><td> 816</td><td> 816</td><td> 2448</td><td> 1632</td><td> 0</td><td> 0</td><td> 2447</td><td> 1631</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 2448</td><td> 1632</td><td> 0</td></tr><tr><td>0x80000287</td><td> Canon EOS 60D</td><td> 15</td><td> 3888</td><td> 2592</td><td> 3</td><td> 2</td><td> 2</td><td> 8</td><td> 1296</td><td> 1296</td><td> 3888</td><td> 2592</td><td> 0</td><td> 0</td><td> 3887</td><td> 2591</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3888</td><td> 2592</td><td> 0</td></tr><tr><td>0x80000287</td><td> Canon EOS 60D</td><td> 15</td><td> 2592</td><td> 1728</td><td> 3</td><td> 2</td><td> 1</td><td> 5</td><td> 864</td><td> 864</td><td> 2592</td><td> 1728</td><td> 0</td><td> 0</td><td> 2591</td><td> 1727</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 2592</td><td> 1728</td><td> 0</td></tr><tr><td>0x80000269</td><td> Canon EOS-1D X</td><td> 15</td><td> 3888</td><td> 2592</td><td> 3</td><td> 2</td><td> 2</td><td> 5</td><td> 1944</td><td> 1944</td><td> 3888</td><td> 2592</td><td> 0</td><td> 0</td><td> 3887</td><td> 2591</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3888</td><td> 2592</td><td> 0</td></tr><tr><td>0x80000269</td><td> Canon EOS-1D X</td><td> 15</td><td> 2592</td><td> 1728</td><td> 3</td><td> 2</td><td> 1</td><td> 3</td><td> 1296</td><td> 1296</td><td> 2592</td><td> 1728</td><td> 0</td><td> 0</td><td> 2591</td><td> 1727</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 2592</td><td> 1728</td><td> 0</td></tr><tr><td>0x80000285</td><td> Canon EOS 5D Mark III</td><td> 15</td><td> 3960</td><td> 2640</td><td> 3</td><td> 2</td><td> 2</td><td> 5</td><td> 1980</td><td> 1980</td><td> 3960</td><td> 2640</td><td> 0</td><td> 0</td><td> 3959</td><td> 2639</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3960</td><td> 2640</td><td> 0</td></tr><tr><td>0x80000285</td><td> Canon EOS 5D Mark III</td><td> 15</td><td> 2880</td><td> 1920</td><td> 3</td><td> 2</td><td> 1</td><td> 3</td><td> 1440</td><td> 1440</td><td> 2880</td><td> 1920</td><td> 0</td><td> 0</td><td> 2879</td><td> 1919</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 2880</td><td> 1920</td><td> 0</td></tr><tr><td>0x80000302</td><td> Canon EOS 6D</td><td> 15</td><td> 2736</td><td> 4104</td><td> 3</td><td> 2</td><td> 2</td><td> 5</td><td> 2052</td><td> 2052</td><td> 4104</td><td> 2736</td><td> 0</td><td> 0</td><td> 4103</td><td> 2735</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 4104</td><td> 2736</td><td> 0</td></tr><tr><td>0x80000302</td><td> Canon EOS 6D</td><td> 15</td><td> 2736</td><td> 1824</td><td> 3</td><td> 2</td><td> 1</td><td> 3</td><td> 1368</td><td> 1368</td><td> 2736</td><td> 1824</td><td> 0</td><td> 0</td><td> 2735</td><td> 1823</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 2736</td><td> 1824</td><td> 0</td></tr><tr><td>0x80000325</td><td> Canon EOS 70D</td><td> 15</td><td> 2736</td><td> 4104</td><td> 3</td><td> 2</td><td> 2</td><td> 5</td><td> 2052</td><td> 2052</td><td> 4104</td><td> 2736</td><td> 0</td><td> 0</td><td> 4103</td><td> 2735</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 4104</td><td> 2736</td><td> 0</td></tr><tr><td>0x80000325</td><td> Canon EOS 70D</td><td> 15</td><td> 2736</td><td> 1824</td><td> 3</td><td> 2</td><td> 1</td><td> 3</td><td> 1368</td><td> 1368</td><td> 2736</td><td> 1824</td><td> 0</td><td> 0</td><td> 2735</td><td> 1823</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 2736</td><td> 1824</td><td> 0</td></tr><tr><td>0x80000289</td><td> Canon EOS 7D Mark II</td><td> 15</td><td> 2736</td><td> 4104</td><td> 3</td><td> 2</td><td> 2</td><td> 5</td><td> 2052</td><td> 2052</td><td> 4104</td><td> 2736</td><td> 0</td><td> 0</td><td> 4103</td><td> 2735</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 4104</td><td> 2736</td><td> 0</td></tr><tr><td>0x80000289</td><td> Canon EOS 7D Mark II</td><td> 15</td><td> 2736</td><td> 1824</td><td> 3</td><td> 2</td><td> 1</td><td> 3</td><td> 1368</td><td> 1368</td><td> 2736</td><td> 1824</td><td> 0</td><td> 0</td><td> 2735</td><td> 1823</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 2736</td><td> 1824</td><td> 0</td></tr><tr><td>0x80000401</td><td> Canon EOS 5DS R</td><td> 15</td><td> 4320</td><td> 2880</td><td> 3</td><td> 2</td><td> 1</td><td> 5</td><td> 1440</td><td> 1440</td><td> 4320</td><td> 2880</td><td> 0</td><td> 0</td><td> 4319</td><td> 2879</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 4320</td><td> 2880</td><td> 0</td></tr><tr><td>0x80000401</td><td> Canon EOS 5DS R</td><td> 15</td><td> 3888</td><td> 7200</td><td> 3</td><td> 2</td><td> 2</td><td> 8</td><td> 2160</td><td> 2160</td><td> 6480</td><td> 4320</td><td> 0</td><td> 0</td><td> 6479</td><td> 4319</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 6480</td><td> 4320</td><td> 0</td></tr><tr><td>0x80000350</td><td> Canon EOS 80D</td><td> 15</td><td> 4032</td><td> 3402</td><td> 3</td><td> 2</td><td> 2</td><td> 8</td><td> 1512</td><td> 1512</td><td> 4536</td><td> 3024</td><td> 36</td><td> 18</td><td> 4535</td><td> 3017</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 4500</td><td> 3000</td><td> 0</td></tr><tr><td>0x80000350</td><td> Canon EOS 80D</td><td> 15</td><td> 3000</td><td> 2000</td><td> 3</td><td> 2</td><td> 1</td><td> 5</td><td> 1000</td><td> 1000</td><td> 3000</td><td> 2000</td><td> 0</td><td> 0</td><td> 2999</td><td> 1999</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3000</td><td> 2000</td><td> 0</td></tr><tr><td>0x80000328</td><td> Canon EOS-1D X Mark II</td><td> 15</td><td> 2736</td><td> 4104</td><td> 3</td><td> 2</td><td> 2</td><td> 5</td><td> 2052</td><td> 2052</td><td> 4104</td><td> 2736</td><td> 0</td><td> 0</td><td> 4103</td><td> 2735</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 4104</td><td> 2736</td><td> 0</td></tr><tr><td>0x80000328</td><td> Canon EOS-1D X Mark II</td><td> 15</td><td> 2736</td><td> 1824</td><td> 3</td><td> 2</td><td> 1</td><td> 3</td><td> 1368</td><td> 1368</td><td> 2736</td><td> 1824</td><td> 0</td><td> 0</td><td> 2735</td><td> 1823</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 2736</td><td> 1824</td><td> 0</td></tr><tr><td>0x80000349</td><td> Canon EOS 5D Mark IV</td><td> 15</td><td> 2520</td><td> 6720</td><td> 3</td><td> 2</td><td> 2</td><td> 7</td><td> 1890</td><td> 1890</td><td> 5040</td><td> 3360</td><td> 0</td><td> 0</td><td> 5039</td><td> 3359</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 5040</td><td> 3360</td><td> 0</td></tr><tr><td>0x80000349</td><td> Canon EOS 5D Mark IV</td><td> 15</td><td> 3360</td><td> 2240</td><td> 3</td><td> 2</td><td> 1</td><td> 4</td><td> 1344</td><td> 1344</td><td> 3360</td><td> 2240</td><td> 0</td><td> 0</td><td> 3359</td><td> 2239</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3360</td><td> 2240</td><td> 0</td></tr><tr><td>0x80000406</td><td> Canon EOS 6D Mark II</td><td> 15</td><td> 3888</td><td> 3770</td><td> 3</td><td> 2</td><td> 2</td><td> 4</td><td> 2808</td><td> 2808</td><td> 4680</td><td> 3132</td><td> 0</td><td> 12</td><td> 4679</td><td> 3131</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 4680</td><td> 3120</td><td> 0</td></tr><tr><td>0x80000406</td><td> Canon EOS 6D Mark II</td><td> 15</td><td> 3120</td><td> 2082</td><td> 3</td><td> 2</td><td> 1</td><td> 3</td><td> 1560</td><td> 1560</td><td> 3120</td><td> 2082</td><td> 0</td><td> 2</td><td> 3119</td><td> 2081</td><td> 0</td><td> 0</td><td> 0</td><td> 0</td><td> 3120</td><td> 2080</td><td> 0</td></tr></tbody></table></div>

<script>

var Url = "https://raw.githubusercontent.com/lclevy/libcraw2/master/docs/cr2_database.txt";

xmlHttp = new XMLHttpRequest(); 
xmlHttp.onreadystatechange = ProcessRequest;
xmlHttp.open( "GET", Url, true );
xmlHttp.send( null );
            
function ProcessRequest() {
  var data = xmlHttp.responseText;
  var lines = data.split("\n"),
              output = [],
              i;
  header = "<tr><th>" + lines[0].slice(0).split(",").join("</th><th>") + "</th></tr>";        
  header = header.replace(/jpeg_/g,"jpeg ");  
  header = header.replace(/sensor/g,"sensor ");  
  header = header.replace(/Border/g," border");  
  header = header.replace(/black/g,"black ");  
  header = header.replace(/Mask/g,"mask ");  
  header = header.replace(/image/g,"image ");  
  output.push(header);        
  for (i = 1; i < lines.length; i++)
     if (lines[i].length>0)
       output.push("<tr><td>"
                + lines[i].slice(0).split(",").join("</td><td>")
                + "</td></tr>");

  //footer = header.replace(<th>/g,"<td>");         
                
  output = "<table border=\"1\" cellpadding=\"2\">" 
  + "<colgroup><col span=\"2\" style=\"background-color:white\">"
  + "<col span=\"6\" style=\"background-color:#D8D8D8\">"
  + "<col span=\"3\" style=\"background-color:white\">"
  + "<col span=\"2\" style=\"background-color:#D8D8D8\">"
  + "<col span=\"4\" style=\"background-color:white\">"
  + "<col span=\"4\" style=\"background-color:#D8D8D8\">"
  + "</colgroup><tbody>" + output.join("") + "</tbody></table>";
  
  document.getElementById('sensors').innerHTML = output;
}

</script>

<p>
We have :
</p><ul>
<li>jpeg_high * jpeg_vsf == sensor_height 
</li><li>jpeg_wide * jpeg_comp == sensor_width == c640_tag[0] * c640_tag[1] + c640_tag[2] <br>
(for 5DS R, we have only jpeg_wide * jpeg_comp * jpeg_high == sensor_width * sensor_height and c640_tag[0]*c640_tag[1] + c640_tag[2] == sensor_width, 
since jpeg_wide * jpeg_comp == 2*sensor_width and jpeg_high == sensor_height/2 for RAW from this model)
</li></ul>
</a><p><a name="app">
The table above is generated from raw data in CSV format available </a><a href="https://raw.githubusercontent.com/lclevy/libcraw2/master/docs/cr2_database.txt">here</a>
</p><p>
Note: Previous table <a href="http://lclevy.free.fr/cr2/sensors.html">is here</a>.
</p><p>
</p><h3>10.2 Camera Calibration, black and white values per models</h3>
<p>
These values can be found in Adobe DNG images produced from CR2 files, in tags ColorMatrix2 (0xC622), BlackLevel (0xC61A) and WhiteLevel (0xC61D).
</p><p>
See this generated <a href="https://github.com/lclevy/libcraw2/blob/master/dng_info.txt">database</a>
</p><p>


</p><h3>10.3 models release dates</h3>

<div id="models"><table border="1" cellpadding="2"><colgroup><col span="2" style="background-color:white"></colgroup><tbody><tr><th>modelId</th><th> name</th><th> release</th><th> size</th><th> technology</th><th> processor</th></tr><tr><td>0x80000174</td><td> 1D Mark II</td><td> 1/2004</td><td> APS-H</td><td> CMOS</td><td> DigicII</td></tr><tr><td>0x80000175</td><td> 20D</td><td> 8/2004</td><td> APS-C</td><td>CMOS</td><td> DigicII</td></tr><tr><td>0x80000188</td><td> 1Ds Mark II</td><td> 9/2004</td><td> FF</td><td>CMOS</td><td> DigicII</td></tr><tr><td>0x80000189</td><td> EOS Digital Rebel XT / 350D / Kiss Digital N</td><td> 2/2005</td><td> APS-C</td><td>CMOS</td><td> DigicII</td></tr><tr><td>0x80000213</td><td> 5D</td><td> 8/2005</td><td> FF</td><td>CMOS</td><td> DigicII</td></tr><tr><td>0x80000188</td><td> 1D M2n</td><td> 8/2005</td><td> APS-H</td><td>CMOS</td><td> DigicII</td></tr><tr><td>0x80000234</td><td> 30D</td><td> 2/2006</td><td> APS-C</td><td>CMOS</td><td> DigicII</td></tr><tr><td>0x80000236</td><td> EOS Digital Rebel XTi / 400D / Kiss Digital X</td><td> 8/2006</td><td> APS-C</td><td>CMOS</td><td> DigicII</td></tr><tr><td>0x80000169</td><td> 1D Mark III</td><td> 2/2007</td><td> APS-H</td><td>CMOS</td><td> 2*DigicIII</td></tr><tr><td>0x80000190</td><td> 40D</td><td> 8/2007</td><td> APS-C</td><td>CMOS</td><td> DigicIII</td></tr><tr><td>0x80000215</td><td> 1Ds Mark III</td><td> 8/2007</td><td> FF</td><td>CMOS</td><td> 2*DigicIII</td></tr><tr><td>0x02230000</td><td> G9</td><td> 8/2007</td><td>1/1.7"</td><td> CCD</td><td> DigicIII</td></tr><tr><td>0x80000176</td><td> EOS Digital Rebel XSi / 450D / Kiss X2</td><td>1/2008</td><td>APS-C</td><td>CMOS</td><td> DigicIII</td></tr><tr><td>0x80000254</td><td> EOS Rebel XS / 1000D / Kiss F</td><td> 6/2008</td><td> APS-C</td><td>CMOS</td><td> DigicIII</td></tr><tr><td>0x80000261</td><td> 50D</td><td> 8/2008</td><td> APS-C</td><td>CMOS</td><td> Digic4</td></tr><tr><td>0x02490000</td><td> G10</td><td> 9/2008</td><td>1/1.7"</td><td> CCD</td><td> Digic4 </td></tr><tr><td>0x80000218</td><td> 5D Mark II</td><td>9/2008</td><td> FF</td><td>CMOS</td><td> Digic4</td></tr><tr><td>0x02460000</td><td> SX1 IS</td><td> 3/2009</td><td> 1/2.3"</td><td> CMOS</td><td>Digic4</td></tr><tr><td>0x80000252</td><td> EOS Rebel T1i / 500D / Kiss X3</td><td> 3/2009</td><td> APS-C</td><td>CMOS</td><td> Digic4</td></tr><tr><td>0x02700000</td><td> G11</td><td> 8/2009</td><td> 	1/1.7"</td><td> CCD</td><td> Digic4</td></tr><tr><td>0x02720000</td><td> S90</td><td> 8/2009</td><td> 	1/1.7"</td><td> CCD</td><td> Digic4</td></tr><tr><td>0x80000250</td><td> 7D</td><td>9/2009</td><td> APS-C</td><td>CMOS</td><td> Dual Digic4</td></tr><tr><td>0x80000281</td><td> 1D MarkIV</td><td>10/2009</td><td> APS-H</td><td>CMOS</td><td> Dual Digic4</td></tr><tr><td>0x80000270</td><td> EOS Rebel T2i / 550D / Kiss X4</td><td>02/2010</td><td> APS-C</td><td>CMOS</td><td> Digic4</td></tr><tr><td>0x02950000</td><td> S95</td><td> 08/2010</td><td> 1/1.7"</td><td>CCD</td><td> Digic4</td></tr><tr><td>0x80000287</td><td> 60D</td><td> 08/2010</td><td> APS-C</td><td>CMOS</td><td> Digic4</td></tr><tr><td>0x02920000</td><td> G12</td><td>09/2010</td><td> 1/1.7"</td><td> CCD</td><td> Digic4</td></tr><tr><td>0x80000286</td><td> EOS Rebel T3i / 600D / Kiss X5</td><td> 02/2011</td><td> APS-C</td><td>CMOS</td><td> Digic4</td></tr><tr><td>0x80000288</td><td> EOS Rebel T3 / 1100D / Kiss X50</td><td>02/2011</td><td> APS-C</td><td>CMOS</td><td> Digic4</td></tr><tr><td>0x03110000</td><td> S100</td><td>09/2011</td><td> 1/1.7"</td><td>CMOS</td><td> Digic5</td></tr><tr><td>0x80000269</td><td> 1D X</td><td>10/2011</td><td> FF</td><td>CMOS</td><td> Dual Digic5+</td></tr><tr><td>0x03080000</td><td> G1 X</td><td>01/2012</td><td>1.5"</td><td>CMOS</td><td> Digic5</td></tr><tr><td>0x80000285</td><td> EOS 5D Mark III</td><td>03/2012</td><td> FF</td><td>CMOS</td><td> Digic5+</td></tr><tr><td>0x80000301</td><td> EOS Rebel T4i / 650D / Kiss X6i</td><td>	06/2012</td><td> APS-C</td><td>CMOS</td><td> Digic5</td></tr><tr><td>0x80000331</td><td> EOS M</td><td>07/2012</td><td> APS-C</td><td>CMOS</td><td> Digic5</td></tr><tr><td>0x03360000</td><td> S110</td><td>07/2012</td><td> 1/1.7"</td><td>CMOS</td><td> Digic5</td></tr><tr><td>0x03330000</td><td> G15</td><td>07/2012</td><td> 1/1.7"</td><td>CMOS</td><td> Digic5</td></tr><tr><td>0x03340000</td><td> SX50 HS</td><td>07/2012</td><td> 1/2.3"</td><td>BSI-CMOS</td><td> Digic5</td></tr><tr><td>0x80000302</td><td> 6D</td><td>09/2012</td><td> FF</td><td>CMOS</td><td> Digic5</td></tr><tr><td>0x80000326</td><td> EOS Rebel T5i / 700D / Kiss X7i</td><td>03/2013</td><td> APS-C</td><td>CMOS</td><td> Digic5</td></tr><tr><td>0x80000346</td><td> EOS Rebel SL1 / 100D / Kiss X7</td><td>03/2013</td><td> APS-C</td><td> Hybrid CMOS II</td><td> Digic5</td></tr><tr><td>0x80000325</td><td> 70D</td><td>07/2013</td><td> APS-C</td><td>Dual Pixel CMOS AF</td><td> Digic5+</td></tr><tr><td>0x03540000</td><td> G16</td><td>08/2013</td><td> 1/1.7"</td><td>BSI-CMOS</td><td> Digic6</td></tr><tr><td>0x03550000</td><td> S120</td><td>08/2013</td><td> 1/1.7"</td><td>	BSI-CMOS</td><td> Digic6</td></tr><tr><td>0x80000355</td><td> EOS M2</td><td>12/2013</td><td> APS-C</td><td>Hybrid CMOS II </td><td> Digic5</td></tr><tr><td>0x80000327</td><td> EOS Rebel T5 / 1200D / Kiss X70</td><td>02/2014</td><td> APS-C</td><td>CMOS</td><td> Digic4</td></tr><tr><td>0x03640000</td><td> G1 X Mark II</td><td>02/2014</td><td>  1.5"</td><td> CMOS</td><td> Dual-Digic6</td></tr><tr><td>0x80000289</td><td> 7D Mark II</td><td>09/2014</td><td> APS-C</td><td>Dual Pixel CMOS AF</td><td> Dual-Digic6</td></tr><tr><td>0x03780000</td><td> G7 X</td><td>09/2014</td><td> 1"</td><td> BSI-CMOS</td><td> Digic6</td></tr><tr><td>0x03750000</td><td> SX60 HS</td><td>09/2014</td><td> 1/2.3"</td><td>BSI-CMOS</td><td> Digic6</td></tr><tr><td>0x80000382</td><td> 5DS</td><td>02/2015</td><td> FF</td><td>CMOS</td><td> Dual-Digic6</td></tr><tr><td>0x80000401</td><td> 5DS R</td><td>02/2015</td><td> FF</td><td>CMOS</td><td> Dual-Digic6</td></tr><tr><td>0x80000393</td><td> EOS Rebel T6i / 750D / Kiss X8i</td><td>02/2015</td><td> APS-C</td><td>CMOS w/Hybrid CMOS AF</td><td> Digic6</td></tr><tr><td>0x80000347</td><td> EOS Rebel T6s / 760D / 8000D</td><td>02/2015</td><td> APS-C</td><td>CMOS w/Hybrid CMOS AF</td><td> Digic6</td></tr><tr><td>0x03740000</td><td> EOS M3</td><td>02/2015</td><td> APS-C</td><td>CMOS</td><td> Digic6</td></tr><tr><td>0x03850000</td><td> G3 X</td><td>02/2015</td><td> 1"</td><td> BSI-CMOS</td><td> Digic6</td></tr><tr><td>0x03950000</td><td> G5 X</td><td>10/2015</td><td> 1"</td><td> BSI-CMOS</td><td> Digic6</td></tr><tr><td>0x03930000</td><td> G9 X</td><td>10/2015</td><td> 1"</td><td> BSI-CMOS</td><td> Digic6</td></tr><tr><td>0x03840000</td><td> EOS M10</td><td>10/2015</td><td> APS-C</td><td>CMOS</td><td> Digic6</td></tr><tr><td>0x80000328</td><td> 1DX Mark II</td><td>02/2016</td><td> FF</td><td>CMOS</td><td> Dual Digic6+</td></tr><tr><td>0x80000350</td><td> 80D</td><td>02/2016</td><td> APS-C</td><td>Dual Pixel CMOS AF</td><td> Digic6</td></tr><tr><td>0x03970000</td><td> G7 X Mark II</td><td>02/2016</td><td> 1"</td><td> BSI-CMOS</td><td> Digic7</td></tr><tr><td>0x80000404</td><td> EOS Rebel T6 / 1300D / Kiss X80</td><td> 03/2016</td><td> APS-C</td><td> CMOS</td><td> Digic4+</td></tr><tr><td>0x80000349</td><td> 5D Mark IV</td><td> 08/2016</td><td> FF</td><td> Dual Pixel AF CMOS</td><td> Digic6+</td></tr><tr><td>0x03940000</td><td> EOS M5</td><td> 09/2016</td><td> APS-C</td><td> Dual Pixel AF CMOS</td><td> Digic7</td></tr><tr><td>0x04100000</td><td> G9 X Mark II</td><td> 01/2017</td><td> 1"</td><td> BSI-CMOS</td><td> Digic7</td></tr><tr><td>0x80000405</td><td> EOS T7i / 800D / Kiss X9i</td><td> 02/2017</td><td> APS-C</td><td> Dual Pixel AF CMOS</td><td> Digic7</td></tr><tr><td>0x80000408</td><td> EOS 77D / 9000D</td><td> 02/2017</td><td> APS-C</td><td> Dual Pixel AF CMOS</td><td> Digic7</td></tr><tr><td>0x04070000</td><td> EOS M6</td><td> 02/2017</td><td> APS-C</td><td> Dual Pixel AF CMOS</td><td> Digic7</td></tr><tr><td>0x80000406</td><td> EOS 6D Mark II</td><td> 08/2017</td><td> FF</td><td> Dual Pixel AF CMOS</td><td> Digic7</td></tr><tr><td>0x80000417</td><td> EOS Rebel SL2 / EOS 200D / Kiss X9</td><td> 06/2017</td><td> APS-C</td><td> Dual Pixel AF CMOS</td><td> Digic7</td></tr><tr><td>0x03980000</td><td> EOS M100</td><td> 08/2017</td><td> APS-C</td><td> Dual Pixel AF CMOS</td><td> Digic7</td></tr><tr><td>0x80000417</td><td> EOS Kiss X9 / Rebel SL2 / 200D</td><td> 09/2017</td><td> APS-C</td><td> Dual Pixel AF CMOS</td><td> Digic7</td></tr><tr><td>0x04180000</td><td> PowerShot G1 X Mark III</td><td> 10/2017</td><td> APS-C</td><td> Dual Pixel AF CMOS</td><td> Digic7 </td></tr><tr><td>0x80000432</td><td> 2000D / EOS Rebel T7</td><td> 02/2018</td><td> APS-C</td><td> CMOS</td><td> Digic4+</td></tr><tr><td>0x80000422</td><td> 4000D / EOS Rebel T100</td><td> 02/2018</td><td> APS-C</td><td> CMOS</td><td> Digic4+</td></tr></tbody></table></div>  

<script>

var Url2 = "https://raw.githubusercontent.com/lclevy/libcraw2/master/docs/cameras.txt";

xmlHttp2 = new XMLHttpRequest(); 
xmlHttp2.onreadystatechange = ProcessRequest;
xmlHttp2.open( "GET", Url2, true );
xmlHttp2.send( null );
            
function ProcessRequest() {
  var data = xmlHttp2.responseText;
  var lines = data.split("\n"),
              output = [],
              i;
  header = "<tr><th>" + lines[0].slice(0).split(",").join("</th><th>") + "</th></tr>";        
  //header = header.replace(/jpeg_/g,"jpeg ");  
  output.push(header);        
  for (i = 1; i < lines.length; i++)
     if (lines[i].length>0)
       output.push("<tr><td>"
                + lines[i].slice(0).split(",").join("</td><td>")
                + "</td></tr>");

  //footer = header.replace(<th>/g,"<td>");         
                
  output = "<table border=\"1\" cellpadding=\"2\">" 
  + "<colgroup><col span=\"2\" style=\"background-color:white\">"
  + "</colgroup><tbody>" + output.join("") + "</tbody></table>";
  
  document.getElementById('models').innerHTML = output;
}

</script>

Note: previous table is <a href="http://lclevy.free.fr/cr2/models.html">here</a>.

<p>
</p><div id="models2"><table border="1" cellpadding="2"><colgroup><col span="2" style="background-color:white"></colgroup><tbody><tr><th>modelId</th><th> name</th><th> release</th><th> size</th><th> technology</th><th> processor</th></tr><tr><td>0x00000412</td><td> EOS M50 / Kiss M</td><td> 04/2018</td><td> APS-C</td><td> CMOS</td><td> Digic 8</td></tr><tr><td>0x80000424</td><td> EOS R</td><td> 09/2018</td><td> FF</td><td> CMOS</td><td> Digic 8</td></tr><tr><td>0x00000805</td><td> Canon PowerShot SX70 HS</td><td> 09/2018</td><td> 1/2.3"</td><td> BSI-CMOS</td><td> Digic 8</td></tr><tr><td>0x80000433</td><td> EOS RP</td><td> 02/2019</td><td> FF</td><td> CMOS</td><td> Digic 8</td></tr><tr><td>0x80000436</td><td> EOS 250D / Rebel SL3 / Kiss X10</td><td> 04/2019</td><td> APS-C</td><td> CMOS</td><td> Digic 8</td></tr><tr><td>0x00000804</td><td> Powershot G5 X Mark II</td><td> 07/2019</td><td> 1"</td><td> BSI-CMOS</td><td> Digic 8</td></tr><tr><td>0x00000808</td><td> PowerShot G7 X Mark III</td><td> 07/2019</td><td> 1"</td><td> BSI-CMOS</td><td> Digic 8</td></tr><tr><td>0x00000811</td><td> EOS M6 Mark II</td><td> 08/2019</td><td> APS-C</td><td> CMOS</td><td> Digic 8</td></tr><tr><td>0x80000437</td><td> EOS 90D</td><td> 08/2019</td><td> APS-C</td><td> CMOS</td><td> Digic 8</td></tr><tr><td>0x00000812</td><td> EOS M200</td><td> 09/2019</td><td> APS-C</td><td> CMOS</td><td> Digic 8</td></tr><tr><td>0x80000428</td><td> EOS 1DX Mark III</td><td> 01/2020</td><td> FF</td><td> CMOS</td><td> Digic X</td></tr></tbody></table></div>  
<script>

var Url3 = "https://raw.githubusercontent.com/lclevy/canon_cr3/master/docs/cameras.txt";

xmlHttp3 = new XMLHttpRequest(); 
xmlHttp3.onreadystatechange = ProcessRequest;
xmlHttp3.open( "GET", Url3, true );
xmlHttp3.send( null );
            
function ProcessRequest() {
  var data = xmlHttp3.responseText;
  var lines = data.split("\n"),
              output = [],
              i;
  header = "<tr><th>" + lines[0].slice(0).split(",").join("</th><th>") + "</th></tr>";        
  //header = header.replace(/jpeg_/g,"jpeg ");  
  output.push(header);        
  for (i = 1; i < lines.length; i++)
     if (lines[i].length>0)
       output.push("<tr><td>"
                + lines[i].slice(0).split(",").join("</td><td>")
                + "</td></tr>");

  //footer = header.replace(<th>/g,"<td>");         
                
  output = "<table border=\"1\" cellpadding=\"2\">" 
  + "<colgroup><col span=\"2\" style=\"background-color:white\">"
  + "</colgroup><tbody>" + output.join("") + "</tbody></table>";
  
  document.getElementById('models2').innerHTML = output;
}

</script>
<p>
- end of the document -

</p></li><iframe scrolling="no" frameborder="0" allowtransparency="true" src="./doc_files/widget_iframe.2f70fb173b9000da126c79afe2098f02.html" title="Twitter settings iframe" style="display: none;"></iframe><iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: none;" title="Twitter analytics iframe" src="./doc_files/saved_resource.html"></iframe></body></html>